"use strict";(self.webpackChunkproeftuin=self.webpackChunkproeftuin||[]).push([[776],{9776:(ee,mt,et)=>{et.d(mt,{S:()=>Zt});const ft=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.zero=()=>0,e.value=t=>t.value,e.withZero=t=>(e.zero=t,e),e},gt=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.open=t=>t.open,e.high=t=>t.high,e.low=t=>t.low,e.close=t=>t.close,e.volume=t=>t.volume,e.value=e.close,e.withValue=t=>(e.value=t,e),e},yt=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.volume=t=>t.volume,e.value=e.volume,e.withValue=t=>(e.value=t,e),e},St=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.ask=t=>t.askPrice,e.bid=t=>t.bidPrice,e.mid=t=>(t.askPrice+t.bidPrice)/2,e.spread=t=>t.askPrice-t.bidPrice,e.value=e.mid,e.price=e.mid,e.close=e.mid,e.withValue=t=>(e.value=t,e.price=t,e.close=t,e),e},vt=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.type=t=>t.type,e.price=t=>t.price,e.volume=t=>t.volume,e.value=e.price,e.withValue=t=>(e.value=t,e),e},wt=()=>{const e=t=>e.value(t);return e.time=t=>t.time,e.high=t=>t.askPrice,e.low=t=>t.bidPrice,e.spread=t=>(t.askPrice-t.bidPrice)/2,e.value=e.spread,e},xt=()=>{const r=n=>r.y(n);return r.x=function(n,c){return arguments.length<2?n.x:(n.x=c,r)},r.y=function(n,c){return arguments.length<2?n.y:(n.y=c,r)},r},Mt=()=>{const c=o=>c.startValue(o);return c.startTime=function(o,a){if(arguments.length<2)return o.start.time;o.start.time=a},c.startValue=function(o,a){if(arguments.length<2)return o.start.value;o.start.value=a},c.endTime=function(o,a){if(arguments.length<2)return o.end.time;o.end.time=a},c.endValue=function(o,a){if(arguments.length<2)return o.end.value;o.end.value=a},c},kt=()=>{const t=r=>t.value(r);return t.start=r=>r.start,t.end=r=>r.end,t.value=function(r,n){return arguments.length<2?r.value:(r.value=n,t)},t},nt=()=>({value:ft,ohlcv:gt,volume:yt,quote:St,trade:vt,tick:wt,crosshair:xt,trendline:Mt,supstance:kt});var f=et(7682);const bt=()=>{const e=l=>{let u,i,m=["data"];const h=g=>{const y=h.select(g).data(l,u),w=y.enter().append("g").attr("class",d(m," "));return y.exit().remove(),{entry:w,selection:w.merge(y)}};return h.select=g=>g.selectAll("g."+d(m,".")),h.mapper=function(g){return arguments.length?(l=g,h):l},h.scope=function(g){return arguments.length?(i=g,m=["data","scope-"+i],h):i},h.key=function(g){return arguments.length?(u=g,h):u},h};e.mapper={unity:l=>l,array:l=>[l]};const n=l=>({up:u=>l.open(u)<l.close(u),down:u=>l.open(u)>l.close(u),equal:u=>l.open(u)===l.close(u)}),c=(l,u,i,m)=>{const h=i instanceof Array?i:[i];m=m||n(u),Object.keys(m).forEach(g=>{a(l,m[g],h,g)})},a=(l,u,i,m)=>{l.selectAll("path."+d(i,".")+"."+m).data(h=>[h.filter(u)]).enter().append("path").attr("class",d(i," ")+" "+m)},s=l=>void 0!==l.band?Math.max(l.band(),1):3,d=(l,u)=>{if(!l.length)return;let i=l[0];for(let m=1;m<l.length;m++)i+=u+l[m];return i};return{dataSelector:e,appendPathsGroupBy:c,appendPathsUpDownEqual:(l,u,i)=>{c(l,u,i,n(u))},horizontalPathLine:(l,u,i,m)=>h=>{if(!h.length)return null;const g=h[0],y=h[h.length-1];return"M "+u(l(g))+" "+m(i(g))+" L "+u(l(y))+" "+m(i(y))},pathLine:()=>{const l=f.line().curve(f.curveMonotoneX),u=i=>l(i);return u.init=(i,m,h,g,y)=>l.defined(w=>null!==h(w)).x(w=>m(i(w),void 0===y?y:y(w))).y(w=>g(h(w))),u.d3=()=>l,u},pathArea:()=>{const l=f.area().curve(f.curveMonotoneX),u=i=>l(i);return u.init=(i,m,h,g,y)=>l.defined(w=>null!==h(w)).x(w=>m(i(w))).y0(()=>g(y)).y1(w=>g(h(w))),u.d3=()=>l,u},barWidth:s,scaledStrokeWidth:(l,u,i)=>(u=u||1,i=i||1,()=>Math.min(u,s(l)/i)+"px"),joinPath:l=>u=>d(u.map(l())," "),interaction:{mousedispatch:l=>u=>u.on("mouseenter",function(i,m){f.select(this.parentNode).classed("mouseover",!0),l.call("mouseenter",this,m)}).on("mouseleave",function(i,m){const h=f.select(this.parentNode);h.classed("dragging")||(h.classed("mouseover",!1),l.call("mouseout",this,m))}).on("mousemove",function(i,m){l.call("mousemove",this,m)}),dragStartEndDispatch:(l,u)=>l.on("start",function(i,m){f.select(this.parentNode.parentNode).classed("dragging",!0),u.call("dragstart",this,m)}).on("end",function(i,m){f.select(this.parentNode.parentNode).classed("dragging",!1),u.call("dragend",this,m)})},plotComposer:()=>{const l=e();let m,h,u=y=>y.scale(),i=[];const g=y=>{l.mapper(()=>i.map(()=>[]))(y).selection.each(function(x,M){i[M](f.select(this))}),g.refresh(y)};return g.refresh=y=>{l.select(y).data(w=>{const x=h(w);if(null==x)return i.map(()=>[]);const M=m(x);return i.map(v=>[{value:u(v)===m?x:u(v).invert(M)}])}).each(function(w,x){i[x](f.select(this))})},g.plots=function(y){return arguments.length?(i=y,g):i},g.scale=function(y){return arguments.length?(m=y,g):m},g.accessor=function(y){return arguments.length?(h=y,g):h},g.scope=function(y){return arguments.length?(l.scope(y),g):l.scope()},g.plotScale=function(y){return arguments.length?(u=y,g):u},g}}},L=e=>"function"==typeof e?e:()=>e,Pt=(e,t,r,n)=>function(){const c=r.apply(t,arguments);return n&&c===t&&n(),c===t?e:c};const Ft=e=>{function t(S,F,k,P,T,q,G,I,J){let dt,K=3;const ht={tickFormat:S.daily[S.daily.length-1][2]};k=k||f.scaleLinear(),P=P||[new Date(0),new Date(1)],T=void 0===T?.2:T,q=void 0===q?.65:q,G=G||{domain:k.domain()},I=I||!1;const j=()=>(K=r(k,P,T),N);J=J||function e(t,r,n,c){function o(){return t.apply(t,arguments)}return c=void 0===c||c,o.invert=t.invert,o.domain=function(a){return arguments.length?(t.domain(c?[Math.max(n.domain[0],a[0]),Math.min(n.domain[1],a[1])]:a),r&&r(),o):t.domain()},o.range=function(){if(!arguments.length)return t.range();throw new Error("Zoomable is a read only range. Use this scale for zooming only.")},o.copy=function(){return e(t.copy(),r,n,c)},o.clamp=function(a){return arguments.length?(c=a,o):c},o}(k,j,G);const N=(b,V)=>{let E=dt[b instanceof Date?b.getTime():+b];return V=V||0,void 0===E&&(E=P[0]>b?-1:f.bisect(P,b)),k(E+V)};N.invert=b=>P[N.invertToIndex(b)]||null,N.invertToIndex=b=>Math.round(k.invert(b)),N.domain=function(b){if(!arguments.length){let V=k.domain();return V[0]<0&&V[V.length-1]<0?[]:(V=[Math.max(Math.ceil(V[0]),0),Math.min(Math.floor(V[V.length-1]),P.length-1)],P.slice(V[0],V[V.length-1]+1))}return P=b,Q()};const pt=()=>{dt=c(P)},Q=()=>(pt(),k.domain([0,P.length-1]),j(),k.domain(k.range().map(e(q,K)).map(k.invert)),G.domain=k.domain(),j());N.copy=()=>t(S,F,k.copy(),P,T,q,G,I),N.band=()=>K,N.outerPadding=function(b){return arguments.length?(q=b,Q()):q},N.padding=function(b){return arguments.length?(T=b,Q()):T},N.zoomable=()=>J,N.ticks=(b,V)=>{const E=N.domain(),W=k.domain();if(!E.length)return[];const C=void 0===b?$(E,W,10):"number"==typeof b?$(E,W,b):null;return ht.tickFormat=C?C[2]:$(E,W,10)[2],C&&(b=C[0],V=C[1]),b.every(V).range(E[0],+E[E.length-1]+1).map(o(E,I)).reduce(a,[])};const $=(b,V,E)=>{if(1===b.length)return F;const W=b[b.length-1]-b[0],C=W/s<1,H=C?S.intraday:S.daily,Z=C?p:d,tt=W/Math.min(Math.round(n(b,V)*E),E),U=f.bisect(Z,tt);return U===H.length?H[U-1]:U?H[tt/Z[U-1]<Z[U]/tt?U-1:U]:H[U]};return N.closestTicks=function(b){return arguments.length?(I=b,N):I},N.tickFormat=()=>b=>ht.tickFormat(b),function Y(e,t,r,n,c){const o=arguments.length;let s,a=2;for(;++a<o;)e[s=arguments[a]]=Pt(e,t,t[s],c);return e}(N,k,j,"range"),pt(),j()}const r=(S,F,k)=>Math.abs(S(F.length-1)-S(0))/Math.max(1,F.length-1)*(1-k),n=(S,F)=>S.length/(F[F.length-1]-F[0]),c=S=>{const F={};return S.forEach((k,P)=>{F[+k]=P}),F},o=(S,F)=>{const k=c(S);return P=>{const T=k[+P];if(void 0!==T)return S[T];let q=f.bisect(S,P);return F&&q>0&&+P-+S[q-1]<+S[q]-+P&&q--,S[q]}},a=(S,F)=>((0===S.length||S[S.length-1]!==F)&&S.push(F),S),s=864e5,d=[s,6048e5,2592e6,7776e6,31536e6],p=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,s],l=f.timeFormat("%b %e"),u=z([[f.timeFormat("%b %Y"),S=>S.getMonth()],[f.timeFormat("%Y"),()=>!0]]),i=z([[f.timeFormat(":%S"),S=>S.getSeconds()],[f.timeFormat("%I:%M"),S=>S.getMinutes()],[f.timeFormat("%I %p"),()=>!0]]),m=[f.timeSecond,1,z([[f.timeFormat(":%S"),S=>S.getSeconds()],[f.timeFormat("%I:%M"),S=>S.getMinutes()],[f.timeFormat("%I %p"),S=>S.getHours()],[f.timeFormat("%b %e"),()=>!0]])],h=f.utcFormat("%b %e"),g=z([[f.utcFormat("%b %Y"),S=>S.getUTCMonth()],[f.utcFormat("%Y"),()=>!0]]),y=z([[f.utcFormat(":%S"),S=>S.getUTCSeconds()],[f.utcFormat("%I:%M"),S=>S.getUTCMinutes()],[f.utcFormat("%I %p"),()=>!0]]),w=[f.timeSecond,1,z([[f.utcFormat(":%S"),S=>S.getUTCSeconds()],[f.utcFormat("%I:%M"),S=>S.getUTCMinutes()],[f.utcFormat("%I %p"),S=>S.getUTCHours()],[f.utcFormat("%b %e"),()=>!0]])],x=[[f.timeDay,1,l],[f.timeMonday,1,l],[f.timeMonth,1,u],[f.timeMonth,3,u],[f.timeYear,1,u]],M=[[f.timeSecond,1,i],[f.timeSecond,5,i],[f.timeSecond,15,i],[f.timeSecond,30,i],[f.timeMinute,1,i],[f.timeMinute,5,i],[f.timeMinute,15,i],[f.timeMinute,30,i],[f.timeHour,1,i],[f.timeHour,3,i],[f.timeHour,6,i],[f.timeHour,12,i],[f.timeDay,1,l]],v=[[f.utcDay,1,h],[f.utcMonday,1,h],[f.utcMonth,1,g],[f.utcMonth,3,g],[f.utcYear,1,g]],_=[[f.utcSecond,1,y],[f.utcSecond,5,y],[f.utcSecond,15,y],[f.utcSecond,30,y],[f.utcMinute,1,y],[f.utcMinute,5,y],[f.utcMinute,15,y],[f.utcMinute,30,y],[f.utcHour,1,y],[f.utcHour,3,y],[f.utcHour,6,y],[f.utcHour,12,y],[f.utcDay,1,h]],A=()=>t({daily:x,intraday:M},m);return A.utc=()=>t({daily:v,intraday:_},w),A},z=e=>t=>{for(const r of e)if(r[1](t))return r[0](t)},at=()=>{const e=nt(),t=Ft(D),r=(o,a,s)=>{s=void 0===s?.02:s;const d=(a=a||e.ohlcv()).low,p=a.high;return f.scaleLinear().domain([f.min(o.map(d)),f.max(o.map(p))].map(D(s)))},n=(o,a,s)=>{s=void 0===s?.02:s;const d=(a=a||e.quote()).bid,p=a.ask;return f.scaleLinear().domain([f.min(o.map(d)),f.max(o.map(p))].map(D(s)))},c=(o,a,s)=>(a=a||e.value(),B(o,a,s=void 0===s?.02:s));return{financetime:t,plot:{candlestick:r,ohlc:r,tick:r,closeline:c,tradeline:c,valueline:c,tradepoint:c,valuepoint:c,quotepoint:n,quotebar:n,percent:(o,a)=>{const s=o.domain();return a=a||s[0],o.copy().domain([s[0],s[s.length-1]].map(d=>(d-a)/a))},supstance:(o,a,s)=>(a=a||e.supstance(),B(o,a.value,s=void 0===s?.02:s)),time:(o,a)=>(a=a||e.value(),t().domain(o.map(a.time))),tradearrow:(o,a,s)=>(a=a||e.trade(),B(o,a.price,s=void 0===s?.02:s)),trendline:(o,a,s)=>{a=a||e.trendline(),s=void 0===s?.04:s;const d=At(o,p=>[a.startValue(p),a.endValue(p)]);return f.scaleLinear().domain(f.extent(d).map(D(s)))},volume:(o,a)=>(a=a||e.ohlcv(),f.scaleLinear().domain([0,1.15*f.max(o.map(a.volume))]))}}},B=(e,t,r)=>f.scaleLinear().domain(((e,t,r)=>e.length>0?f.extent(e,t).map(D(r)):[])(e,t,r)),D=(e,t)=>(e=e||0,(r,n,c)=>{if(c.length>2)throw new Error("array.length > 2 unsupported. array.length = "+c.length);return r+(2*n-1)*(t=t||c[c.length-1]-c[0])*e}),At=(e,t)=>e.map(t).reduce((r,n)=>r.concat(n)).filter(r=>null!==r),O=(e,t,r,n)=>(n=n||!1,()=>{const c={},o=t.pathLine(),a=d=>{const p=c.dataSelector(d);p.entry.append("path").attr("class","line"),n&&p.selection.append("path").attr("class","zero"),a.refresh(d)};a.refresh=d=>{const p=c.dataSelector.select(d);if(p.select("path.line").attr("d",o),n){const l=c.accessor;p.select("path.zero").attr("d",t.horizontalPathLine(l.time,c.xScale,l.zero,c.yScale))}};const s=()=>{o.init(c.accessor.time,c.xScale,c.accessor,c.yScale)};return r(a,c).plot(e(),s).dataSelector(r.dataMapper.array),s(),a}),R=(e,t,r)=>()=>{const n={},c=t.pathArea(),o=s=>{n.dataSelector(s).entry.append("path").attr("class","area"),o.refresh(s)};o.refresh=s=>{n.dataSelector.select(s).select("path.area").attr("d",c)};const a=()=>{c.init(n.accessor.time,n.xScale,n.accessor,n.yScale,0)};return r(o,n).plot(e(),a).dataSelector(r.dataMapper.array),a(),o},Ct=(e,t,r,n,c)=>{const o=r.scale();switch(n){case"left":case"right":e.attr("x",c*(Math.max(r.tickSizeInner(),0)+r.tickPadding())).attr("y",rt(t,o)).attr("dy",".32em").style("text-anchor",c<0?"end":"start");break;case"top":case"bottom":e.attr("x",rt(t,o)).attr("y",c*(Math.max(r.tickSizeInner(),0)+r.tickPadding())).attr("dy",c<0?"0em":".72em").style("text-anchor","middle")}},rt=(e,t)=>r=>t(e(r)),Ut=(e,t)=>r=>t(e(r)),Gt=(e,t,r,n,c,o,a)=>s=>{const p=t.scale()(e(s));let l=o;switch(r){case"left":case"right":{let u=0;return n/2<o?l=n/2:u=n/2-o,"M 0 "+p+" l "+a*Math.max(t.tickSizeInner(),1)+" "+-l+" l 0 "+-u+" l "+a*c+" 0 l 0 "+n+" l "+a*-c+" 0 l 0 "+-u}case"top":case"bottom":{let u=0;return c/2<o?l=c/2:u=c/2-o,"M "+p+" 0 l "+-l+" "+a*Math.max(t.tickSizeInner(),1)+" l "+-u+" 0 l 0 "+a*n+" l "+c+" 0 l 0 "+a*-n+" l "+-u+" 0"}default:throw new Error("Unsupported orient value: axisannotation.orient("+r+"). Set to one of: 'top', 'bottom', 'left', 'right'")}},zt=(e,t,r)=>()=>{const n={};let c;const o=d=>{n.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{n.dataSelector.select(d).select("path.point").attr("d",c)};const a=()=>{c=t.joinPath(s)},s=()=>{const d=n.accessor,p=n.xScale,l=n.yScale,u=n.width(p),i=u/u;return m=>{const h=l(d.ask(m)),g=l(d.bid(m)),y=l(h),w=l(g),x=p(d.time(m))-i,M=1.5;return"M"+(x-M)+","+y+" a"+M+","+M+" 0 1,0 3,0 a"+M+","+M+" 0 1,0 -3,0M"+(x-M)+","+w+" a"+M+","+M+" 0 1,0 3,0 a"+M+","+M+" 0 1,0 -3,0"}};return r(o,n).plot(e(),a).width(a).dataSelector(r.dataMapper.array),a(),o},It=(e,t,r)=>()=>{const n={};let c,o;const a=p=>{n.dataSelector(p).entry.append("path").attr("class","quotebar"),a.refresh(p)};a.refresh=p=>{n.dataSelector.select(p).select("path.quotebar").attr("d",c).style("stroke-width",o)};const s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(n.xScale,1,2)},d=()=>{const p=n.accessor,l=n.xScale,u=n.yScale,i=n.width(l),m=i/2;return h=>{const g=u(p.ask(h)),y=u(p.bid(h)),w=l(p.time(h)),x=w-m;return"M"+x+","+g+"l"+i+",0M"+w+","+g+"L"+w+","+y+"M"+x+","+y+"l"+i+",0"}};return r(a,n).plot(e(),s).width(s).dataSelector(r.dataMapper.array),s(),a},Wt=(e,t,r)=>()=>{const n={};let c;const o=d=>{n.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{n.dataSelector.select(d).select("path.point").attr("d",c)};const a=()=>{c=t.joinPath(s)},s=()=>{const d=n.accessor,p=n.xScale,l=n.yScale,i=n.width(p)/2;return m=>{const h=d.price(m);if(isNaN(h))return null;const y=l(h)-0,x=1.5;return"M "+(p(d.time(m))-i-x)+","+y+" a "+x+","+x+" 0 1,0 3,0 a "+x+","+x+" 0 1,0 -3,0"}};return r(o,n).plot(e(),a).width(a).dataSelector(r.dataMapper.array),a(),o},Dt=(e,t,r)=>()=>{const n={};let c;const o=d=>{n.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{n.dataSelector.select(d).select("path.point").attr("d",c)};const a=()=>{c=t.joinPath(s)},s=()=>{const d=n.accessor,p=n.xScale,l=n.yScale,i=n.width(p)/2;return m=>{const h=d.value(m);if(isNaN(h))return null;const y=l(h)-0,x=1.5;return"M"+(p(d.time(m))-i-x)+","+y+"a"+x+","+x+" 0 1,0 3,0a"+x+","+x+" 0 1,0 -3,0"}};return r(o,n).plot(e(),a).width(a).dataSelector(r.dataMapper.array),a(),o},jt=(e,t,r)=>()=>{const n={},c=f.dispatch("enter","out","move"),o=t.plotComposer().scope("composed-annotation").plotScale(v=>v.axis().scale()),a=t.plotComposer().scope("composed-annotation").plotScale(v=>v.axis().scale());let s,d,p,l;const u=v=>{const _=n.dataSelector(v);_.entry.append("path").attr("class","horizontal wire"),_.entry.append("path").attr("class","vertical wire"),_.entry.append("g").attr("class","axisannotation x").call(o),_.entry.append("g").attr("class","axisannotation y").call(a),v.selectAll("rect").data([void 0]).enter().append("rect").style("fill","none").style("pointer-events","all"),u.refresh(v)};u.refresh=v=>{const _=n.xScale.range(),A=n.yScale.range(),S=n.dataSelector.select(v),F=S.select("path.vertical"),k=S.select("path.horizontal"),P=S.select("g.axisannotation.x"),T=S.select("g.axisannotation.y");s=y(),d=g(),v.selectAll("rect").attr("x",Math.min.apply(null,_)).attr("y",Math.min.apply(null,A)).attr("height",Math.abs(A[A.length-1]-A[0])).attr("width",Math.abs(_[_.length-1]-_[0])).on("mouseenter",function(){c.call("enter",this)}).on("mouseout",function(){c.call("out",this),delete S.node().__coord__,w(S.datum()),m(S,F,k,P,T)}).on("mousemove",i(S,F,k,P,T)),m(S,F,k,P,T)};const i=(v,_,A,S,F)=>k=>{v.node().__coord__=f.pointer(k),m(v,_,A,S,F)},m=(v,_,A,S,F)=>{const k=v.node().__coord__;if(void 0!==k){const P=v.datum(),T=n.xScale.invert(k[0]),q=n.yScale.invert(k[1]),G=null!==T&&null!==q&&(n.accessor.x(P)!==T||n.accessor.y(P)!==q);n.accessor.x(P,T),n.accessor.y(P,q),G&&c.call("move",v.node(),P)}_.attr("d",s),A.attr("d",d),S.call(o.refresh),F.call(a.refresh),v.attr("display",M)};u.xAnnotation=function(v){return arguments.length?(o.plots(v instanceof Array?v:[v]),h()):o.plots()},u.yAnnotation=function(v){return arguments.length?(a.plots(v instanceof Array?v:[v]),h()):a.plots()},u.verticalWireRange=function(v){return arguments.length?(p=v,h()):p},u.horizontalWireRange=function(v){return arguments.length?(l=v,h()):l};const h=()=>(o.accessor(n.accessor.x).scale(n.xScale),a.accessor(n.accessor.y).scale(n.yScale),u),g=()=>{const v=l||n.xScale.range();return _=>{if(null===n.accessor.y(_))return null;const A=n.yScale(n.accessor.y(_));return isNaN(A)?null:"M "+v[0]+" "+A+" L "+v[v.length-1]+" "+A}},y=()=>{const v=p||n.yScale.range();return _=>{if(null===n.accessor.x(_))return null;const A=n.xScale(n.accessor.x(_)),S=n.xScale.range();return A<Math.min(S[0],S[S.length-1])||A>Math.max(S[0],S[S.length-1])?null:"M "+A+" "+v[0]+" L "+A+" "+v[v.length-1]}},w=v=>(n.accessor.x(v=v||{},null),n.accessor.y(v,null),v),x=v=>void 0===v||null===n.accessor.x(v)||null===n.accessor.y(v),M=v=>x(v)?"none":null;return r(u,n).plot(e(),h).dataSelector(v=>x(v)?[w()]:[v]).on(c),n.dataSelector.scope("crosshair"),h()},Ht=(e,t,r)=>()=>{const n={};let c,o;const a=p=>{t.appendPathsUpDownEqual(n.dataSelector(p).selection,n.accessor,"ohlc"),a.refresh(p)};a.refresh=p=>{p.selectAll("path.ohlc").attr("d",c).style("stroke-width",o)};const s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(n.xScale,1,2)},d=()=>{const p=n.accessor,l=n.xScale,u=n.yScale,m=n.width(l)/2;return h=>{const g=u(p.open(h)),y=u(p.close(h)),w=l(p.time(h));return"M "+(w-m)+" "+g+" l "+m+" 0 M "+w+" "+u(p.high(h))+" L "+w+" "+u(p.low(h))+" M "+w+" "+y+" l "+m+" 0"}};return r(a,n).plot(e(),s).width(s).dataSelector(r.dataMapper.array),s(),a},Rt=(e,t,r)=>()=>{const o={},a=f.dispatch("mouseenter","mouseout","mousemove","drag","dragstart","dragend"),s=t.plotComposer().scope("composed-annotation").plotScale(l=>l.axis().scale()),d=l=>{const u=o.dataSelector(l);u.entry.append("g").attr("class","supstance").append("path"),u.entry.append("g").attr("class","axisannotation y").call(s),u.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(t.interaction.mousedispatch(a)).append("path").style("stroke-width","16px"),d.refresh(l)};d.refresh=l=>{ot(o.dataSelector.select(l),o.accessor,o.xScale,o.yScale,s)},d.drag=l=>{l.selectAll(".interaction path").call(((o,a,s,d,p)=>{const l=f.drag().subject(u=>({x:0,y:d(a(u))})).on("drag",(u,i)=>{const m=d.invert(u.y),h=f.select((void 0).parentNode.parentNode);a.value(i,m),ot(h,a,s,d,p),o.call("drag",void 0,i)});return t.interaction.dragStartEndDispatch(l,o)})(a,o.accessor,o.xScale,o.yScale,s))},d.annotation=function(l){return arguments.length?(s.plots(l instanceof Array?l:[l]),d):s.plots()};const p=()=>(s.accessor(o.accessor.value).scale(o.yScale),d);return r(d,o).dataSelector(r.dataMapper.unity).plot(e(),p).on(a),o.dataSelector.scope("supstance"),p()},ot=(e,t,r,n,c)=>{e.select(".supstance path").attr("d",ct(t,r,n)),e.select(".interaction path").attr("d",ct(t,r,n)),e.select(".axisannotation.y").call(c.refresh)},ct=(e,t,r)=>n=>{let c;Yt(e)?(c=[e.start(n),e.end(n)],c[0]=void 0!==c[0]?t(c[0]):t.range()[0],c[1]=void 0!==c[1]?t(c[1]):t.range()[1]):c=t.range();const o=r(e.value(n));return"M "+c[0]+" "+o+" L "+c[c.length-1]+" "+o},Yt=e=>void 0!==e.start&&void 0!==e.end,Bt=(e,t,r)=>()=>{const n={};let c,o;const a=p=>{n.dataSelector(p).entry.append("path").attr("class","tick"),a.refresh(p)};a.refresh=p=>{n.dataSelector.select(p).select("path.tick").attr("d",c).style("stroke-width",o)};const s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(n.xScale,1,2)},d=()=>{const p=n.accessor,l=n.xScale,u=n.yScale,i=n.width(l),m=i/2;return h=>{const g=u(p.high(h)),y=u(p.low(h)),w=l(p.time(h)),x=w-m;return"M "+x+" "+g+" l "+i+" 0 M "+w+" "+g+" L "+w+" "+y+" M "+x+" "+y+" l "+i+" 0"}};return r(a,n).plot(e(),s).width(s).dataSelector(r.dataMapper.array),s(),a},st=()=>{let e=L(0),t=L(0),r=L(12),n=L(15),c=L("up"),o=L(!0);const a=(s,d)=>{const p=e(s,d),l=t(s,d),u=r(s,d),i=n(s,d),m=c(s,d),h=o(s,d),g="left"===m||"up"===m?1:-1,y=u/3,w=u/2,x=h?i/2:i;let M="M "+p+" "+l;switch(m){case"up":case"down":M+=" l "+-w+" "+g*x+" l "+y+" 0",h&&(M+=" l 0 "+g*x),M+=" l "+y+" 0",h&&(M+=" l 0 "+-g*x),M+=" l "+y+" 0";break;case"left":case"right":M+=" l "+g*x+" "+-w+" l 0 "+y,h&&(M+=" l "+g*x+" 0"),M+=" l 0 "+y,h&&(M+=" l "+-g*x+" 0"),M+=" l 0 "+y;break;default:throw new Error("Unsupported arrow.orient() = "+c)}return M+" z"};return a.x=function(s){return arguments.length?(e=L(s),a):e},a.y=function(s){return arguments.length?(t=L(s),a):t},a.height=function(s){return arguments.length?(n=L(s),a):n},a.width=function(s){return arguments.length?(r=L(s),a):r},a.orient=function(s){return arguments.length?(c=L(s),a):c},a.tail=function(s){return arguments.length?(o=L(s),a):o},a},lt=(e,t,r)=>()=>{const n={},c=f.dispatch("mouseenter","mouseout"),o=st().orient(i=>"buy"===n.accessor.type(i)?"up":"down");let s,a=i=>n.yScale(n.accessor.price(i));const d=i=>{const m=n.dataSelector(i),h=u(i.datum());t.appendPathsGroupBy(m.selection,n.accessor,"tradearrow",h),m.entry.append("path").attr("class","highlight").style("pointer-events","none"),m.selection.selectAll("path.tradearrow").on("mouseenter",function(g,y){const w=l(y,f.pointer(g)[0]);f.select(this.parentNode).select("path.highlight").datum(w.d).attr("d",o).call(Ot,h),c.call("mouseenter",this,w.d,w.i)}).on("mouseout",function(g){f.select(this.parentNode).selectAll("path.highlight").datum([]).attr("d",null).attr("class","highlight");const y=l(g,f.pointer(event)[0]);c.call("mouseout",this,y.d,y.i)}),d.refresh(i)};d.refresh=i=>{i.selectAll("path.tradearrow").attr("d",s)},d.orient=function(i){return arguments.length?(o.orient(i),p()):o.orient()},d.y=function(i){return arguments.length?(a=L(i),p()):a},d.arrow=()=>o;const p=()=>(o.x(i=>n.xScale(n.accessor.time(i))).y(a),s=t.joinPath(()=>o),lt),l=(i,m)=>i.map((h,g)=>({d:h,i:g,x:n.xScale(n.accessor.time(h))})).reduce((h,g)=>Math.abs(h.x-m)<Math.abs(g.x-m)?h:g),u=i=>i.map(m=>n.accessor.time(m)).reduce((m,h)=>(void 0===m[h]&&(m[h]=g=>h===n.accessor.time(g)),m),{});return r(d,n).plot(e(),p).on(c).dataSelector(r.dataMapper.array),p(),d},Ot=(e,t)=>{Object.keys(t).forEach(r=>{e.classed(r,t[r])})},Xt=(e,t,r)=>{const c=(s,d,p,l,u,i)=>{const m=f.drag();return m.subject((h,g)=>({x:l(p(g)),y:i(u(g))})).on("drag",function(h,g){a(p,l,h.x,u,i,h.y,g),X(f.select(this.parentNode.parentNode.parentNode),d,l,i),s.call("drag",this,g)}),t.interaction.dragStartEndDispatch(m,s)},o=(s,d,p,l)=>{const u={},i=f.drag();return i.subject((m,h)=>(u.start={date:p(d.startTime(h)),value:l(d.startValue(h))},u.end={date:p(d.endTime(h)),value:l(d.endValue(h))},{x:0,y:0})).on("drag",function(m,h){a(d.startTime,p,m.x+u.start.date,d.startValue,l,m.y+u.start.value,h),a(d.endTime,p,m.x+u.end.date,d.endValue,l,m.y+u.end.value,h),X(f.select(this.parentNode.parentNode.parentNode),d,p,l),s.call("drag",this,h)}),t.interaction.dragStartEndDispatch(i,s)},a=(s,d,p,l,u,i,m)=>{const h=d.invert(p);null!=h&&s(m,h),l(m,u.invert(i))};return()=>{const s={},d=f.dispatch("mouseenter","mouseout","mousemove","drag","dragstart","dragend"),p=l=>{const u=s.dataSelector(l),i=u.entry.append("g").attr("class","trendline");i.append("path").attr("class","body"),i.append("circle").attr("class","start").attr("r",1),i.append("circle").attr("class","end").attr("r",1);const m=u.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(t.interaction.mousedispatch(d));m.append("path").attr("class","body").style("stroke-width","16px"),m.append("circle").attr("class","start").attr("r",8),m.append("circle").attr("class","end").attr("r",8),p.refresh(l)};return p.refresh=l=>{X(s.dataSelector.select(l),s.accessor,s.xScale,s.yScale)},p.drag=l=>{l.selectAll(".interaction circle.start").call(c(d,s.accessor,s.accessor.startTime,s.xScale,s.accessor.startValue,s.yScale)),l.selectAll(".interaction circle.end").call(c(d,s.accessor,s.accessor.endTime,s.xScale,s.accessor.endValue,s.yScale)),l.selectAll(".interaction path.body").call(o(d,s.accessor,s.xScale,s.yScale))},r(p,s).dataSelector(r.dataMapper.unity).plot(e()).on(d),p}},X=(e,t,r,n)=>{e.selectAll("path.body").attr("d",Jt(t,r,n)),e.selectAll("circle.start").attr("cx",ut(t.startTime,r)).attr("cy",it(t.startValue,n)),e.selectAll("circle.end").attr("cx",ut(t.endTime,r)).attr("cy",it(t.endValue,n))},Jt=(e,t,r)=>n=>"M "+t(e.startTime(n))+" "+r(e.startValue(n))+" L "+t(e.endTime(n))+" "+r(e.endValue(n)),ut=(e,t)=>r=>t(e(r)),it=(e,t)=>r=>t(e(r)),Kt=(e,t,r)=>()=>{const n={};let c;const o=p=>{const l=n.dataSelector(p);s()?t.appendPathsUpDownEqual(l.selection,n.accessor,"volume"):l.entry.append("path").attr("class","volume"),o.refresh(p)};o.refresh=p=>{s()?p.selectAll("path.volume").attr("d",c):n.dataSelector.select(p).select("path.volume").attr("d",c)};const a=()=>{c=t.joinPath(d)},s=()=>n.accessor.open&&n.accessor.close,d=()=>{const p=n.accessor,l=n.xScale,u=n.yScale,i=n.width(l),m=i/2;return h=>{const g=p.volume(h);if(isNaN(g))return null;const y=u(0),w=u(g)-y;return"M "+(l(p.time(h))-m)+" "+y+" l 0 "+w+" l "+i+" 0 l 0 "+-w}};return r(o,n).plot(e(),a).width(a).dataSelector(r.dataMapper.array),a(),o},$t={arrow:st},Zt={plot:(()=>{const e=bt(),t=(e=>{const t=(r,n)=>{const c={dataSelector:(o,a)=>(n.dataSelector=e.dataSelector(o).key(a),c),xScale:o=>(n.xScale=at().financetime(),r.xScale=function(a){return arguments.length?(n.xScale=a,o&&o(),r):n.xScale},c),yScale:o=>(n.yScale=f.scaleLinear(),r.yScale=function(a){return arguments.length?(n.yScale=a,o&&o(),r):n.yScale},c),accessor:(o,a)=>(n.accessor=o,r.accessor=function(s){return arguments.length?(n.accessor=s,a&&a(),r):n.accessor},c),width:o=>(n.width=e.barWidth,r.width=function(a){return arguments.length?(n.width=L(a),o&&o(),r):n.width},c),on:(o,a)=>(r.on=(s,d)=>(o.on(s,d),a&&a(),r),c),plot:(o,a)=>c.xScale(a).yScale(a).accessor(o,a)};return c};return t.dataMapper=e.dataSelector.mapper,t})(e),r=nt(),n=((e,t,r)=>()=>{const n={};let c,o,a;const s=u=>{const i=n.dataSelector(u);t.appendPathsUpDownEqual(i.selection,n.accessor,["candle","body"]),t.appendPathsUpDownEqual(i.selection,n.accessor,["candle","wick"]),s.refresh(u)};s.refresh=u=>{u.selectAll("path.candle.body").attr("d",c).style("stroke-width",a),u.selectAll("path.candle.wick").attr("d",o).style("stroke-width",a)};const d=()=>{c=t.joinPath(p),o=t.joinPath(l),a=t.scaledStrokeWidth(n.xScale,1,4)},p=()=>{const u=n.accessor,i=n.xScale,m=n.yScale,h=n.width(i),g=h/2;return y=>{const w=m(u.open(y)),x=m(u.close(y)),M=i(u.time(y))-g;let v="M "+M+" "+w+" l "+h+" 0";return w!==x&&(v+=" L "+(M+h)+" "+x+" l "+-h+" 0 L "+M+" "+w),v}},l=()=>{const u=n.accessor,i=n.xScale,m=n.yScale,h=n.width(i),g=h/2;return y=>{const w=m(u.open(y)),x=m(u.close(y)),M=i(u.time(y)),v=M-g;let _="M "+M+" "+m(u.high(y))+" L "+M+" "+Math.min(w,x);return w===x&&(_+=" M "+v+" "+w+" l "+h+" 0"),_+" M "+M+" "+Math.max(w,x)+" L "+M+" "+m(u.low(y))}};return r(s,n).plot(e(),d).width(d).dataSelector(r.dataMapper.array),d(),s})(r.ohlcv,e,t),c=((e,t)=>()=>{const r={};let o,c=f.axisTop(f.scaleLinear()),a=14,s=50,d=[0,0],p="bottom";const l=u=>{const i=r.dataSelector.mapper(((e,t)=>r=>{let n=t.range();const c=n[0],o=n[n.length-1];return n=c<o?[c,o]:[o,c],r.filter(a=>{if(null===e(a)||void 0===e(a))return!1;const s=t(e(a));return null!==s&&!isNaN(s)&&n[0]<=s&&s<=n[1]})})(r.accessor,c.scale()))(u);i.entry.append("path"),i.entry.append("text"),l.refresh(u)};return l.refresh=u=>{const i=o||(c.tickFormat()?c.tickFormat():c.scale().tickFormat());((e,t,r,n,c,o,a,s,d)=>{const p="left"===n||"top"===n?-1:1;e.attr("transform","translate("+d[0]+","+d[1]+")"),e.select("path").attr("d",Gt(t,r,n,o,a,s,p)),e.select("text").text(Ut(t,c)).call(Ct,t,r,n,p)})(r.dataSelector.select(u),r.accessor,c,p,i,a,s,4,d)},l.axis=function(u){return arguments.length?(c=u,l):c},l.orient=function(u){return arguments.length?(p=u,l):p},l.format=function(u){return arguments.length?(o=u,l):o},l.height=function(u){return arguments.length?(a=u,l):a},l.width=function(u){return arguments.length?(s=u,l):s},l.translate=function(u){return arguments.length?(d=u,l):d},t(l,r).accessor(e()).dataSelector(),l})(r.value,t);return{ohlcarea:R(r.ohlcv,e,t),valuearea:R(r.value,e,t),tradearea:R(r.trade,e,t),quotearea:R(r.quote,e,t),axisannotation:c,quotepoint:zt(r.quote,e,t),quotebar:It(r.quote,e,t),candlestick:n,tradepoint:Wt(r.trade,e,t),valuepoint:Dt(r.value,e,t),closeline:O(r.ohlcv,e,t),tradeline:O(r.trade,e,t),valueline:O(r.value,e,t),crosshair:jt(r.crosshair,e,t),ohlc:Ht(r.ohlcv,e,t),supstance:Rt(r.supstance,e,t),tick:Bt(r.tick,e,t),tradearrow:lt(r.trade,e,t),trendline:Xt(r.trendline,e,t),volume:Kt(r.volume,e,t)}})(),scale:at(),shapes:$t}}}]);