import{a as S}from"./chunk-S53QGRZ7.js";import{a as O}from"./chunk-3H6C7N3C.js";import{a as ot}from"./chunk-IEKDCRBV.js";import{Ca as et,Da as nt,G as tt,Qa as mt,Y as it,f as Y,g as J,h as Q,i as V,k as Z}from"./chunk-GXN2U6XA.js";import{o as K}from"./chunk-QQ6YFGSV.js";import{Ca as U,Ha as W,Jc as M,Mc as m,Wa as F,Wb as j,Zb as G,_b as q,ca as C,ib as $,na as P,tb as X}from"./chunk-54YCK6MI.js";import{a as k}from"./chunk-VOSPIT4N.js";mt();var ft=["*"],ut={fillColor:void 0,strokeColor:"steelblue",strokeWidth:1,interpolation:"natural"},dt="natural",ht=new Date(-864e13),gt=new Date(864e13),at=300,st=100,rt=60,b=30,E=50,N=18,Et=(()=>{let A=class A{constructor(){this.elementRef=C(U),this.document=C(P),this.platformId=C(W),this.currentConfiguration=[],this.currentData=[],this.currentDataEmpty=!0,this.width=m(at),this.height=m(st),this.configuration=m.required(),this.timeAxis=m([]),this.valueAxis=m([]),this.min=m(),this.max=m(),this.from=m(),this.till=m(),this.data=m.required(),M(()=>{this.forcedValueMin=this.min()}),M(()=>{this.forcedValueMax=this.max()}),M(()=>{this.forcedTimeMin=this.from()}),M(()=>{this.forcedTimeMax=this.till()}),M(()=>{let i=this.data(),e=gt,r=ht,a=1/0,t=-1/0,d=!0;for(let l of i){let f=l.length;if(f<1)continue;d=!1,e>l[0].time&&(e=l[0].time),r<l[f-1].time&&(r=l[f-1].time);let T=S(l);for(let D of l){let h=T(D);isNaN(h)||(a>h&&(a=h),t<h&&(t=h))}}this.currentDataEmpty=d,this.dataTimeMin=e,this.dataTimeMax=r,this.dataValueMin=a,this.dataValueMax=t,this.currentData=i,this.render()}),M(()=>{let i=this.configuration();if(i&&i!=null&&i.length>0){let e=i.length,r=this.currentConfiguration.length;if(r>0){let a=Math.min(e,r);for(let t=0;t<a;++t)this.currentConfiguration[t]=k(k({},this.currentConfiguration[t]),i[t]);if(e>a)for(let t=a;t<e;++t)this.currentConfiguration[t]=k({},i[t])}else this.currentConfiguration=[...i]}this.render()}),X(()=>{this.render()})}render(){if(!K(this.platformId)||!this.document||this.document===null)return;let i=this.currentData;if(this.currentDataEmpty||!i||i===null||i.length<1)return;let e=Z(this.elementRef.nativeElement);if(!e||e===null)return;e.select("svg").remove();let r=this.currentConfiguration,a=this.timeAxis().includes("top"),t=this.timeAxis().includes("bottom"),d=this.valueAxis().includes("left"),l=this.valueAxis().includes("right"),f=this.valueAxis().includes("grid"),T=d||f?E:a||t?E/3:0,D=l?E:a||t?E/3:0,h=a?N:d||l||f?N/3:0,z=t?N:d||l||f?N/3:0,R=ot(this.elementRef,this.width(),this.height(),at,st),x=R[0],p=R[1],v=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",x).attr("height",p).attr("viewBox",`0 0 ${x} ${p}`),I=this.forcedTimeMin===void 0?this.dataTimeMin:this.forcedTimeMin,w=this.forcedTimeMax===void 0?this.dataTimeMax:this.forcedTimeMax,y=it().range([T,x-D]).domain([I,w]);if(a){y.nice();let n=s=>s.attr("font-family","sans-serif").attr("font-size",10).attr("fill","none").attr("transform",`translate(0,${h})`).call(Y(y).ticks(x/rt).tickSizeOuter(0));v.append("g").call(n)}if(t){y.nice();let n=s=>s.attr("font-family","sans-serif").attr("font-size",10).attr("fill","none").attr("transform",`translate(0,${p-z})`).call(Q(y).ticks(x/rt).tickSizeOuter(0));v.append("g").call(n)}let B=this.forcedValueMin===void 0?this.dataValueMin:this.forcedValueMin,lt=this.forcedValueMax===void 0?this.dataValueMax:this.forcedValueMax,u=tt().domain([B,lt]).range([p-z,h]);if(d&&!f){u.nice();let n=s=>s.attr("transform",`translate(${T},0)`).call(V(u).ticks(p/b).tickSizeOuter(0));v.append("g").call(n)}if(l){u.nice();let n=s=>s.attr("transform",`translate(${x-D},0)`).call(J(u).ticks(p/b).tickSizeOuter(0));v.append("g").call(n)}if(f){u.nice();let n=s=>s.attr("transform",`translate(${T},0)`).call(V(u).ticks(p/b).tickSizeOuter(0)).call(g=>{d||g.select(".domain").remove()}).call(g=>g.selectAll(t?".tick:not(:first-of-type) line":".tick line").clone().attr("x2",x-T-D).attr("stroke","currentColor").attr("stroke-width",.3));v.append("g").call(n)}let ct=r.length;for(let n=0;n<i.length;++n){let s=i[n],g=S(s),c=n<ct?r[n]:ut,H=c.interpolation?c.interpolation:dt;if(c.fillColor&&c.fillColor!=="none"){let L=nt().curve(O(H)).defined(o=>!isNaN(g(o))&&o.time>=I&&o.time<=w).x(o=>y(o.time)).y0(()=>u(B)).y1(o=>u(g(o)));v.append("path").datum(s).attr("fill",c.fillColor).attr("d",L)}if(c.strokeColor&&c.strokeWidth&&c.strokeWidth>0&&c.strokeColor!=="none"){let L=et().curve(O(H)).defined(o=>!isNaN(g(o))&&o.time>=I&&o.time<=w).x(o=>y(o.time)).y(o=>u(g(o)));v.append("path").datum(s).attr("stroke-width",c.strokeWidth).attr("stroke",c.strokeColor).attr("stroke-linejoin","round").attr("stroke-linecap","round").style("fill","none").attr("d",L)}}}};A.\u0275fac=function(e){return new(e||A)},A.\u0275cmp=$({type:A,selectors:[["mb-multiline"]],hostBindings:function(e,r){e&1&&j("resize",function(){return r.render()},F)},inputs:{width:[1,"width"],height:[1,"height"],configuration:[1,"configuration"],timeAxis:[1,"timeAxis"],valueAxis:[1,"valueAxis"],min:[1,"min"],max:[1,"max"],from:[1,"from"],till:[1,"till"],data:[1,"data"]},ngContentSelectors:ft,decls:1,vars:0,template:function(e,r){e&1&&(G(),q(0))},styles:["[_nghost-%COMP%]{---multiline-grid-color: var(--multiline-grid-color, var(--mat-multiline-grid-color, var(--mat-sys-on-surface-variant)));---multiline-grid-opacity: var(--multiline-grid-opacity, var(--mat-multiline-grid-opacity, .5));---multiline-axis-color: var(--multiline-axis-color, var(--mat-multiline-axis-color, var(--mat-sys-on-surface-variant)));---multiline-axis-font-family: var(--multiline-axis-font-family, var(--mat-multiline-axis-font-family, Roboto, sans-serif));---multiline-axis-font-size: var(--multiline-axis-font-size, var(--mat-multiline-axis-font-size, 12px));---multiline-axis-font-weight: var(--multiline-axis-font-weight, var(--mat-multiline-axis-font-weight, 400))}[_nghost-%COMP%]     svg g path{fill:none;stroke:var(---multiline-axis-color)}[_nghost-%COMP%]     svg g g.tick path{fill:none;stroke:var(---multiline-axis-color)}[_nghost-%COMP%]     svg g g.tick line{fill:none;stroke:var(---multiline-grid-color);stroke-opacity:var(---multiline-grid-opacity)}[_nghost-%COMP%]     svg g g.tick text{fill:var(---multiline-axis-color);font-family:var(---multiline-axis-font-family);font-size:var(---multiline-axis-font-size);font-weight:var(---multiline-axis-font-weight);cursor:default}"],changeDetection:0});let _=A;return _})();export{Et as a};
