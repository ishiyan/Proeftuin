import{Ca as Nt,D as Mt,Da as Rt,G as E,Ia as _t,Qa as Et,X as J,e as bt,h as H,i as Dt,k as At,v as Ct}from"./chunk-GXN2U6XA.js";import{o as j}from"./chunk-5NZO7CYW.js";import{Aa as ut,Fa as mt,Gb as ct,Jb as ht,Kb as gt,Lb as ft,Lc as yt,Mb as pt,Mc as Tt,ca as q,cc as vt,dc as xt,ib as P,jc as wt,tb as dt}from"./chunk-VOP6QBU4.js";import"./chunk-VOSPIT4N.js";Et();Et();function Ot(){if(typeof window>"u"||typeof document>"u")return function(){return{initialData:function(t){return arguments.length===0?[]:this},datum:function(t){return arguments.length===0?null:this},width:function(t){return arguments.length===0?700:this},height:function(t){return arguments.length===0?300:this},border:function(t){return arguments.length===0?!1:this},left:function(t){return arguments.length===0?50:this},top:function(t){return arguments.length===0?20:this},right:function(t){return arguments.length===0?30:this},bottom:function(t){return arguments.length===0?20:this},title:function(t){return arguments.length===0?"":this},xTitle:function(t){return arguments.length===0?"":this},yTitle:function(t){return arguments.length===0?"":this},barWidth:function(t){return arguments.length===0?3:this},isRunning:function(t){return arguments.length===0?!0:this},version:"0.1.0"}};var g="0.1.0",o,V,s,l=300,f=10,y=700,p=300,a={top:20,bottom:20,left:50,right:30,topNav:10,bottomNav:20},T={chartTitle:20,xAxis:20,yAxis:20,xTitle:20,yTitle:20,navChart:70},b=3,C=100,z=0,u,d,m,O=!0,G=!0,W=!0,M,k,zt=0,K=!0,e=function(t){if(k=t,k==null){console.error("selection is undefined");return}u=u||"",m=m||"",d=d||"";var U=u==""?0:T.chartTitle,Gt=m==""?0:T.xTitle,Yt=d==""?0:T.yTitle,St=O?T.xAxis:0,qt=G?T.yAxis:0,Z=W?T.navChart:0,$=a.top+U,N=p-$-a.bottom-U-Gt-St-Z+30,D=Z-a.topNav-a.bottomNav,It=p-a.bottom-D-a.topNav,v=y-a.left-a.right,tt=v,et=k.append("svg").attr("width",y).attr("height",p).style("border",function(r){return M?"1px solid lightgray":null}),R=et.append("g").attr("transform","translate ("+a.left+","+$+")");R.append("defs").append("clipPath").attr("id","myClip").append("rect").attr("x",0).attr("y",0).attr("width",v).attr("height",N),R.append("rect").attr("x",0).attr("y",0).attr("width",v).attr("height",N).style("fill","#f5f5f5");var Lt=R.append("g").attr("class","barGroup").attr("transform","translate(0, 0)").attr("clip-path","url(#myClip)").append("g"),S=R.append("g").attr("class","x axis").attr("transform","translate(0,"+N+")"),nt=R.append("g").attr("class","y axis");S.append("text").attr("class","title").attr("x",v/2).attr("y",25).attr("dy",".71em").text(function(r){var n=m??"";return n}),nt.append("text").attr("class","title").attr("transform","rotate(-90)").attr("x",-N/2).attr("y",-35).attr("dy",".71em").text(function(r){var n=d??"";return n}),R.append("text").attr("class","chartTitle").attr("x",v/2).attr("y",-20).attr("dy",".71em").text(function(r){var n=u??"";return n});var c=J().range([0,v]),I=E().domain([z,C]).range([N,0]),B=H(c),Ft=Dt(I),L=et.append("g").attr("transform","translate ("+a.left+","+It+")");L.append("rect").attr("x",0).attr("y",0).attr("width",v).attr("height",D).style("fill","#F5F5F5").style("shape-rendering","crispEdges").attr("transform","translate(0, 0)");var Q=L.append("g").attr("class","nav"),rt=L.append("g").attr("class","x axis").attr("transform","translate(0,"+D+")"),i=J().range([0,tt]),at=E().domain([z,C]).range([D,0]),it=H(i),Pt=Rt().curve(_t).x(function(r){return i(r.time)}).y1(function(r){return at(r.value)}).y0(D),Vt=Nt().x(function(r){return i(r.time)}).y(function(r){return at(r.value)}),ot=new Date().getTime(),x=new Date(ot),w=new Date(x.getTime()-l*1e3),jt=x.getTime()-w.getTime(),A=new Date(ot),h=new Date(x.getTime()-v/f*1e3),X=A.getTime()-h.getTime(),st=h.getTime()-w.getTime();c.domain([h,A]),i.domain([w,x]),B.scale(c)(S),Ft.scale(I)(nt),it.scale(i)(rt);var F,lt=Ct().extent([[0,0],[tt,D]]).on("brush end",function(r){var n=r.selection||i.range();h=i.invert(n[0]),A=i.invert(n[1]),X=A.getTime()-h.getTime(),st=h.getTime()-w.getTime(),X==0&&(X=l*1e3,st=0),c.domain(n===null?i.domain():n),B.scale(c)(S),F=r.selection||i.range(),c.domain(F.map(i.invert,i)),Y()}),Ht=L.append("g").attr("class","viewport").call(lt).selectAll("rect").attr("height",D);s=V||[],Y();function Y(){s=s.filter(function(n){if(n.time.getTime()>w.getTime()&&n.time.getTime()<x.getTime())return!0});var r=Lt.selectAll(".bar").data(s);r.exit().remove(),r.enter().append("rect").attr("class","bar").attr("id",function(){return"bar-"+zt++}).attr("shape-rendering","crispEdges"),r.attr("x",function(n){var _=Math.round(c(n.time)-b);return _!==_&&(_=0),_}).attr("y",function(n){return I(n.value)}).attr("width",b).attr("height",function(n){return N-I(n.value)}).style("fill",function(n){return n.color==null?"black":n.color}).style("fill-opacity",1),Q.selectAll("path").remove(),Q.append("path").attr("class","area").attr("d",Pt(s)),Q.append("path").attr("class","line").attr("d",Vt(s))}return setInterval(function(){var r=i.domain(),n=r[1]-r[0],_=r[0]-i.domain()[0];x=new Date,w=new Date(x.getTime()-l*1e3),h=new Date(w.getTime()+_),A=new Date(h.getTime()+n),lt.extent([h,A]),c.domain([h,A]),F&&c.domain(F.map(i.invert,i)),i.domain([w,x]),B.scale(c)(S),it.scale(i)(rt),Y()},500),e};return e.initialData=function(t){return arguments.length==0?V:(V=t,e)},e.datum=function(t){return arguments.length==0?o:(o=t,s.push(o),e)},e.width=function(t){return arguments.length==0?y:(y=t,e)},e.height=function(t){return arguments.length==0?p:(p=t,e)},e.border=function(t){return arguments.length==0?M:(M=t,e)},e.left=function(t){return arguments.length==0?a.left:(a.left=t,e)},e.top=function(t){return arguments.length==0?a.top:(a.top=t,e)},e.right=function(t){return arguments.length==0?a.right:(a.right=t,e)},e.bottom=function(t){return arguments.length==0?a.bottom:(a.bottom=t,e)},e.title=function(t){return arguments.length==0?u:(u=t,e)},e.xTitle=function(t){return arguments.length==0?m:(m=t,e)},e.yTitle=function(t){return arguments.length==0?d:(d=t,e)},e.barWidth=function(t){return arguments.length==0?b:(b=t,e)},e.isRunning=function(t){return arguments.length==0?K:(K=t,e)},e.version=g,e}var Xt=["container"],kt=(()=>{let o=class o{constructor(){this.platformId=q(mt),this.element=q(ut),this.container=Tt.required("container"),this.svgheight=yt(),dt({write:()=>{this.setupResizeObserver(),this.render()}})}ngOnDestroy(){this.resizeObserver?.disconnect(),this.chart.isRunning(!1)}setupResizeObserver(){j(this.platformId)&&(this.resizeObserver=new ResizeObserver(()=>{this.render()}),this.resizeObserver.observe(this.element.nativeElement))}render(){if(!j(this.platformId))return;let s={top:20,right:20,bottom:20,left:40},l=this.container().nativeElement.getBoundingClientRect().width,f=At(this.element.nativeElement).select("#viewDiv"),y=E().domain([300,1700]).range([300,1700]).clamp(!0),p=E().domain([0,1]).range([30,95]),b=Mt(2e3,500),C=new Date().getTime()-3e5-4e3,z=bt(300).map((m,O,G)=>{let W=p(Math.random()),M=Math.round(y(b()));C+=M;let k=new Date(C);return{interval:M,value:W,time:k,ts:C}}),u=Ot().border(!1).width(l).height(this.svgheight()).barWidth(2).left(s.left).top(s.top).right(s.right).bottom(s.bottom).initialData(z);f.select("#chartDiv").remove(),f.append("div").attr("id","chartDiv").call(u),u.isRunning(!0),this.chart=u;function d(){let m=Math.round(y(b()));setTimeout(()=>{let O=new Date,G={value:p(Math.random()),time:O,color:"forestgreen",ts:O.getTime(),interval:m};u.datum(G),u.isRunning()&&d()},m)}d()}};o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=P({type:o,selectors:[["app-d3-real-time-chart"]],viewQuery:function(l,f){l&1&&vt(f.container,Xt,5),l&2&&xt()},inputs:{svgheight:[1,"svgheight"]},decls:4,vars:0,consts:[["container",""],[1,"container"],["id","viewDiv"]],template:function(l,f){l&1&&(gt(0,"div",1,0),wt(2,` The chart's time domain is moving with the passage of time, which means that any data placed in the chart eventually will age out and leave the chart. In addition to the main chart, the component also manages a "focus" window with a viewport (d3.brush) that can moved and sized to view an arbitrary portion of the time series data.
`),ft(),pt(3,"div",2))},styles:[`.container{padding:12px}.axis text{font:10px sans-serif}.chartTitle{font-size:12px;font-weight:700;text-anchor:middle}.axis .title{font-weight:700;text-anchor:middle}.axis path,.axis line{fill:none;stroke:#000;shape-rendering:crispEdges}.x.axis path{fill:none;stroke:#000;shape-rendering:crispEdges}.nav .area{fill:none;stroke-width:0px}.nav .line{fill:none;stroke:#000;stroke-width:1px}.viewport{stroke:gray;fill:none;fill-opacity:.3;stroke-width:0px}.viewport .extent{fill:green}.well{padding-top:0;padding-bottom:0}
`],encapsulation:2,changeDetection:0});let g=o;return g})();var ne=(()=>{let o=class o{};o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=P({type:o,selectors:[["app-d3-realtime-chart"]],decls:1,vars:1,consts:[[1,"sample8",3,"svgheight"]],template:function(l,f){l&1&&ht(0,"app-d3-real-time-chart",0),l&2&&ct("svgheight",500)},dependencies:[kt],styles:[".sample8[_ngcontent-%COMP%]{margin:0;padding:0}"]});let g=o;return g})();export{ne as RealtimeChartComponent};
