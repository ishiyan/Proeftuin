import{Ca as kt,D as Rt,Da as Gt,G as k,Ia as Lt,Qa as St,X as j,e as At,h as q,i as Mt,k as Nt,v as Et}from"./chunk-GXN2U6XA.js";import{o as Ct}from"./chunk-QQ6YFGSV.js";import{Ca as dt,Ha as mt,Ib as ht,Lb as pt,Mb as gt,Mc as Dt,Nb as vt,Nc as bt,Ob as ft,Wa as ct,Wb as xt,ca as V,ec as wt,fc as Tt,ib as W,kc as yt,na as lt,tb as ut}from"./chunk-54YCK6MI.js";import"./chunk-VOSPIT4N.js";St();St();function Bt(){var g="0.1.0",l,z,o,a=300,c=10,v=700,f=300,i={top:20,bottom:20,left:50,right:30,topNav:10,bottomNav:20},y={chartTitle:20,xAxis:20,yAxis:20,xTitle:20,yTitle:20,navChart:70},D=3,A=100,S=0,d,u,m,G=!0,B=!0,O=!0,M,L,It=0,U=!0,t=function(e){if(L=e,L==null){console.error("selection is undefined");return}d=d||"",m=m||"",u=u||"";var J=d==""?0:y.chartTitle,Ht=m==""?0:y.xTitle,jt=u==""?0:y.yTitle,Pt=G?y.xAxis:0,Ut=B?y.yAxis:0,K=O?y.navChart:0,Z=i.top+J,N=f-Z-i.bottom-J-Ht-Pt-K+30,b=K-i.topNav-i.bottomNav,Vt=f-i.bottom-b-i.topNav,x=v-i.left-i.right,$=x,tt=L.append("svg").attr("width",v).attr("height",f).style("border",function(r){return M?"1px solid lightgray":null}),E=tt.append("g").attr("transform","translate ("+i.left+","+Z+")");E.append("defs").append("clipPath").attr("id","myClip").append("rect").attr("x",0).attr("y",0).attr("width",x).attr("height",N),E.append("rect").attr("x",0).attr("y",0).attr("width",x).attr("height",N).style("fill","#f5f5f5");var Wt=E.append("g").attr("class","barGroup").attr("transform","translate(0, 0)").attr("clip-path","url(#myClip)").append("g"),F=E.append("g").attr("class","x axis").attr("transform","translate(0,"+N+")"),et=E.append("g").attr("class","y axis");F.append("text").attr("class","title").attr("x",x/2).attr("y",25).attr("dy",".71em").text(function(r){var n=m??"";return n}),et.append("text").attr("class","title").attr("transform","rotate(-90)").attr("x",-N/2).attr("y",-35).attr("dy",".71em").text(function(r){var n=u??"";return n}),E.append("text").attr("class","chartTitle").attr("x",x/2).attr("y",-20).attr("dy",".71em").text(function(r){var n=d??"";return n});var h=j().range([0,x]),I=k().domain([S,A]).range([N,0]),Q=q(h),zt=Mt(I),H=tt.append("g").attr("transform","translate ("+i.left+","+Vt+")");H.append("rect").attr("x",0).attr("y",0).attr("width",x).attr("height",b).style("fill","#F5F5F5").style("shape-rendering","crispEdges").attr("transform","translate(0, 0)");var X=H.append("g").attr("class","nav"),nt=H.append("g").attr("class","x axis").attr("transform","translate(0,"+b+")"),s=j().range([0,$]),rt=k().domain([S,A]).range([b,0]),at=q(s),Ot=Gt().curve(Lt).x(function(r){return s(r.time)}).y1(function(r){return rt(r.value)}).y0(b),Qt=kt().x(function(r){return s(r.time)}).y(function(r){return rt(r.value)}),it=new Date().getTime(),w=new Date(it),T=new Date(w.getTime()-a*1e3),Jt=w.getTime()-T.getTime(),C=new Date(it),p=new Date(w.getTime()-x/c*1e3),Y=C.getTime()-p.getTime(),ot=p.getTime()-T.getTime();h.domain([p,C]),s.domain([T,w]),Q.scale(h)(F),zt.scale(I)(et),at.scale(s)(nt);var P,st=Et().extent([[0,0],[$,b]]).on("brush end",function(r){var n=r.selection||s.range();p=s.invert(n[0]),C=s.invert(n[1]),Y=C.getTime()-p.getTime(),ot=p.getTime()-T.getTime(),Y==0&&(Y=a*1e3,ot=0),h.domain(n===null?s.domain():n),Q.scale(h)(F),P=r.selection||s.range(),h.domain(P.map(s.invert,s)),_()}),Kt=H.append("g").attr("class","viewport").call(st).selectAll("rect").attr("height",b);o=z||[],_();function _(){o=o.filter(function(n){if(n.time.getTime()>T.getTime()&&n.time.getTime()<w.getTime())return!0});var r=Wt.selectAll(".bar").data(o);r.exit().remove(),r.enter().append("rect").attr("class","bar").attr("id",function(){return"bar-"+It++}).attr("shape-rendering","crispEdges"),r.attr("x",function(n){var R=Math.round(h(n.time)-D);return R!==R&&(R=0),R}).attr("y",function(n){return I(n.value)}).attr("width",D).attr("height",function(n){return N-I(n.value)}).style("fill",function(n){return n.color==null?"black":n.color}).style("fill-opacity",1),X.selectAll("path").remove(),X.append("path").attr("class","area").attr("d",Ot(o)),X.append("path").attr("class","line").attr("d",Qt(o))}return setInterval(function(){var r=s.domain(),n=r[1]-r[0],R=r[0]-s.domain()[0];w=new Date,T=new Date(w.getTime()-a*1e3),p=new Date(T.getTime()+R),C=new Date(p.getTime()+n),st.extent([p,C]),h.domain([p,C]),P&&h.domain(P.map(s.invert,s)),s.domain([T,w]),Q.scale(h)(F),at.scale(s)(nt),_()},500),t};return t.initialData=function(e){return arguments.length==0?z:(z=e,t)},t.datum=function(e){return arguments.length==0?l:(l=e,o.push(l),t)},t.width=function(e){return arguments.length==0?v:(v=e,t)},t.height=function(e){return arguments.length==0?f:(f=e,t)},t.border=function(e){return arguments.length==0?M:(M=e,t)},t.left=function(e){return arguments.length==0?i.left:(i.left=e,t)},t.top=function(e){return arguments.length==0?i.top:(i.top=e,t)},t.right=function(e){return arguments.length==0?i.right:(i.right=e,t)},t.bottom=function(e){return arguments.length==0?i.bottom:(i.bottom=e,t)},t.title=function(e){return arguments.length==0?d:(d=e,t)},t.xTitle=function(e){return arguments.length==0?m:(m=e,t)},t.yTitle=function(e){return arguments.length==0?u:(u=e,t)},t.barWidth=function(e){return arguments.length==0?D:(D=e,t)},t.isRunning=function(e){return arguments.length==0?U:(U=e,t)},t.version=g,t}var qt=["container"],Ft=(()=>{let l=class l{constructor(){this.document=V(lt),this.platformId=V(mt),this.element=V(dt),this.container=bt.required("container"),this.svgheight=Dt(),ut({write:()=>{this.render()}})}render(){if(!Ct(this.platformId)||!this.document||this.document===null)return;let o={top:20,right:20,bottom:20,left:40},a=this.container().nativeElement.getBoundingClientRect().width,c=Nt(this.element.nativeElement).select("#viewDiv"),v=k().domain([300,1700]).range([300,1700]).clamp(!0),f=k().domain([0,1]).range([30,95]),D=Rt(2e3,500),A=new Date().getTime()-3e5-4e3,S=At(300).map((m,G,B)=>{let O=f(Math.random()),M=Math.round(v(D()));A+=M;let L=new Date(A);return{interval:M,value:O,time:L,ts:A}}),d=Bt().border(!1).width(a).height(this.svgheight()).barWidth(2).left(o.left).top(o.top).right(o.right).bottom(o.bottom).initialData(S);c.select("#chartDiv").remove(),c.append("div").attr("id","chartDiv").call(d),d.isRunning(!0),this.chart=d;function u(){let m=Math.round(v(D()));setTimeout(()=>{let G=new Date,B={value:f(Math.random()),time:G,color:"forestgreen",ts:G.getTime(),interval:m};d.datum(B),d.isRunning()&&u()},m)}u()}ngOnDestroy(){this.chart.isRunning(!1)}};l.\u0275fac=function(a){return new(a||l)},l.\u0275cmp=W({type:l,selectors:[["app-d3-sample-real-time-chart"]],viewQuery:function(a,c){a&1&&wt(c.container,qt,5),a&2&&Tt()},hostBindings:function(a,c){a&1&&xt("resize",function(){return c.render()},ct)},inputs:{svgheight:[1,"svgheight"]},decls:4,vars:0,consts:[["container",""],[1,"container"],["id","viewDiv"]],template:function(a,c){a&1&&(gt(0,"div",1,0),yt(2,` The chart's time domain is moving with the passage of time, which means that any data placed in the chart eventually will age out and leave the chart. In addition to the main chart, the component also manages a "focus" window with a viewport (d3.brush) that can moved and sized to view an arbitrary portion of the time series data.
`),vt(),ft(3,"div",2))},styles:[`.container{padding:12px}.axis text{font:10px sans-serif}.chartTitle{font-size:12px;font-weight:700;text-anchor:middle}.axis .title{font-weight:700;text-anchor:middle}.axis path,.axis line{fill:none;stroke:#000;shape-rendering:crispEdges}.x.axis path{fill:none;stroke:#000;shape-rendering:crispEdges}.nav .area{fill:none;stroke-width:0px}.nav .line{fill:none;stroke:#000;stroke-width:1px}.viewport{stroke:gray;fill:none;fill-opacity:.3;stroke-width:0px}.viewport .extent{fill:green}.well{padding-top:0;padding-bottom:0}
`],encapsulation:2,changeDetection:0});let g=l;return g})();var oe=(()=>{let l=class l{};l.\u0275fac=function(a){return new(a||l)},l.\u0275cmp=W({type:l,selectors:[["app-d3-sample-8"]],decls:1,vars:1,consts:[[1,"sample8",3,"svgheight"]],template:function(a,c){a&1&&pt(0,"app-d3-sample-real-time-chart",0),a&2&&ht("svgheight",500)},dependencies:[Ft],styles:[".sample8[_ngcontent-%COMP%]{margin:0;padding:0}"]});let g=l;return g})();export{oe as Sample8Component};
