import{F as L,G as g,Qa as I,c as m,h as p,i as f,k as R}from"./chunk-KMPZBAPX.js";import{d as $,q as d}from"./chunk-XMFNCAXR.js";import{Ac as A,Eb as w,Ha as x,Ic as h,Lb as o,Na as y,Tb as B,Ub as M,_a as C,bc as b,ca as r,cc as _,ib as S,nb as s,tb as v,za as u,zb as D}from"./chunk-BVFQLCWY.js";import"./chunk-6NE7JDAX.js";I();var O=["chart"],T=(()=>{class i{constructor(){this.document=r($),this.platformId=r(x),this.elementRef=S.required("chart"),this.data=u.required(),this.margin={top:20,bottom:20,left:20,right:20},y({write:()=>{this.createChart(),this.updateChart()}}),h(()=>{this.data(),this.updateChart()})}createChart(){if(!d(this.platformId)||!this.document||this.document===null)return;let e=this.elementRef().nativeElement,a=e.offsetWidth,t=e.offsetHeight;this.width=a-this.margin.left-this.margin.right,this.height=t-this.margin.top-this.margin.bottom;let n=R(e);n.select("svg").remove();let c=n.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",a).attr("height",t).attr("viewBox",`0 0 ${a} ${t}`);this.chart=c.append("g").attr("class","bars").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);let H=this.data().map(l=>l[0]),F=[0,m(this.data(),l=>l[1])];this.xScale=L().padding(.1).domain(H).rangeRound([0,this.width]),this.yScale=g().domain(F).range([this.height,0]),this.colors=g().domain([0,this.data().length]).range(["green","blue"]),this.xAxis=c.append("g").attr("class","axis axis-x").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.height})`).call(p(this.xScale)),this.yAxis=c.append("g").attr("class","axis axis-y").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).call(f(this.yScale))}updateChart(){if(!d(this.platformId)||!this.document||this.document===null||!this.chart)return;let e=this.data();this.xScale.domain(e.map(t=>t[0])),this.yScale.domain([0,m(e,t=>t[1])]),this.colors.domain([0,e.length]),this.xAxis.transition().call(p(this.xScale)),this.yAxis.transition().call(f(this.yScale));let a=this.chart.selectAll(".bar").data(e);a.exit().remove(),this.chart.selectAll(".bar").transition().attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(t[1])).attr("width",t=>this.xScale.bandwidth()).attr("height",t=>this.height-this.yScale(t[1])).style("fill",(t,n)=>this.colors(n)),a.enter().append("rect").attr("class","bar").attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(0)).attr("width",this.xScale.bandwidth()).attr("height",0).style("fill",(t,n)=>this.colors(n)).transition().delay((t,n)=>n*10).attr("y",t=>this.yScale(t[1])).attr("height",t=>this.height-this.yScale(t[1]))}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=s({type:i,selectors:[["app-d3-sample-barchart"]],viewQuery:function(a,t){a&1&&b(t.elementRef,O,5),a&2&&_()},hostBindings:function(a,t){a&1&&B("resize",function(){return t.createChart()},!1,C)},inputs:{data:[1,"data"]},decls:2,vars:0,consts:[["chart",""],[1,"d3-chart"]],template:function(a,t){a&1&&o(0,"div",1,0)},styles:[".d3-chart[_ngcontent-%COMP%]{width:95%;height:300px;margin:16px}"],changeDetection:0})}}return i})();function P(i,Q){if(i&1&&o(0,"app-d3-sample-barchart",0),i&2){let e=M();D("data",e.chartData)}}var V=(()=>{class i{constructor(){this.cdr=r(A),h(()=>{this.generateData()})}generateData(){this.chartData=[];for(let e=0;e<8+Math.floor(Math.random()*50);++e)this.chartData.push([`${e}`,Math.floor(Math.random()*100)]);this.cdr.markForCheck(),setTimeout(()=>{this.generateData()},3e3)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=s({type:i,selectors:[["app-d3-sample-1"]],decls:1,vars:1,consts:[[3,"data"]],template:function(a,t){a&1&&v(0,P,1,1,"app-d3-sample-barchart",0),a&2&&w(t.chartData?0:-1)},dependencies:[T],encapsulation:2,changeDetection:0})}}return i})();export{V as Sample1Component};
