import{F as B,G as g,Qa as F,c as m,h as p,i as f,k as $}from"./chunk-GXN2U6XA.js";import{o as c}from"./chunk-5NZO7CYW.js";import{Ab as y,Bb as v,Fa as x,Gb as b,Ic as o,Jb as C,Lc as R,Mb as D,Mc as A,Oc as O,Wb as S,ca as n,cc as w,dc as M,ib as h,tb as u}from"./chunk-VOP6QBU4.js";import"./chunk-VOSPIT4N.js";F();var q=["chart"],z=(()=>{let i=class i{constructor(){this.platformId=n(x),this.elementRef=A.required("chart"),this.data=R.required(),this.margin={top:20,bottom:20,left:20,right:20},u({write:()=>{this.setupResizeObserver(),this.createChart(),this.updateChart()}}),o(()=>{this.data(),this.updateChart()})}ngOnDestroy(){this.resizeObserver?.disconnect()}setupResizeObserver(){c(this.platformId)&&(this.resizeObserver=new ResizeObserver(()=>{this.updateChart()}),this.resizeObserver.observe(this.elementRef().nativeElement))}createChart(){if(!c(this.platformId))return;let a=this.elementRef().nativeElement,e=a.offsetWidth,t=a.offsetHeight;this.width=e-this.margin.left-this.margin.right,this.height=t-this.margin.top-this.margin.bottom;let s=$(a);s.select("svg").remove();let d=s.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",e).attr("height",t).attr("viewBox",`0 0 ${e} ${t}`);this.chart=d.append("g").attr("class","bars").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);let L=this.data().map(l=>l[0]),T=[0,m(this.data(),l=>l[1])];this.xScale=B().padding(.1).domain(L).rangeRound([0,this.width]),this.yScale=g().domain(T).range([this.height,0]),this.colors=g().domain([0,this.data().length]).range(["green","blue"]),this.xAxis=d.append("g").attr("class","axis axis-x").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.height})`).call(p(this.xScale)),this.yAxis=d.append("g").attr("class","axis axis-y").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).call(f(this.yScale))}updateChart(){if(!c(this.platformId)||!this.chart)return;let a=this.data();this.xScale.domain(a.map(t=>t[0])),this.yScale.domain([0,m(a,t=>t[1])]),this.colors.domain([0,a.length]),this.xAxis.transition().call(p(this.xScale)),this.yAxis.transition().call(f(this.yScale));let e=this.chart.selectAll(".bar").data(a);e.exit().remove(),this.chart.selectAll(".bar").transition().attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(t[1])).attr("width",t=>this.xScale.bandwidth()).attr("height",t=>this.height-this.yScale(t[1])).style("fill",(t,s)=>this.colors(s)),e.enter().append("rect").attr("class","bar").attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(0)).attr("width",this.xScale.bandwidth()).attr("height",0).style("fill",(t,s)=>this.colors(s)).transition().delay((t,s)=>s*10).attr("y",t=>this.yScale(t[1])).attr("height",t=>this.height-this.yScale(t[1]))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=h({type:i,selectors:[["app-d3-random-barchart-barchart"]],viewQuery:function(e,t){e&1&&w(t.elementRef,q,5),e&2&&M()},inputs:{data:[1,"data"]},decls:2,vars:0,consts:[["chart",""],[1,"d3-chart"]],template:function(e,t){e&1&&D(0,"div",1,0)},styles:[".d3-chart[_ngcontent-%COMP%]{width:95%;height:300px;margin:16px}"],changeDetection:0});let r=i;return r})();function E(r,i){if(r&1&&C(0,"app-d3-random-barchart-barchart",0),r&2){let I=S();b("data",I.chartData)}}var K=(()=>{let i=class i{constructor(){this.cdr=n(O),o(()=>{this.generateData()})}generateData(){this.chartData=[];for(let a=0;a<8+Math.floor(Math.random()*50);++a)this.chartData.push([`${a}`,Math.floor(Math.random()*100)]);this.cdr.markForCheck(),setTimeout(()=>{this.generateData()},3e3)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=h({type:i,selectors:[["app-d3-random-barchart"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,t){e&1&&y(0,E,1,1,"app-d3-random-barchart-barchart",0),e&2&&v(t.chartData?0:-1)},dependencies:[z],encapsulation:2,changeDetection:0});let r=i;return r})();export{K as RandomBarchartComponent};
