import{F as H,G as g,Qa as N,c as m,h as p,i as f,k as T}from"./chunk-GXN2U6XA.js";import{o as l}from"./chunk-QQ6YFGSV.js";import{Cb as v,Db as D,Ha as x,Ib as S,Jc as h,Lb as w,Mc as R,Nc as _,Ob as M,Pc as L,Wa as y,Wb as b,Yb as B,ca as n,ec as A,fc as $,ib as o,na as u,tb as C}from"./chunk-54YCK6MI.js";import"./chunk-VOSPIT4N.js";N();var P=["chart"],F=(()=>{let i=class i{constructor(){this.document=n(u),this.platformId=n(x),this.elementRef=_.required("chart"),this.data=R.required(),this.margin={top:20,bottom:20,left:20,right:20},C({write:()=>{this.createChart(),this.updateChart()}}),h(()=>{this.data(),this.updateChart()})}createChart(){if(!l(this.platformId)||!this.document||this.document===null)return;let a=this.elementRef().nativeElement,e=a.offsetWidth,t=a.offsetHeight;this.width=e-this.margin.left-this.margin.right,this.height=t-this.margin.top-this.margin.bottom;let r=T(a);r.select("svg").remove();let c=r.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",e).attr("height",t).attr("viewBox",`0 0 ${e} ${t}`);this.chart=c.append("g").attr("class","bars").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);let q=this.data().map(d=>d[0]),E=[0,m(this.data(),d=>d[1])];this.xScale=H().padding(.1).domain(q).rangeRound([0,this.width]),this.yScale=g().domain(E).range([this.height,0]),this.colors=g().domain([0,this.data().length]).range(["green","blue"]),this.xAxis=c.append("g").attr("class","axis axis-x").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.height})`).call(p(this.xScale)),this.yAxis=c.append("g").attr("class","axis axis-y").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).call(f(this.yScale))}updateChart(){if(!l(this.platformId)||!this.document||this.document===null||!this.chart)return;let a=this.data();this.xScale.domain(a.map(t=>t[0])),this.yScale.domain([0,m(a,t=>t[1])]),this.colors.domain([0,a.length]),this.xAxis.transition().call(p(this.xScale)),this.yAxis.transition().call(f(this.yScale));let e=this.chart.selectAll(".bar").data(a);e.exit().remove(),this.chart.selectAll(".bar").transition().attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(t[1])).attr("width",t=>this.xScale.bandwidth()).attr("height",t=>this.height-this.yScale(t[1])).style("fill",(t,r)=>this.colors(r)),e.enter().append("rect").attr("class","bar").attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(0)).attr("width",this.xScale.bandwidth()).attr("height",0).style("fill",(t,r)=>this.colors(r)).transition().delay((t,r)=>r*10).attr("y",t=>this.yScale(t[1])).attr("height",t=>this.height-this.yScale(t[1]))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=o({type:i,selectors:[["app-d3-sample-barchart"]],viewQuery:function(e,t){e&1&&A(t.elementRef,P,5),e&2&&$()},hostBindings:function(e,t){e&1&&b("resize",function(){return t.createChart()},y)},inputs:{data:[1,"data"]},decls:2,vars:0,consts:[["chart",""],[1,"d3-chart"]],template:function(e,t){e&1&&M(0,"div",1,0)},styles:[".d3-chart[_ngcontent-%COMP%]{width:95%;height:300px;margin:16px}"],changeDetection:0});let s=i;return s})();function Q(s,i){if(s&1&&w(0,"app-d3-sample-barchart",0),s&2){let I=B();S("data",I.chartData)}}var Z=(()=>{let i=class i{constructor(){this.cdr=n(L),h(()=>{this.generateData()})}generateData(){this.chartData=[];for(let a=0;a<8+Math.floor(Math.random()*50);++a)this.chartData.push([`${a}`,Math.floor(Math.random()*100)]);this.cdr.markForCheck(),setTimeout(()=>{this.generateData()},3e3)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=o({type:i,selectors:[["app-d3-sample-1"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,t){e&1&&v(0,Q,1,1,"app-d3-sample-barchart",0),e&2&&D(t.chartData?0:-1)},dependencies:[F],encapsulation:2,changeDetection:0});let s=i;return s})();export{Z as Sample1Component};
