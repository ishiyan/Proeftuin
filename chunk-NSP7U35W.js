import{Ca as Lt,Da as zt,G as z,I as C,Ia as Mt,J as $,K as Z,L as tt,M as et,N as St,O as xt,P as At,Q as Tt,Qa as W,R as vt,S as wt,T as Nt,U as Et,V as U,W as G,a as at,b as gt,c as ot,d as yt,f as Vt,j,k as L,l as K,n as Q}from"./chunk-GXN2U6XA.js";var Ct=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.zero=()=>0,n.value=t=>t.value,n.withZero=t=>(n.zero=t,n),n};var Ut=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.open=t=>t.open,n.high=t=>t.high,n.low=t=>t.low,n.close=t=>t.close,n.volume=t=>t.volume,n.value=n.close,n.withValue=t=>(n.value=t,n),n};var Gt=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.volume=t=>t.volume,n.value=n.volume,n.withValue=t=>(n.value=t,n),n};var Wt=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.ask=t=>t.askPrice,n.bid=t=>t.bidPrice,n.mid=t=>(t.askPrice+t.bidPrice)/2,n.spread=t=>t.askPrice-t.bidPrice,n.value=n.mid,n.price=n.mid,n.close=n.mid,n.withValue=t=>(n.value=t,n.price=t,n.close=t,n),n};var It=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.type=t=>t.type,n.price=t=>t.price,n.volume=t=>t.volume,n.value=n.price,n.withValue=t=>(n.value=t,n),n};var Dt=()=>{let n=t=>n.value(t);return n.time=t=>t.time,n.high=t=>t.askPrice,n.low=t=>t.bidPrice,n.spread=t=>(t.askPrice-t.bidPrice)/2,n.value=n.spread,n};var jt=()=>{let n=function(e,c){return arguments.length<2?e.x:(e.x=c,a)},t=function(e,c){return arguments.length<2?e.y:(e.y=c,a)},a=e=>a.y(e);return a.x=n,a.y=t,a};var Ht=()=>{let n=function(o,r){if(arguments.length<2)return o.start.time;o.start.time=r},t=function(o,r){if(arguments.length<2)return o.start.value;o.start.value=r},a=function(o,r){if(arguments.length<2)return o.end.time;o.end.time=r},e=function(o,r){if(arguments.length<2)return o.end.value;o.end.value=r},c=o=>c.startValue(o);return c.startTime=n,c.startValue=t,c.endTime=a,c.endValue=e,c};var Rt=()=>{let n=function(a,e){return arguments.length<2?a.value:(a.value=e,t)},t=a=>t.value(a);return t.start=a=>a.start,t.end=a=>a.end,t.value=n,t};var ct=()=>({value:Ct,ohlcv:Ut,volume:Gt,quote:Wt,trade:It,tick:Dt,crosshair:jt,trendline:Ht,supstance:Rt});W();var Yt=()=>{let n=l=>{let i,u,m=["data"],p=f=>{let g=p.select(f).data(l,i),x=g.enter().append("g").attr("class",d(m," "));return g.exit().remove(),{entry:x,selection:x.merge(g)}};return p.select=f=>f.selectAll("g."+d(m,".")),p.mapper=function(f){return arguments.length?(l=f,p):l},p.scope=function(f){return arguments.length?(u=f,m=["data","scope-"+u],p):u},p.key=function(f){return arguments.length?(i=f,p):i},p};n.mapper={unity:l=>l,array:l=>[l]};let t=()=>{let l=Lt().curve(Mt),i=u=>l(u);return i.init=(u,m,p,f,g)=>l.defined(x=>p(x)!==null).x(x=>m(u(x),g===void 0?g:g(x))).y(x=>f(p(x))),i.d3=()=>l,i},a=()=>{let l=zt().curve(Mt),i=u=>l(u);return i.init=(u,m,p,f,g)=>l.defined(x=>p(x)!==null).x(x=>m(u(x))).y0(()=>f(g)).y1(x=>f(p(x))),i.d3=()=>l,i},e=l=>({up:i=>l.open(i)<l.close(i),down:i=>l.open(i)>l.close(i),equal:i=>l.open(i)===l.close(i)}),c=(l,i,u,m)=>{let p=u instanceof Array?u:[u];m=m||e(i),Object.keys(m).forEach(f=>{r(l,m[f],p,f)})},o=(l,i,u)=>{c(l,i,u,e(i))},r=(l,i,u,m)=>{l.selectAll("path."+d(u,".")+"."+m).data(p=>[p.filter(i)]).enter().append("path").attr("class",d(u," ")+" "+m)},s=l=>l.band!==void 0?Math.max(l.band(),1):3,d=(l,i)=>{if(!l.length)return;let u=l[0];for(let m=1;m<l.length;m++)u+=i+l[m];return u};return{dataSelector:n,appendPathsGroupBy:c,appendPathsUpDownEqual:o,horizontalPathLine:(l,i,u,m)=>p=>{if(!p.length)return null;let f=p[0],g=p[p.length-1];return"M "+i(l(f))+" "+m(u(f))+" L "+i(l(g))+" "+m(u(g))},pathLine:t,pathArea:a,barWidth:s,scaledStrokeWidth:(l,i,u)=>(i=i||1,u=u||1,()=>Math.min(i,s(l)/u)+"px"),joinPath:l=>i=>d(i.map(l())," "),interaction:{mousedispatch:l=>i=>i.on("mouseenter",function(u,m){L(this.parentNode).classed("mouseover",!0),l.call("mouseenter",this,m)}).on("mouseleave",function(u,m){let p=L(this.parentNode);p.classed("dragging")||(p.classed("mouseover",!1),l.call("mouseout",this,m))}).on("mousemove",function(u,m){l.call("mousemove",this,m)}),dragStartEndDispatch:(l,i)=>l.on("start",function(u,m){L(this.parentNode.parentNode).classed("dragging",!0),i.call("dragstart",this,m)}).on("end",function(u,m){L(this.parentNode.parentNode).classed("dragging",!1),i.call("dragend",this,m)})},plotComposer:()=>{let l=n(),i=g=>g.scale(),u=[],m,p,f=g=>{l.mapper(()=>u.map(()=>[]))(g).selection.each(function(v,w){u[w](L(this))}),f.refresh(g)};return f.refresh=g=>{l.select(g).data(x=>{let v=p(x);if(v==null)return u.map(()=>[]);let w=m(v);return u.map(S=>[{value:i(S)===m?v:i(S).invert(w)}])}).each(function(x,v){u[v](L(this))})},f.plots=function(g){return arguments.length?(u=g,f):u},f.scale=function(g){return arguments.length?(m=g,f):m},f.accessor=function(g){return arguments.length?(p=g,f):p},f.scope=function(g){return arguments.length?(l.scope(g),f):l.scope()},f.plotScale=function(g){return arguments.length?(i=g,f):i},f}}};W();var T=n=>typeof n=="function"?n:()=>n;W();W();var ge=(n,t,a,e)=>function(){let c=a.apply(t,arguments);return e&&c===t&&e(),c===t?n:c};function Bt(n,t,a,e,c){let o=arguments.length,r=2,s;for(;++r<o;)n[s=arguments[r]]=ge(n,t,t[s],c);return n}var Ot=()=>{function n(t,a,e,c){c=c!==void 0?c:!0;function o(){return t.apply(t,arguments)}return o.invert=t.invert,o.domain=function(r){return arguments.length?(c?t.domain([Math.max(e.domain[0],r[0]),Math.min(e.domain[1],r[1])]):t.domain(r),a&&a(),o):t.domain()},o.range=function(){if(!arguments.length)return t.range();throw new Error("Zoomable is a read only range. Use this scale for zooming only.")},o.copy=function(){return n(t.copy(),a,e,c)},o.clamp=function(r){return arguments.length?(c=r,o):c},o}return n};var Xt=n=>{function t(y,P,M,b,V,A,R,Y,ut){let Pt,dt=3,qt={tickFormat:y.daily[y.daily.length-1][2]};M=M||z(),b=b||[new Date(0),new Date(1)],V=V===void 0?.2:V,A=A===void 0?.65:A,R=R||{domain:M.domain()},Y=Y||!1;let X=()=>(dt=a(M,b,V),N);ut=ut||Ot()(M,X,R);let N=(k,q)=>{let E=Pt[k instanceof Date?k.getTime():+k];return q=q||0,E===void 0&&(b[0]>k?E=-1:E=at(b,k)),M(E+q)};N.invert=k=>{let q=b[N.invertToIndex(k)];return q||null},N.invertToIndex=k=>Math.round(M.invert(k)),N.domain=function(k){if(!arguments.length){let q=M.domain();return q[0]<0&&q[q.length-1]<0?[]:(q=[Math.max(Math.ceil(q[0]),0),Math.min(Math.floor(q[q.length-1]),b.length-1)],b.slice(q[0],q[q.length-1]+1))}return b=k,pt()};let Ft=()=>{Pt=c(b)},pt=()=>(Ft(),M.domain([0,b.length-1]),X(),M.domain(M.range().map(n(A,dt)).map(M.invert)),R.domain=M.domain(),X());N.copy=()=>t(y,P,M.copy(),b,V,A,R,Y),N.band=()=>dt,N.outerPadding=function(k){return arguments.length?(A=k,pt()):A},N.padding=function(k){return arguments.length?(V=k,pt()):V},N.zoomable=()=>ut,N.ticks=(k,q)=>{let E=N.domain(),B=M.domain();if(!E.length)return[];let I=k===void 0?ht(E,B,10):typeof k=="number"?ht(E,B,k):null;return qt.tickFormat=I?I[2]:ht(E,B,10)[2],I&&(k=I[0],q=I[1]),k.every(q).range(E[0],+E[E.length-1]+1).map(o(E,Y)).reduce(r,[])};let ht=(k,q,E)=>{if(k.length===1)return P;let B=k[k.length-1]-k[0],I=B/s<1,J=I?y.intraday:y.daily,mt=I?h:d,fe=Math.min(Math.round(e(k,q)*E),E),ft=B/fe,D=at(mt,ft);return D===J.length?J[D-1]:D?J[ft/mt[D-1]<mt[D]/ft?D-1:D]:J[D]};return N.closestTicks=function(k){return arguments.length?(Y=k,N):Y},N.tickFormat=()=>k=>qt.tickFormat(k),Bt(N,M,X,"range"),Ft(),X()}let a=(y,P,M)=>Math.abs(y(P.length-1)-y(0))/Math.max(1,P.length-1)*(1-M),e=(y,P)=>y.length/(P[P.length-1]-P[0]),c=y=>{let P={};return y.forEach((M,b)=>{P[+M]=b}),P},o=(y,P)=>{let M=c(y);return b=>{let V=M[+b];if(V!==void 0)return y[V];let A=at(y,b);return P&&A>0&&+b-+y[A-1]<+y[A]-+b&&A--,y[A]}},r=(y,P)=>((y.length===0||y[y.length-1]!==P)&&y.push(P),y),s=864e5,d=[s,6048e5,2592e6,7776e6,31536e6],h=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,s],l=U("%b %e"),i=O([[U("%b %Y"),y=>y.getMonth()],[U("%Y"),()=>!0]]),u=O([[U(":%S"),y=>y.getSeconds()],[U("%I:%M"),y=>y.getMinutes()],[U("%I %p"),()=>!0]]),m=[C,1,O([[U(":%S"),y=>y.getSeconds()],[U("%I:%M"),y=>y.getMinutes()],[U("%I %p"),y=>y.getHours()],[U("%b %e"),()=>!0]])],p=G("%b %e"),f=O([[G("%b %Y"),y=>y.getUTCMonth()],[G("%Y"),()=>!0]]),g=O([[G(":%S"),y=>y.getUTCSeconds()],[G("%I:%M"),y=>y.getUTCMinutes()],[G("%I %p"),()=>!0]]),x=[C,1,O([[G(":%S"),y=>y.getUTCSeconds()],[G("%I:%M"),y=>y.getUTCMinutes()],[G("%I %p"),y=>y.getUTCHours()],[G("%b %e"),()=>!0]])],v=[[St,1,l],[At,1,l],[vt,1,i],[vt,3,i],[Nt,1,i]],w=[[C,1,u],[C,5,u],[C,15,u],[C,30,u],[$,1,u],[$,5,u],[$,15,u],[$,30,u],[tt,1,u],[tt,3,u],[tt,6,u],[tt,12,u],[St,1,l]],S=[[xt,1,p],[Tt,1,p],[wt,1,f],[wt,3,f],[Et,1,f]],_=[[C,1,g],[C,5,g],[C,15,g],[C,30,g],[Z,1,g],[Z,5,g],[Z,15,g],[Z,30,g],[et,1,g],[et,3,g],[et,6,g],[et,12,g],[xt,1,p]],F=()=>t({daily:v,intraday:w},m);return F.utc=()=>t({daily:S,intraday:_},x),F},O=n=>t=>{for(let a of n)if(a[1](t))return a[0](t)};var st=()=>{let n=ct(),t=Xt(nt),a=(o,r,s)=>{r=r||n.ohlcv(),s=s===void 0?.02:s;let d=r.low,h=r.high;return z().domain([yt(o.map(d)),ot(o.map(h))].map(nt(s)))},e=(o,r,s)=>{r=r||n.quote(),s=s===void 0?.02:s;let d=r.bid,h=r.ask;return z().domain([yt(o.map(d)),ot(o.map(h))].map(nt(s)))},c=(o,r,s)=>(r=r||n.value(),s=s===void 0?.02:s,kt(o,r,s));return{financetime:t,plot:{candlestick:a,ohlc:a,tick:a,closeline:c,tradeline:c,valueline:c,tradepoint:c,valuepoint:c,quotepoint:e,quotebar:e,percent:(o,r)=>{let s=o.domain();return r=r||s[0],o.copy().domain([s[0],s[s.length-1]].map(d=>(d-r)/r))},supstance:(o,r,s)=>(r=r||n.supstance(),s=s===void 0?.02:s,kt(o,r.value,s)),time:(o,r)=>(r=r||n.value(),t().domain(o.map(r.time))),tradearrow:(o,r,s)=>(r=r||n.trade(),s=s===void 0?.02:s,kt(o,r.price,s)),trendline:(o,r,s)=>{r=r||n.trendline(),s=s===void 0?.04:s;let d=Se(o,h=>[r.startValue(h),r.endValue(h)]);return z().domain(gt(d).map(nt(s)))},volume:(o,r)=>(r=r||n.ohlcv(),z().domain([0,ot(o.map(r.volume))*1.15]))}}},ye=(n,t,a)=>n.length>0?gt(n,t).map(nt(a)):[],kt=(n,t,a)=>z().domain(ye(n,t,a)),nt=(n,t)=>(n=n||0,(a,e,c)=>{if(c.length>2)throw new Error("array.length > 2 unsupported. array.length = "+c.length);return t=t||c[c.length-1]-c[0],a+(e*2-1)*t*n}),Se=(n,t)=>n.map(t).reduce((a,e)=>a.concat(e)).filter(a=>a!==null);var Jt=n=>{let t=(a,e)=>{let c={};return c.dataSelector=(o,r)=>(e.dataSelector=n.dataSelector(o).key(r),c),c.xScale=o=>(e.xScale=st().financetime(),a.xScale=function(r){return arguments.length?(e.xScale=r,o&&o(),a):e.xScale},c),c.yScale=o=>(e.yScale=z(),a.yScale=function(r){return arguments.length?(e.yScale=r,o&&o(),a):e.yScale},c),c.accessor=(o,r)=>(e.accessor=o,a.accessor=function(s){return arguments.length?(e.accessor=s,r&&r(),a):e.accessor},c),c.width=o=>(e.width=n.barWidth,a.width=function(r){return arguments.length?(e.width=T(r),o&&o(),a):e.width},c),c.on=(o,r)=>(a.on=(s,d)=>(o.on(s,d),r&&r(),a),c),c.plot=(o,r)=>c.xScale(r).yScale(r).accessor(o,r),c};return t.dataMapper=n.dataSelector.mapper,t};var Kt=(n,t,a)=>()=>{let e={},c,o,r,s=i=>{let u=e.dataSelector(i);t.appendPathsUpDownEqual(u.selection,e.accessor,["candle","body"]),t.appendPathsUpDownEqual(u.selection,e.accessor,["candle","wick"]),s.refresh(i)};s.refresh=i=>{i.selectAll("path.candle.body").attr("d",c).style("stroke-width",r),i.selectAll("path.candle.wick").attr("d",o).style("stroke-width",r)};let d=()=>{c=t.joinPath(h),o=t.joinPath(l),r=t.scaledStrokeWidth(e.xScale,1,4)},h=()=>{let i=e.accessor,u=e.xScale,m=e.yScale,p=e.width(u),f=p/2;return g=>{let x=m(i.open(g)),v=m(i.close(g)),w=u(i.time(g))-f,S="M "+w+" "+x+" l "+p+" 0";return x!==v&&(S+=" L "+(w+p)+" "+v+" l "+-p+" 0 L "+w+" "+x),S}},l=()=>{let i=e.accessor,u=e.xScale,m=e.yScale,p=e.width(u),f=p/2;return g=>{let x=m(i.open(g)),v=m(i.close(g)),w=u(i.time(g)),S=w-f,_="M "+w+" "+m(i.high(g))+" L "+w+" "+Math.min(x,v);return x===v&&(_+=" M "+S+" "+x+" l "+p+" 0"),_+" M "+w+" "+Math.max(x,v)+" L "+w+" "+m(i.low(g))}};return a(s,e).plot(n(),d).width(d).dataSelector(a.dataMapper.array),d(),s};var lt=(n,t,a,e)=>(e=e||!1,()=>{let c={},o=t.pathLine(),r=d=>{let h=c.dataSelector(d);h.entry.append("path").attr("class","line"),e&&h.selection.append("path").attr("class","zero"),r.refresh(d)};r.refresh=d=>{let h=c.dataSelector.select(d);if(h.select("path.line").attr("d",o),e){let l=c.accessor;h.select("path.zero").attr("d",t.horizontalPathLine(l.time,c.xScale,l.zero,c.yScale))}};let s=()=>{o.init(c.accessor.time,c.xScale,c.accessor,c.yScale)};return a(r,c).plot(n(),s).dataSelector(a.dataMapper.array),s(),r});var rt=(n,t,a)=>()=>{let e={},c=t.pathArea(),o=s=>{e.dataSelector(s).entry.append("path").attr("class","area"),o.refresh(s)};o.refresh=s=>{e.dataSelector.select(s).select("path.area").attr("d",c)};let r=()=>{c.init(e.accessor.time,e.xScale,e.accessor,e.yScale,0)};return a(o,e).plot(n(),r).dataSelector(a.dataMapper.array),r(),o};W();var $t=(n,t)=>()=>{let a={},c=Vt(z()),o,r=14,s=50,d=[0,0],h="bottom",l=i=>{let u=a.dataSelector.mapper(ve(a.accessor,c.scale()))(i);u.entry.append("path"),u.entry.append("text"),l.refresh(i)};return l.refresh=i=>{let u=o||(c.tickFormat()?c.tickFormat():c.scale().tickFormat());xe(a.dataSelector.select(i),a.accessor,c,h,u,r,s,4,d)},l.axis=function(i){return arguments.length?(c=i,l):c},l.orient=function(i){return arguments.length?(h=i,l):h},l.format=function(i){return arguments.length?(o=i,l):o},l.height=function(i){return arguments.length?(r=i,l):r},l.width=function(i){return arguments.length?(s=i,l):s},l.translate=function(i){return arguments.length?(d=i,l):d},t(l,a).accessor(n()).dataSelector(),l},xe=(n,t,a,e,c,o,r,s,d)=>{let h=e==="left"||e==="top"?-1:1;n.attr("transform","translate("+d[0]+","+d[1]+")"),n.select("path").attr("d",ke(t,a,e,o,r,s,h)),n.select("text").text(Me(t,c)).call(we,t,a,e,h)},ve=(n,t)=>a=>{let e=t.range(),c=e[0],o=e[e.length-1];return e=c<o?[c,o]:[o,c],a.filter(r=>{if(n(r)===null||n(r)===void 0)return!1;let s=t(n(r));return s!==null&&!isNaN(s)&&e[0]<=s&&s<=e[1]})},we=(n,t,a,e,c)=>{let o=a.scale();switch(e){case"left":case"right":n.attr("x",c*(Math.max(a.tickSizeInner(),0)+a.tickPadding())).attr("y",Qt(t,o)).attr("dy",".32em").style("text-anchor",c<0?"end":"start");break;case"top":case"bottom":n.attr("x",Qt(t,o)).attr("y",c*(Math.max(a.tickSizeInner(),0)+a.tickPadding())).attr("dy",c<0?"0em":".72em").style("text-anchor","middle");break}},Qt=(n,t)=>a=>t(n(a)),Me=(n,t)=>a=>t(n(a)),ke=(n,t,a,e,c,o,r)=>s=>{let h=t.scale()(n(s)),l=o;switch(a){case"left":case"right":{let i=0;return e/2<o?l=e/2:i=e/2-o,"M 0 "+h+" l "+r*Math.max(t.tickSizeInner(),1)+" "+-l+" l 0 "+-i+" l "+r*c+" 0 l 0 "+e+" l "+r*-c+" 0 l 0 "+-i}case"top":case"bottom":{let i=0;return c/2<o?l=c/2:i=c/2-o,"M "+h+" 0 l "+-l+" "+r*Math.max(t.tickSizeInner(),1)+" l "+-i+" 0 l 0 "+r*e+" l "+c+" 0 l 0 "+r*-e+" l "+-i+" 0"}default:throw new Error("Unsupported orient value: axisannotation.orient("+a+"). Set to one of: 'top', 'bottom', 'left', 'right'")}};var Zt=(n,t,a)=>()=>{let e={},c,o=d=>{e.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{e.dataSelector.select(d).select("path.point").attr("d",c)};let r=()=>{c=t.joinPath(s)},s=()=>{let d=e.accessor,h=e.xScale,l=e.yScale,i=e.width(h),u=i/i;return m=>{let p=l(d.ask(m)),f=l(d.bid(m)),g=l(p),x=l(f),v=h(d.time(m))-u,w=1.5,S=w*2;return"M"+(v-w)+","+g+" a"+w+","+w+" 0 1,0 "+S+",0 a"+w+","+w+" 0 1,0 -"+S+",0M"+(v-w)+","+x+" a"+w+","+w+" 0 1,0 "+S+",0 a"+w+","+w+" 0 1,0 -"+S+",0"}};return a(o,e).plot(n(),r).width(r).dataSelector(a.dataMapper.array),r(),o};var te=(n,t,a)=>()=>{let e={},c,o,r=h=>{e.dataSelector(h).entry.append("path").attr("class","quotebar"),r.refresh(h)};r.refresh=h=>{e.dataSelector.select(h).select("path.quotebar").attr("d",c).style("stroke-width",o)};let s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(e.xScale,1,2)},d=()=>{let h=e.accessor,l=e.xScale,i=e.yScale,u=e.width(l),m=u/2;return p=>{let f=i(h.ask(p)),g=i(h.bid(p)),x=l(h.time(p)),v=x-m;return"M"+v+","+f+"l"+u+",0M"+x+","+f+"L"+x+","+g+"M"+v+","+g+"l"+u+",0"}};return a(r,e).plot(n(),s).width(s).dataSelector(a.dataMapper.array),s(),r};var ee=(n,t,a)=>()=>{let e={},c,o=d=>{e.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{e.dataSelector.select(d).select("path.point").attr("d",c)};let r=()=>{c=t.joinPath(s)},s=()=>{let d=e.accessor,h=e.xScale,l=e.yScale,u=e.width(h)/2;return m=>{let p=d.price(m);if(isNaN(p))return null;let g=l(p)-0,x=h(d.time(m))-u,v=1.5,w=v*2;return"M "+(x-v)+","+g+" a "+v+","+v+" 0 1,0 "+w+",0 a "+v+","+v+" 0 1,0 -"+w+",0"}};return a(o,e).plot(n(),r).width(r).dataSelector(a.dataMapper.array),r(),o};var ne=(n,t,a)=>()=>{let e={},c,o=d=>{e.dataSelector(d).entry.append("path").attr("class","point"),o.refresh(d)};o.refresh=d=>{e.dataSelector.select(d).select("path.point").attr("d",c)};let r=()=>{c=t.joinPath(s)},s=()=>{let d=e.accessor,h=e.xScale,l=e.yScale,u=e.width(h)/2;return m=>{let p=d.value(m);if(isNaN(p))return null;let g=l(p)-0,x=h(d.time(m))-u,v=1.5,w=v*2;return"M"+(x-v)+","+g+"a"+v+","+v+" 0 1,0 "+w+",0a"+v+","+v+" 0 1,0 -"+w+",0"}};return a(o,e).plot(n(),r).width(r).dataSelector(a.dataMapper.array),r(),o};W();var re=(n,t,a)=>()=>{let e={},c=j("enter","out","move"),o=t.plotComposer().scope("composed-annotation").plotScale(S=>S.axis().scale()),r=t.plotComposer().scope("composed-annotation").plotScale(S=>S.axis().scale()),s,d,h,l,i=S=>{let _=e.dataSelector(S);_.entry.append("path").attr("class","horizontal wire"),_.entry.append("path").attr("class","vertical wire"),_.entry.append("g").attr("class","axisannotation x").call(o),_.entry.append("g").attr("class","axisannotation y").call(r),S.selectAll("rect").data([void 0]).enter().append("rect").style("fill","none").style("pointer-events","all"),i.refresh(S)};i.refresh=S=>{let _=e.xScale.range(),F=e.yScale.range(),y=e.dataSelector.select(S),P=y.select("path.vertical"),M=y.select("path.horizontal"),b=y.select("g.axisannotation.x"),V=y.select("g.axisannotation.y");s=g(),d=f(),S.selectAll("rect").attr("x",Math.min.apply(null,_)).attr("y",Math.min.apply(null,F)).attr("height",Math.abs(F[F.length-1]-F[0])).attr("width",Math.abs(_[_.length-1]-_[0])).on("mouseenter",function(){c.call("enter",this)}).on("mouseout",function(){c.call("out",this),delete y.node().__coord__,x(y.datum()),m(y,P,M,b,V)}).on("mousemove",u(y,P,M,b,V)),m(y,P,M,b,V)};let u=(S,_,F,y,P)=>M=>{S.node().__coord__=K(M),m(S,_,F,y,P)},m=(S,_,F,y,P)=>{let M=S.node().__coord__;if(M!==void 0){let b=S.datum(),V=e.xScale.invert(M[0]),A=e.yScale.invert(M[1]),R=V!==null&&A!==null&&(e.accessor.x(b)!==V||e.accessor.y(b)!==A);e.accessor.x(b,V),e.accessor.y(b,A),R&&c.call("move",S.node(),b)}_.attr("d",s),F.attr("d",d),y.call(o.refresh),P.call(r.refresh),S.attr("display",w)};i.xAnnotation=function(S){return arguments.length?(o.plots(S instanceof Array?S:[S]),p()):o.plots()},i.yAnnotation=function(S){return arguments.length?(r.plots(S instanceof Array?S:[S]),p()):r.plots()},i.verticalWireRange=function(S){return arguments.length?(h=S,p()):h},i.horizontalWireRange=function(S){return arguments.length?(l=S,p()):l};let p=()=>(o.accessor(e.accessor.x).scale(e.xScale),r.accessor(e.accessor.y).scale(e.yScale),i),f=()=>{let S=l||e.xScale.range();return _=>{if(e.accessor.y(_)===null)return null;let F=e.yScale(e.accessor.y(_));return isNaN(F)?null:"M "+S[0]+" "+F+" L "+S[S.length-1]+" "+F}},g=()=>{let S=h||e.yScale.range();return _=>{if(e.accessor.x(_)===null)return null;let F=e.xScale(e.accessor.x(_)),y=e.xScale.range();return F<Math.min(y[0],y[y.length-1])||F>Math.max(y[0],y[y.length-1])?null:"M "+F+" "+S[0]+" L "+F+" "+S[S.length-1]}},x=S=>(S=S||{},e.accessor.x(S,null),e.accessor.y(S,null),S),v=S=>S===void 0||e.accessor.x(S)===null||e.accessor.y(S)===null,w=S=>v(S)?"none":null;return a(i,e).plot(n(),p).dataSelector(S=>v(S)?[x()]:[S]).on(c),e.dataSelector.scope("crosshair"),p()};var ae=(n,t,a)=>()=>{let e={},c,o,r=h=>{t.appendPathsUpDownEqual(e.dataSelector(h).selection,e.accessor,"ohlc"),r.refresh(h)};r.refresh=h=>{h.selectAll("path.ohlc").attr("d",c).style("stroke-width",o)};let s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(e.xScale,1,2)},d=()=>{let h=e.accessor,l=e.xScale,i=e.yScale,m=e.width(l)/2;return p=>{let f=i(h.open(p)),g=i(h.close(p)),x=l(h.time(p));return"M "+(x-m)+" "+f+" l "+m+" 0 M "+x+" "+i(h.high(p))+" L "+x+" "+i(h.low(p))+" M "+x+" "+g+" l "+m+" 0"}};return a(r,e).plot(n(),s).width(s).dataSelector(a.dataMapper.array),s(),r};W();var se=(n,t,a)=>{let e=()=>{let o={},r=j("mouseenter","mouseout","mousemove","drag","dragstart","dragend"),s=t.plotComposer().scope("composed-annotation").plotScale(l=>l.axis().scale()),d=l=>{let i=o.dataSelector(l);i.entry.append("g").attr("class","supstance").append("path"),i.entry.append("g").attr("class","axisannotation y").call(s),i.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(t.interaction.mousedispatch(r)).append("path").style("stroke-width","16px"),d.refresh(l)};d.refresh=l=>{oe(o.dataSelector.select(l),o.accessor,o.xScale,o.yScale,s)},d.drag=l=>{l.selectAll(".interaction path").call(c(r,o.accessor,o.xScale,o.yScale,s))},d.annotation=function(l){return arguments.length?(s.plots(l instanceof Array?l:[l]),d):s.plots()};let h=()=>(s.accessor(o.accessor.value).scale(o.yScale),d);return a(d,o).dataSelector(a.dataMapper.unity).plot(n(),h).on(r),o.dataSelector.scope("supstance"),h()},c=(o,r,s,d,h)=>{let l=Q().subject(i=>({x:0,y:d(r(i))})).on("drag",function(i,u){let m=d.invert(i.y),p=L(this.parentNode.parentNode);r.value(u,m),oe(p,r,s,d,h),o.call("drag",this,u)});return t.interaction.dragStartEndDispatch(l,o)};return e},oe=(n,t,a,e,c)=>{n.select(".supstance path").attr("d",ce(t,a,e)),n.select(".interaction path").attr("d",ce(t,a,e)),n.select(".axisannotation.y").call(c.refresh)},ce=(n,t,a)=>e=>{let c;be(n)?(c=[n.start(e),n.end(e)],c[0]=c[0]!==void 0?t(c[0]):t.range()[0],c[1]=c[1]!==void 0?t(c[1]):t.range()[1]):c=t.range();let o=a(n.value(e));return"M "+c[0]+" "+o+" L "+c[c.length-1]+" "+o},be=n=>n.start!==void 0&&n.end!==void 0;var le=(n,t,a)=>()=>{let e={},c,o,r=h=>{e.dataSelector(h).entry.append("path").attr("class","tick"),r.refresh(h)};r.refresh=h=>{e.dataSelector.select(h).select("path.tick").attr("d",c).style("stroke-width",o)};let s=()=>{c=t.joinPath(d),o=t.scaledStrokeWidth(e.xScale,1,2)},d=()=>{let h=e.accessor,l=e.xScale,i=e.yScale,u=e.width(l),m=u/2;return p=>{let f=i(h.high(p)),g=i(h.low(p)),x=l(h.time(p)),v=x-m;return"M "+v+" "+f+" l "+u+" 0 M "+x+" "+f+" L "+x+" "+g+" M "+v+" "+g+" l "+u+" 0"}};return a(r,e).plot(n(),s).width(s).dataSelector(a.dataMapper.array),s(),r};W();var it=()=>{let n=T(0),t=T(0),a=T(12),e=T(15),c=T("up"),o=T(!0),r=(s,d)=>{let h=n(s,d),l=t(s,d),i=a(s,d),u=e(s,d),m=c(s,d),p=o(s,d),f=m==="left"||m==="up"?1:-1,g=i/3,x=i/2,v=p?u/2:u,w="M "+h+" "+l;switch(m){case"up":case"down":w+=" l "+-x+" "+f*v+" l "+g+" 0",p&&(w+=" l 0 "+f*v),w+=" l "+g+" 0",p&&(w+=" l 0 "+-f*v),w+=" l "+g+" 0";break;case"left":case"right":w+=" l "+f*v+" "+-x+" l 0 "+g,p&&(w+=" l "+f*v+" 0"),w+=" l 0 "+g,p&&(w+=" l "+-f*v+" 0"),w+=" l 0 "+g;break;default:throw new Error("Unsupported arrow.orient() = "+c)}return w+" z"};return r.x=function(s){return arguments.length?(n=T(s),r):n},r.y=function(s){return arguments.length?(t=T(s),r):t},r.height=function(s){return arguments.length?(e=T(s),r):e},r.width=function(s){return arguments.length?(a=T(s),r):a},r.orient=function(s){return arguments.length?(c=T(s),r):c},r.tail=function(s){return arguments.length?(o=T(s),r):o},r};var bt=(n,t,a)=>()=>{let e={},c=j("mouseenter","mouseout"),o=u=>e.yScale(e.accessor.price(u)),r=it().orient(u=>e.accessor.type(u).startsWith("buy")?"up":"down"),s,d=u=>{let m=e.dataSelector(u),p=i(u.datum());t.appendPathsGroupBy(m.selection,e.accessor,"tradearrow",p),m.entry.append("path").attr("class","highlight").style("pointer-events","none"),m.selection.selectAll("path.tradearrow").on("mouseenter",function(f,g){let x=l(g,K(f)[0]);L(this.parentNode).select("path.highlight").datum(x.d).attr("d",r).call(_e,p),c.call("mouseenter",this,x.d,x.i)}).on("mouseout",function(f,g){L(this.parentNode).selectAll("path.highlight").datum([]).attr("d",null).attr("class","highlight");let x=l(g,K(f)[0]);c.call("mouseout",this,x.d,x.i)}),d.refresh(u)};d.refresh=u=>{u.selectAll("path.tradearrow").attr("d",s)},d.orient=function(u){return arguments.length?(r.orient(u),h()):r.orient()},d.y=function(u){return arguments.length?(o=T(u),h()):o},d.arrow=()=>r;let h=()=>(r.x(u=>e.xScale(e.accessor.time(u))).y(o),s=t.joinPath(()=>r),bt),l=(u,m)=>u.map((p,f)=>({d:p,i:f,x:e.xScale(e.accessor.time(p))})).reduce((p,f)=>Math.abs(p.x-m)<Math.abs(f.x-m)?p:f),i=u=>u.map(m=>e.accessor.type(m)).reduce((m,p)=>(m[p]===void 0&&(m[p]=f=>p===e.accessor.type(f)),m),{});return a(d,e).plot(n(),h).on(c).dataSelector(a.dataMapper.array),h(),d},_e=(n,t)=>{Object.keys(t).forEach(a=>{n.classed(a,t[a])})};W();var de=(n,t,a)=>{let e=()=>{let s={},d=j("mouseenter","mouseout","mousemove","drag","dragstart","dragend"),h=l=>{let i=s.dataSelector(l),u=i.entry.append("g").attr("class","trendline");u.append("path").attr("class","body"),u.append("circle").attr("class","start").attr("r",1),u.append("circle").attr("class","end").attr("r",1);let m=i.entry.append("g").attr("class","interaction").style("opacity",0).style("fill","none").call(t.interaction.mousedispatch(d));m.append("path").attr("class","body").style("stroke-width","16px"),m.append("circle").attr("class","start").attr("r",8),m.append("circle").attr("class","end").attr("r",8),h.refresh(l)};return h.refresh=l=>{_t(s.dataSelector.select(l),s.accessor,s.xScale,s.yScale)},h.drag=l=>{l.selectAll(".interaction circle.start").call(c(d,s.accessor,s.accessor.startTime,s.xScale,s.accessor.startValue,s.yScale)),l.selectAll(".interaction circle.end").call(c(d,s.accessor,s.accessor.endTime,s.xScale,s.accessor.endValue,s.yScale)),l.selectAll(".interaction path.body").call(o(d,s.accessor,s.xScale,s.yScale))},a(h,s).dataSelector(a.dataMapper.unity).plot(n()).on(d),h},c=(s,d,h,l,i,u)=>{let m=Q();return m.subject((p,f)=>({x:l(h(f)),y:u(i(f))})).on("drag",function(p,f){r(h,l,p.x,i,u,p.y,f),_t(L(this.parentNode.parentNode.parentNode),d,l,u),s.call("drag",this,f)}),t.interaction.dragStartEndDispatch(m,s)},o=(s,d,h,l)=>{let i={},u=Q();return u.subject((m,p)=>(i.start={date:h(d.startTime(p)),value:l(d.startValue(p))},i.end={date:h(d.endTime(p)),value:l(d.endValue(p))},{x:0,y:0})).on("drag",function(m,p){r(d.startTime,h,m.x+i.start.date,d.startValue,l,m.y+i.start.value,p),r(d.endTime,h,m.x+i.end.date,d.endValue,l,m.y+i.end.value,p),_t(L(this.parentNode.parentNode.parentNode),d,h,l),s.call("drag",this,p)}),t.interaction.dragStartEndDispatch(u,s)},r=(s,d,h,l,i,u,m)=>{let p=d.invert(h);p!=null&&s(m,p),l(m,i.invert(u))};return e},_t=(n,t,a,e)=>{n.selectAll("path.body").attr("d",Pe(t,a,e)),n.selectAll("circle.start").attr("cx",ie(t.startTime,a)).attr("cy",ue(t.startValue,e)),n.selectAll("circle.end").attr("cx",ie(t.endTime,a)).attr("cy",ue(t.endValue,e))},Pe=(n,t,a)=>e=>"M "+t(n.startTime(e))+" "+a(n.startValue(e))+" L "+t(n.endTime(e))+" "+a(n.endValue(e)),ie=(n,t)=>a=>t(n(a)),ue=(n,t)=>a=>t(n(a));var pe=(n,t,a)=>()=>{let e={},c,o=h=>{let l=e.dataSelector(h);s()?t.appendPathsUpDownEqual(l.selection,e.accessor,"volume"):l.entry.append("path").attr("class","volume"),o.refresh(h)};o.refresh=h=>{s()?h.selectAll("path.volume").attr("d",c):e.dataSelector.select(h).select("path.volume").attr("d",c)};let r=()=>{c=t.joinPath(d)},s=()=>e.accessor.open&&e.accessor.close,d=()=>{let h=e.accessor,l=e.xScale,i=e.yScale,u=e.width(l),m=u/2;return p=>{let f=h.volume(p);if(isNaN(f))return null;let g=i(0),x=i(f)-g;return"M "+(l(h.time(p))-m)+" "+g+" l 0 "+x+" l "+u+" 0 l 0 "+-x}};return a(o,e).plot(n(),r).width(r).dataSelector(a.dataMapper.array),r(),o};var he=()=>{let n=Yt(),t=Jt(n),a=ct(),e=Kt(a.ohlcv,n,t),c=$t(a.value,t);return{ohlcarea:rt(a.ohlcv,n,t),valuearea:rt(a.value,n,t),tradearea:rt(a.trade,n,t),quotearea:rt(a.quote,n,t),axisannotation:c,quotepoint:Zt(a.quote,n,t),quotebar:te(a.quote,n,t),candlestick:e,tradepoint:ee(a.trade,n,t),valuepoint:ne(a.value,n,t),closeline:lt(a.ohlcv,n,t),tradeline:lt(a.trade,n,t),valueline:lt(a.value,n,t),crosshair:re(a.crosshair,n,t),ohlc:ae(a.ohlcv,n,t),supstance:se(a.supstance,n,t),tick:le(a.tick,n,t),tradearrow:bt(a.trade,n,t),trendline:de(a.trendline,n,t),volume:pe(a.volume,n,t)}};var me={arrow:it};var Jn={plot:he(),scale:st(),shapes:me};export{Jn as a};
