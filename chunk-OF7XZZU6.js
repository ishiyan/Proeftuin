import{c as Xn,g as Bn}from"./chunk-CGVYBZUD.js";import{$ as Zn,C as $n,a as Pn,d as me,e as jn,f as Vn,g as Hn,ha as Yn,j as Gn,l as Un}from"./chunk-EWUHWUKW.js";import{a as Wn}from"./chunk-IEKDCRBV.js";import{Qa as Oo,e as Dn,k as Sn,x as Ln}from"./chunk-HICUQHPW.js";import{$a as Tn,Aa as J,Ba as Nn,Vb as Rn,Yb as qn,Zb as _n,da as En,ka as kn,ob as On}from"./chunk-BLTBCMH5.js";import{d as y,e as ft,f as Tt,g as In,h as Ot,j as zn}from"./chunk-6NE7JDAX.js";var Kn=ft((Jn,xe)=>{"use strict";(function(t,e,n){function r(a){var u=this,p=s();u.next=function(){var c=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=c-(u.c=c|0)},u.c=1,u.s0=p(" "),u.s1=p(" "),u.s2=p(" "),u.s0-=p(a),u.s0<0&&(u.s0+=1),u.s1-=p(a),u.s1<0&&(u.s1+=1),u.s2-=p(a),u.s2<0&&(u.s2+=1),p=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function o(a,u){var p=new r(a),c=u&&u.state,d=p.next;return d.int32=function(){return p.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,c&&(typeof c=="object"&&i(c,p),d.state=function(){return i(p,{})}),d}function s(){var a=4022871197,u=function(p){p=String(p);for(var c=0;c<p.length;c++){a+=p.charCodeAt(c);var d=.02519603282416938*a;a=d>>>0,d-=a,d*=a,a=d>>>0,d-=a,a+=d*4294967296}return(a>>>0)*23283064365386963e-26};return u}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.alea=o})(Jn,typeof xe=="object"&&xe,typeof define=="function"&&define)});var tr=ft((Qn,ve)=>{"use strict";(function(t,e,n){function r(s){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var c=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^c^c>>>8},s===(s|0)?a.x=s:u+=s;for(var p=0;p<u.length+64;p++)a.x^=u.charCodeAt(p)|0,a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a}function o(s,a){var u=new r(s),p=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},c.int32=u.next,c.quick=c,p&&(typeof p=="object"&&i(p,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.xor128=o})(Qn,typeof ve=="object"&&ve,typeof define=="function"&&define)});var nr=ft((er,we)=>{"use strict";(function(t,e,n){function r(s){var a=this,u="";a.next=function(){var c=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(c^c<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,s===(s|0)?a.x=s:u+=s;for(var p=0;p<u.length+64;p++)a.x^=u.charCodeAt(p)|0,p==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a.v=s.v,a.d=s.d,a}function o(s,a){var u=new r(s),p=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},c.int32=u.next,c.quick=c,p&&(typeof p=="object"&&i(p,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.xorwow=o})(er,typeof we=="object"&&we,typeof define=="function"&&define)});var ir=ft((rr,ye)=>{"use strict";(function(t,e,n){function r(s){var a=this;a.next=function(){var p=a.x,c=a.i,d,x,w;return d=p[c],d^=d>>>7,x=d^d<<24,d=p[c+1&7],x^=d^d>>>10,d=p[c+3&7],x^=d^d>>>3,d=p[c+4&7],x^=d^d<<7,d=p[c+7&7],d=d^d<<13,x^=d^d<<9,p[c]=x,a.i=c+1&7,x};function u(p,c){var d,x,w=[];if(c===(c|0))x=w[0]=c;else for(c=""+c,d=0;d<c.length;++d)w[d&7]=w[d&7]<<15^c.charCodeAt(d)+w[d+1&7]<<13;for(;w.length<8;)w.push(0);for(d=0;d<8&&w[d]===0;++d);for(d==8?x=w[7]=-1:x=w[d],p.x=w,p.i=0,d=256;d>0;--d)p.next()}u(a,s)}function i(s,a){return a.x=s.x.slice(),a.i=s.i,a}function o(s,a){s==null&&(s=+new Date);var u=new r(s),p=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},c.int32=u.next,c.quick=c,p&&(p.x&&i(p,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.xorshift7=o})(rr,typeof ye=="object"&&ye,typeof define=="function"&&define)});var ar=ft((or,be)=>{"use strict";(function(t,e,n){function r(s){var a=this;a.next=function(){var p=a.w,c=a.X,d=a.i,x,w;return a.w=p=p+1640531527|0,w=c[d+34&127],x=c[d=d+1&127],w^=w<<13,x^=x<<17,w^=w>>>15,x^=x>>>12,w=c[d]=w^x,a.i=d,w+(p^p>>>16)|0};function u(p,c){var d,x,w,P,A,C=[],k=128;for(c===(c|0)?(x=c,c=null):(c=c+"\0",x=0,k=Math.max(k,c.length)),w=0,P=-32;P<k;++P)c&&(x^=c.charCodeAt((P+32)%c.length)),P===0&&(A=x),x^=x<<10,x^=x>>>15,x^=x<<4,x^=x>>>13,P>=0&&(A=A+1640531527|0,d=C[P&127]^=x+A,w=d==0?w+1:0);for(w>=128&&(C[(c&&c.length||0)&127]=-1),w=127,P=4*128;P>0;--P)x=C[w+34&127],d=C[w=w+1&127],x^=x<<13,d^=d<<17,x^=x>>>15,d^=d>>>12,C[w]=x^d;p.w=A,p.X=C,p.i=w}u(a,s)}function i(s,a){return a.i=s.i,a.w=s.w,a.X=s.X.slice(),a}function o(s,a){s==null&&(s=+new Date);var u=new r(s),p=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},c.int32=u.next,c.quick=c,p&&(p.X&&i(p,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.xor4096=o})(or,typeof be=="object"&&be,typeof define=="function"&&define)});var sr=ft((fr,Ae)=>{"use strict";(function(t,e,n){function r(s){var a=this,u="";a.next=function(){var c=a.b,d=a.c,x=a.d,w=a.a;return c=c<<25^c>>>7^d,d=d-x|0,x=x<<24^x>>>8^w,w=w-c|0,a.b=c=c<<20^c>>>12^d,a.c=d=d-x|0,a.d=x<<16^d>>>16^w,a.a=w-c|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,s===Math.floor(s)?(a.a=s/4294967296|0,a.b=s|0):u+=s;for(var p=0;p<u.length+20;p++)a.b^=u.charCodeAt(p)|0,a.next()}function i(s,a){return a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a}function o(s,a){var u=new r(s),p=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},c.int32=u.next,c.quick=c,p&&(typeof p=="object"&&i(p,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:n&&n.amd?n(function(){return o}):this.tychei=o})(fr,typeof Ae=="object"&&Ae,typeof define=="function"&&define)});var ur=ft(()=>{"use strict"});var hr=ft((lr,Zt)=>{"use strict";(function(t,e,n){var r=256,i=6,o=52,s="random",a=n.pow(r,i),u=n.pow(2,o),p=u*2,c=r-1,d;function x(M,N,R){var O=[];N=N==!0?{entropy:!0}:N||{};var _=C(A(N.entropy?[M,F(e)]:M??k(),3),O),V=new w(O),Z=function(){for(var D=V.g(i),f=a,h=0;D<u;)D=(D+h)*r,f*=r,h=V.g(1);for(;D>=p;)D/=2,f/=2,h>>>=1;return(D+h)/f};return Z.int32=function(){return V.g(4)|0},Z.quick=function(){return V.g(4)/4294967296},Z.double=Z,C(F(V.S),e),(N.pass||R||function(D,f,h,l){return l&&(l.S&&P(l,V),D.state=function(){return P(V,{})}),h?(n[s]=D,f):D})(Z,_,"global"in N?N.global:this==n,N.state)}function w(M){var N,R=M.length,O=this,_=0,V=O.i=O.j=0,Z=O.S=[];for(R||(M=[R++]);_<r;)Z[_]=_++;for(_=0;_<r;_++)Z[_]=Z[V=c&V+M[_%R]+(N=Z[_])],Z[V]=N;(O.g=function(D){for(var f,h=0,l=O.i,g=O.j,m=O.S;D--;)f=m[l=c&l+1],h=h*r+m[c&(m[l]=m[g=c&g+f])+(m[g]=f)];return O.i=l,O.j=g,h})(r)}function P(M,N){return N.i=M.i,N.j=M.j,N.S=M.S.slice(),N}function A(M,N){var R=[],O=typeof M,_;if(N&&O=="object")for(_ in M)try{R.push(A(M[_],N-1))}catch{}return R.length?R:O=="string"?M:M+"\0"}function C(M,N){for(var R=M+"",O,_=0;_<R.length;)N[c&_]=c&(O^=N[c&_]*19)+R.charCodeAt(_++);return F(N)}function k(){try{var M;return d&&(M=d.randomBytes)?M=M(r):(M=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(M)),F(M)}catch{var N=t.navigator,R=N&&N.plugins;return[+new Date,t,R,t.screen,F(e)]}}function F(M){return String.fromCharCode.apply(0,M)}if(C(n.random(),e),typeof Zt=="object"&&Zt.exports){Zt.exports=x;try{d=ur()}catch{}}else typeof define=="function"&&define.amd?define(function(){return x}):n["seed"+s]=x})(typeof self<"u"?self:lr,[],Math)});var pr=ft((ma,cr)=>{"use strict";var Ro=Kn(),qo=tr(),_o=nr(),Do=ir(),So=ar(),Lo=sr(),gt=hr();gt.alea=Ro;gt.xor128=qo;gt.xorwow=_o;gt.xorshift7=Do;gt.xor4096=So;gt.tychei=Lo;cr.exports=gt});function dr(t){for(var e=-1,n=t.length,r,i=t[n-1],o=0;++e<n;)r=i,i=t[e],o+=r[1]*i[0]-r[0]*i[1];return o/2}var gr=y(()=>{"use strict"});function mr(t){for(var e=-1,n=t.length,r=0,i=0,o,s=t[n-1],a,u=0;++e<n;)o=s,s=t[e],u+=a=o[0]*s[1]-s[0]*o[1],r+=(o[0]+s[0])*a,i+=(o[1]+s[1])*a;return u*=3,[r/u,i/u]}var xr=y(()=>{"use strict"});function vr(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}var wr=y(()=>{"use strict"});function Wo(t,e){return t[0]-e[0]||t[1]-e[1]}function yr(t){let e=t.length,n=[0,1],r=2,i;for(i=2;i<e;++i){for(;r>1&&vr(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function br(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(Wo),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var o=yr(r),s=yr(i),a=s[0]===o[0],u=s[s.length-1]===o[o.length-1],p=[];for(e=o.length-1;e>=0;--e)p.push(t[r[o[e]][2]]);for(e=+a;e<s.length-u;++e)p.push(t[r[s[e]][2]]);return p}var Ar=y(()=>{"use strict";wr()});function Cr(t,e){for(var n=t.length,r=t[n-1],i=e[0],o=e[1],s=r[0],a=r[1],u,p,c=!1,d=0;d<n;++d)r=t[d],u=r[0],p=r[1],p>o!=a>o&&i<(s-u)*(o-p)/(a-p)+u&&(c=!c),s=u,a=p;return c}var Mr=y(()=>{"use strict"});function Fr(t){for(var e=-1,n=t.length,r=t[n-1],i,o,s=r[0],a=r[1],u=0;++e<n;)i=s,o=a,r=t[e],s=r[0],a=r[1],i-=s,o-=a,u+=Math.hypot(i,o);return u}var Ir=y(()=>{"use strict"});var zr={};Tt(zr,{polygonArea:()=>dr,polygonCentroid:()=>mr,polygonContains:()=>Cr,polygonHull:()=>br,polygonLength:()=>Fr});var Er=y(()=>{"use strict";gr();xr();Ar();Mr();Ir()});function At(){return mt||(Tr(Po),mt=Dt.now()+Kt)}function Po(){mt=0}function xt(){this._call=this._time=this._next=null}function Me(t,e,n){var r=new xt;return r.restart(t,e,n),r}function Fe(){At(),++bt;for(var t=Yt,e;t;)(e=mt-t._time)>=0&&t._call.call(null,e),t=t._next;--bt}function kr(){mt=(Jt=Dt.now())+Kt,bt=qt=0;try{Fe()}finally{bt=0,Vo(),mt=0}}function jo(){var t=Dt.now(),e=t-Jt;e>Nr&&(Kt-=e,Jt=t)}function Vo(){for(var t,e=Yt,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Yt=n);_t=t,Ce(r)}function Ce(t){if(!bt){qt&&(qt=clearTimeout(qt));var e=t-mt;e>24?(t<1/0&&(qt=setTimeout(kr,t-Dt.now()-Kt)),Rt&&(Rt=clearInterval(Rt))):(Rt||(Jt=Dt.now(),Rt=setInterval(jo,Nr)),bt=1,Tr(kr))}}var bt,qt,Rt,Nr,Yt,_t,Jt,mt,Kt,Dt,Tr,Qt=y(()=>{"use strict";bt=0,qt=0,Rt=0,Nr=1e3,Jt=0,mt=0,Kt=0,Dt=typeof performance=="object"&&performance.now?performance:Date,Tr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};xt.prototype=Me.prototype={constructor:xt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?At():+n)+(e==null?0:+e),!this._next&&_t!==this&&(_t?_t._next=this:Yt=this,_t=this),this._call=t,this._time=n,Ce()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ce())}}});function Or(t,e,n){var r=new xt;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Rr=y(()=>{"use strict";Qt()});function qr(t,e,n){var r=new xt,i=e;return e==null?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?At():+a,r._restart(function u(p){p+=i,r._restart(u,i+=s,a),o(p)},s,a)},r.restart(t,e,n),r)}var _r=y(()=>{"use strict";Qt()});var Dr={};Tt(Dr,{interval:()=>qr,now:()=>At,timeout:()=>Or,timer:()=>Me,timerFlush:()=>Fe});var Sr=y(()=>{"use strict";Qt();Rr();_r()});function Wr(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new te(n)}function te(t){this._=t}function Go(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}function Uo(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Lr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Ho,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Ho,Pr,jr=y(()=>{"use strict";Ho={value:()=>{}};te.prototype=Wr.prototype={constructor:te,on:function(t,e){var n=this._,r=Go(t+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(t=r[o]).type)&&(i=Uo(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=Lr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Lr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new te(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};Pr=Wr});var Vr={};Tt(Vr,{dispatch:()=>Pr});var Hr=y(()=>{"use strict";jr()});function B(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ut=y(()=>{"use strict"});function St(t){let e=t,n=t;t.length===1&&(e=(s,a)=>t(s)-a,n=Xo(t));function r(s,a,u,p){for(u==null&&(u=0),p==null&&(p=s.length);u<p;){let c=u+p>>>1;n(s[c],a)<0?u=c+1:p=c}return u}function i(s,a,u,p){for(u==null&&(u=0),p==null&&(p=s.length);u<p;){let c=u+p>>>1;n(s[c],a)>0?p=c:u=c+1}return u}function o(s,a,u,p){u==null&&(u=0),p==null&&(p=s.length);let c=r(s,a,u,p-1);return c>u&&e(s[c-1],a)>-e(s[c],a)?c-1:c}return{left:r,center:o,right:i}}function Xo(t){return(e,n)=>B(t(e),n)}var Ie=y(()=>{"use strict";ut()});function ee(t){return t===null?NaN:+t}function*Gr(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}var ze=y(()=>{"use strict"});var Ur,Ee,Xr,Br,ne,ke=y(()=>{"use strict";ut();Ie();ze();Ur=St(B),Ee=Ur.right,Xr=Ur.left,Br=St(ee).center,ne=Ee});function lt(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&++n}return n}var Lt=y(()=>{"use strict"});function Bo(t){return t.length|0}function $o(t){return!(t>0)}function Zo(t){return typeof t!="object"||"length"in t?t:Array.from(t)}function Yo(t){return e=>t(...e)}function Ne(...t){let e=typeof t[t.length-1]=="function"&&Yo(t.pop());t=t.map(Zo);let n=t.map(Bo),r=t.length-1,i=new Array(r+1).fill(0),o=[];if(r<0||n.some($o))return o;for(;;){o.push(i.map((a,u)=>t[u][a]));let s=r;for(;++i[s]===n[s];){if(s===0)return e?o.map(e):o;i[s--]=0}}}var $r=y(()=>{"use strict"});function Te(t,e){var n=0,r=0;return Float64Array.from(t,e===void 0?i=>n+=+i||0:i=>n+=+e(i,r++,t)||0)}var Zr=y(()=>{"use strict"});function Yr(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}var Jr=y(()=>{"use strict"});function Wt(t,e){let n=0,r,i=0,o=0;if(e===void 0)for(let s of t)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of t)(a=e(a,++s,t))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}var Oe=y(()=>{"use strict"});function Pt(t,e){let n=Wt(t,e);return n&&Math.sqrt(n)}var Re=y(()=>{"use strict";Oe()});function Ct(t,e){let n,r;if(e===void 0)for(let i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}var qe=y(()=>{"use strict"});function Kr(t,e){let n=new Mt;if(e===void 0)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&n.add(i)}return+n}function Qr(t,e){let n=new Mt,r=-1;return Float64Array.from(t,e===void 0?i=>n.add(+i||0):i=>n.add(+e(i,++r,t)||0))}var Mt,ti=y(()=>{"use strict";Mt=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let i=0;i<this._n&&i<32;i++){let o=n[i],s=e+o,a=Math.abs(e)<Math.abs(o)?e-(s-o):o-(s-e);a&&(n[r++]=a),e=s}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n=this._n,r,i,o,s=0;if(n>0){for(s=e[--n];n>0&&(r=s,i=e[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&e[n-1]<0||o>0&&e[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}});function _e({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):n}function ei({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function ni({_intern:t,_key:e},n){let r=e(n);return t.has(r)&&(n=t.get(n),t.delete(r)),n}function ri(t){return t!==null&&typeof t=="object"?t.valueOf():t}var Ft,re,De=y(()=>{"use strict";Ft=class extends Map{constructor(e,n=ri){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let[r,i]of e)this.set(r,i)}get(e){return super.get(_e(this,e))}has(e){return super.has(_e(this,e))}set(e,n){return super.set(ei(this,e),n)}delete(e){return super.delete(ni(this,e))}},re=class extends Set{constructor(e,n=ri){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let r of e)this.add(r)}has(e){return super.has(_e(this,e))}add(e){return super.add(ei(this,e))}delete(e){return super.delete(ni(this,e))}}});function ht(t){return t}var Se=y(()=>{"use strict"});function jt(t,...e){return It(t,ht,ht,e)}function ii(t,...e){return It(t,Array.from,ht,e)}function ie(t,e,...n){return It(t,ht,e,n)}function oi(t,e,...n){return It(t,Array.from,e,n)}function ai(t,...e){return It(t,ht,si,e)}function fi(t,...e){return It(t,Array.from,si,e)}function si(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function It(t,e,n,r){return function i(o,s){if(s>=r.length)return n(o);let a=new Ft,u=r[s++],p=-1;for(let c of o){let d=u(c,++p,o),x=a.get(d);x?x.push(c):a.set(d,[c])}for(let[c,d]of a)a.set(c,i(d,s));return e(a)}(t,0)}var Le=y(()=>{"use strict";De();Se()});function oe(t,e){return Array.from(e,n=>t[n])}var We=y(()=>{"use strict"});function zt(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n=B]=e;if(n.length===1||e.length>1){let r=Uint32Array.from(t,(i,o)=>o);return e.length>1?(e=e.map(i=>t.map(i)),r.sort((i,o)=>{for(let s of e){let a=B(s[i],s[o]);if(a)return a}})):(n=t.map(n),r.sort((i,o)=>B(n[i],n[o]))),oe(t,r)}return t.sort(n)}var Pe=y(()=>{"use strict";ut();We()});function je(t,e,n){return(e.length===1?zt(ie(t,e,n),([r,i],[o,s])=>B(i,s)||B(r,o)):zt(jt(t,n),([r,i],[o,s])=>e(i,s)||B(r,o))).map(([r])=>r)}var ui=y(()=>{"use strict";ut();Le();Pe()});var li,hi,mf,ci=y(()=>{"use strict";li=Array.prototype,hi=li.slice,mf=li.map});function Vt(t){return function(){return t}}var pi=y(()=>{"use strict"});function ae(t,e,n){var r,i=-1,o,s,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),(a=vt(t,e,n))===0||!isFinite(a))return[];if(a>0){let u=Math.round(t/a),p=Math.round(e/a);for(u*a<t&&++u,p*a>e&&--p,s=new Array(o=p-u+1);++i<o;)s[i]=(u+i)*a}else{a=-a;let u=Math.round(t*a),p=Math.round(e*a);for(u/a<t&&++u,p/a>e&&--p,s=new Array(o=p-u+1);++i<o;)s[i]=(u+i)/a}return r&&s.reverse(),s}function vt(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ve?10:o>=He?5:o>=Ge?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ve?10:o>=He?5:o>=Ge?2:1)}function di(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ve?i*=10:o>=He?i*=5:o>=Ge&&(i*=2),e<t?-i:i}var Ve,He,Ge,fe=y(()=>{"use strict";Ve=Math.sqrt(50),He=Math.sqrt(10),Ge=Math.sqrt(2)});function Ht(t,e,n){let r;for(;;){let i=vt(t,e,n);if(i===r||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}var Ue=y(()=>{"use strict";fe()});function se(t){return Math.ceil(Math.log(lt(t))/Math.LN2)+1}var Xe=y(()=>{"use strict";Lt()});function Be(){var t=ht,e=Ct,n=se;function r(i){Array.isArray(i)||(i=Array.from(i));var o,s=i.length,a,u=new Array(s);for(o=0;o<s;++o)u[o]=t(i[o],o,i);var p=e(u),c=p[0],d=p[1],x=n(u,c,d);if(!Array.isArray(x)){let C=d,k=+x;if(e===Ct&&([c,d]=Ht(c,d,k)),x=ae(c,d,k),x[x.length-1]>=d)if(C>=d&&e===Ct){let F=vt(c,d,k);isFinite(F)&&(F>0?d=(Math.floor(d/F)+1)*F:F<0&&(d=(Math.ceil(d*-F)+1)/-F))}else x.pop()}for(var w=x.length;x[0]<=c;)x.shift(),--w;for(;x[w-1]>d;)x.pop(),--w;var P=new Array(w+1),A;for(o=0;o<=w;++o)A=P[o]=[],A.x0=o>0?x[o-1]:c,A.x1=o<w?x[o]:d;for(o=0;o<s;++o)a=u[o],c<=a&&a<=d&&P[ne(x,a,0,w)].push(i[o]);return P}return r.value=function(i){return arguments.length?(t=typeof i=="function"?i:Vt(i),r):t},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:Vt([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Array.isArray(i)?Vt(hi.call(i)):Vt(i),r):n},r}var gi=y(()=>{"use strict";ci();ke();pi();qe();Se();Ue();fe();Xe()});function Et(t,e){let n;if(e===void 0)for(let r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}var $e=y(()=>{"use strict"});function ct(t,e){let n;if(e===void 0)for(let r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}var ue=y(()=>{"use strict"});function kt(t,e,n=0,r=t.length-1,i=B){for(;r>n;){if(r-n>600){let u=r-n+1,p=e-n+1,c=Math.log(u),d=.5*Math.exp(2*c/3),x=.5*Math.sqrt(c*d*(u-d)/u)*(p-u/2<0?-1:1),w=Math.max(n,Math.floor(e-p*d/u+x)),P=Math.min(r,Math.floor(e+(u-p)*d/u+x));kt(t,e,w,P,i)}let o=t[e],s=n,a=r;for(Gt(t,n,e),i(t[r],o)>0&&Gt(t,n,r);s<a;){for(Gt(t,s,a),++s,--a;i(t[s],o)<0;)++s;for(;i(t[a],o)>0;)--a}i(t[n],o)===0?Gt(t,n,a):(++a,Gt(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function Gt(t,e,n){let r=t[e];t[e]=t[n],t[n]=r}var Ze=y(()=>{"use strict";ut()});function pt(t,e,n){if(t=Float64Array.from(Gr(t,n)),!!(r=t.length)){if((e=+e)<=0||r<2)return ct(t);if(e>=1)return Et(t);var r,i=(r-1)*e,o=Math.floor(i),s=Et(kt(t,o).subarray(0,o+1)),a=ct(t.subarray(o+1));return s+(a-s)*(i-o)}}function mi(t,e,n=ee){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t),a=+n(t[o+1],o+1,t);return s+(a-s)*(i-o)}}var le=y(()=>{"use strict";$e();ue();Ze();ze()});function xi(t,e,n){return Math.ceil((n-e)/(2*(pt(t,.75)-pt(t,.25))*Math.pow(lt(t),-1/3)))}var vi=y(()=>{"use strict";Lt();le()});function wi(t,e,n){return Math.ceil((n-e)/(3.5*Pt(t)*Math.pow(lt(t),-1/3)))}var yi=y(()=>{"use strict";Lt();Re()});function Ut(t,e){let n,r=-1,i=-1;if(e===void 0)for(let o of t)++i,o!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of t)(o=e(o,++i,t))!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);return r}var Ye=y(()=>{"use strict"});function Je(t,e){let n=0,r=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}var bi=y(()=>{"use strict"});function Ai(t,e){return pt(t,.5,e)}var Ci=y(()=>{"use strict";le()});function*Jo(t){for(let e of t)yield*zn(e)}function Ke(t){return Array.from(Jo(t))}var Mi=y(()=>{"use strict"});function Xt(t,e){let n,r=-1,i=-1;if(e===void 0)for(let o of t)++i,o!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of t)(o=e(o,++i,t))!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);return r}var Qe=y(()=>{"use strict"});function tn(t,e=Ko){let n=[],r,i=!1;for(let o of t)i&&n.push(e(r,o)),r=o,i=!0;return n}function Ko(t,e){return[t,e]}var Fi=y(()=>{"use strict"});function Ii(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}var zi=y(()=>{"use strict"});function en(t,e=B){let n,r=!1;if(e.length===1){let i;for(let o of t){let s=e(o);(r?B(s,i)<0:B(s,s)===0)&&(n=o,i=s,r=!0)}}else for(let i of t)(r?e(i,n)<0:e(i,i)===0)&&(n=i,r=!0);return n}var Ei=y(()=>{"use strict";ut()});function Bt(t,e=B){if(e.length===1)return Xt(t,e);let n,r=-1,i=-1;for(let o of t)++i,(r<0?e(o,o)===0:e(o,n)<0)&&(n=o,r=i);return r}var nn=y(()=>{"use strict";ut();Qe()});function rn(t,e=B){let n,r=!1;if(e.length===1){let i;for(let o of t){let s=e(o);(r?B(s,i)>0:B(s,s)===0)&&(n=o,i=s,r=!0)}}else for(let i of t)(r?e(i,n)>0:e(i,i)===0)&&(n=i,r=!0);return n}var ki=y(()=>{"use strict";ut()});function on(t,e=B){if(e.length===1)return Ut(t,e);let n,r=-1,i=-1;for(let o of t)++i,(r<0?e(o,o)===0:e(o,n)>0)&&(n=o,r=i);return r}var Ni=y(()=>{"use strict";ut();Ye()});function an(t,e){let n=Bt(t,e);return n<0?void 0:n}var Ti=y(()=>{"use strict";nn()});function fn(t){return function(n,r=0,i=n.length){let o=i-(r=+r);for(;o;){let s=t()*o--|0,a=n[o+r];n[o+r]=n[s+r],n[s+r]=a}return n}}var Oi,Ri=y(()=>{"use strict";Oi=fn(Math.random)});function sn(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}var qi=y(()=>{"use strict"});function he(t){if(!(o=t.length))return[];for(var e=-1,n=ct(t,Qo),r=new Array(n);++e<n;)for(var i=-1,o,s=r[e]=new Array(o);++i<o;)s[i]=t[i][e];return r}function Qo(t){return t.length}var un=y(()=>{"use strict";ue()});function _i(){return he(arguments)}var Di=y(()=>{"use strict";un()});function ln(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let n=-1;for(let r of t)if(!e(r,++n,t))return!1;return!0}var Si=y(()=>{"use strict"});function hn(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let n=-1;for(let r of t)if(e(r,++n,t))return!0;return!1}var Li=y(()=>{"use strict"});function cn(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let n=[],r=-1;for(let i of t)e(i,++r,t)&&n.push(i);return n}var Wi=y(()=>{"use strict"});function pn(t,e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof e!="function")throw new TypeError("mapper is not a function");return Array.from(t,(n,r)=>e(n,r,t))}var Pi=y(()=>{"use strict"});function dn(t,e,n){if(typeof e!="function")throw new TypeError("reducer is not a function");let r=t[Symbol.iterator](),i,o,s=-1;if(arguments.length<3){if({done:i,value:n}=r.next(),i)return;++s}for(;{done:i,value:o}=r.next(),!i;)n=e(n,o,++s,t);return n}var ji=y(()=>{"use strict"});function gn(t){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(t).reverse()}var Vi=y(()=>{"use strict"});function mn(t,...e){t=new Set(t);for(let n of e)for(let r of n)t.delete(r);return t}var Hi=y(()=>{"use strict"});function xn(t,e){let n=e[Symbol.iterator](),r=new Set;for(let i of t){if(r.has(i))return!1;let o,s;for(;({value:o,done:s}=n.next())&&!s;){if(Object.is(i,o))return!1;r.add(o)}}return!0}var Gi=y(()=>{"use strict"});function vn(t){return t instanceof Set?t:new Set(t)}var Ui=y(()=>{"use strict"});function wn(t,...e){t=new Set(t),e=e.map(vn);t:for(let n of t)for(let r of e)if(!r.has(n)){t.delete(n);continue t}return t}var Xi=y(()=>{"use strict";Ui()});function $t(t,e){let n=t[Symbol.iterator](),r=new Set;for(let i of e){if(r.has(i))continue;let o,s;for(;{value:o,done:s}=n.next();){if(s)return!1;if(r.add(o),Object.is(i,o))break}}return!0}var yn=y(()=>{"use strict"});function bn(t,e){return $t(e,t)}var Bi=y(()=>{"use strict";yn()});function An(...t){let e=new Set;for(let n of t)for(let r of n)e.add(r);return e}var $i=y(()=>{"use strict"});var Zi={};Tt(Zi,{Adder:()=>Mt,InternMap:()=>Ft,InternSet:()=>re,ascending:()=>B,bin:()=>Be,bisect:()=>ne,bisectCenter:()=>Br,bisectLeft:()=>Xr,bisectRight:()=>Ee,bisector:()=>St,count:()=>lt,cross:()=>Ne,cumsum:()=>Te,descending:()=>Yr,deviation:()=>Pt,difference:()=>mn,disjoint:()=>xn,every:()=>ln,extent:()=>Ct,fcumsum:()=>Qr,filter:()=>cn,fsum:()=>Kr,greatest:()=>rn,greatestIndex:()=>on,group:()=>jt,groupSort:()=>je,groups:()=>ii,histogram:()=>Be,index:()=>ai,indexes:()=>fi,intersection:()=>wn,least:()=>en,leastIndex:()=>Bt,map:()=>pn,max:()=>Et,maxIndex:()=>Ut,mean:()=>Je,median:()=>Ai,merge:()=>Ke,min:()=>ct,minIndex:()=>Xt,nice:()=>Ht,pairs:()=>tn,permute:()=>oe,quantile:()=>pt,quantileSorted:()=>mi,quickselect:()=>kt,range:()=>Ii,reduce:()=>dn,reverse:()=>gn,rollup:()=>ie,rollups:()=>oi,scan:()=>an,shuffle:()=>Oi,shuffler:()=>fn,some:()=>hn,sort:()=>zt,subset:()=>bn,sum:()=>sn,superset:()=>$t,thresholdFreedmanDiaconis:()=>xi,thresholdScott:()=>wi,thresholdSturges:()=>se,tickIncrement:()=>vt,tickStep:()=>di,ticks:()=>ae,transpose:()=>he,union:()=>An,variance:()=>Wt,zip:()=>_i});var Yi=y(()=>{"use strict";ke();ut();Ie();Lt();$r();Zr();Jr();Re();qe();ti();Le();ui();gi();vi();yi();Xe();$e();Ye();bi();Ci();Mi();ue();Qe();Ue();Fi();We();le();Ze();zi();Ei();nn();ki();Ni();Ti();Ri();qi();fe();un();Oe();Di();Si();Li();Wi();Pi();ji();Vi();Pe();Hi();Gi();Xi();Bi();yn();$i();De()});function Ji(t){for(var e=-1,n=t.length,r,i=t[n-1],o=0;++e<n;)r=i,i=t[e],o+=r[1]*i[0]-r[0]*i[1];return o/2}var Ki=y(()=>{"use strict"});function Qi(t){for(var e=-1,n=t.length,r=0,i=0,o,s=t[n-1],a,u=0;++e<n;)o=s,s=t[e],u+=a=o[0]*s[1]-s[0]*o[1],r+=(o[0]+s[0])*a,i+=(o[1]+s[1])*a;return u*=3,[r/u,i/u]}var to=y(()=>{"use strict"});function eo(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}var no=y(()=>{"use strict"});function ta(t,e){return t[0]-e[0]||t[1]-e[1]}function ro(t){let e=t.length,n=[0,1],r=2,i;for(i=2;i<e;++i){for(;r>1&&eo(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function io(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(ta),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var o=ro(r),s=ro(i),a=s[0]===o[0],u=s[s.length-1]===o[o.length-1],p=[];for(e=o.length-1;e>=0;--e)p.push(t[r[o[e]][2]]);for(e=+a;e<s.length-u;++e)p.push(t[r[s[e]][2]]);return p}var oo=y(()=>{"use strict";no()});function ao(t,e){for(var n=t.length,r=t[n-1],i=e[0],o=e[1],s=r[0],a=r[1],u,p,c=!1,d=0;d<n;++d)r=t[d],u=r[0],p=r[1],p>o!=a>o&&i<(s-u)*(o-p)/(a-p)+u&&(c=!c),s=u,a=p;return c}var fo=y(()=>{"use strict"});function so(t){for(var e=-1,n=t.length,r=t[n-1],i,o,s=r[0],a=r[1],u=0;++e<n;)i=s,o=a,r=t[e],s=r[0],a=r[1],i-=s,o-=a,u+=Math.hypot(i,o);return u}var uo=y(()=>{"use strict"});var lo={};Tt(lo,{polygonArea:()=>Ji,polygonCentroid:()=>Qi,polygonContains:()=>ao,polygonHull:()=>io,polygonLength:()=>so});var ho=y(()=>{"use strict";Ki();to();oo();fo();uo()});var po=ft((ce,co)=>{"use strict";(function(t,e){typeof ce=="object"&&typeof co<"u"?e(ce,(Yi(),Ot(Zi)),(ho(),Ot(lo))):typeof define=="function"&&define.amd?define(["exports","d3-array","d3-polygon"],e):e(t.d3=t.d3||{},t.d3,t.d3)})(ce,function(t,e,n){"use strict";var r=1e-10;function i(f){return f<=r&&f>=-r}function o(f,h){return f.x*h.x+f.y*h.y+f.z*h.z}function s(f,h){return i(f.x*h.y-f.y*h.x)&&i(f.y*h.z-f.z*h.y)&&i(f.z*h.x-f.x*h.z)}function a(f){var h,l,g,m,I,b,z,v;if(g=f[f.length-2],m=f[f.length-1],I=f[0],b=u(g,m),z=u(m,I),l=p(b,z),h=Math.sign(l),g=m,m=I,I=f[1],b=z,z=u(m,I),l=p(b,z),Math.sign(l)===h){for(v=2;v<f.length-1;v++)if(g=m,m=I,I=f[v],b=z,z=u(m,I),l=p(b,z),Math.sign(l)!==h)return;return h}}function u(f,h){return[h[0]-f[0],h[1]-f[1]]}function p(f,h){return f[0]*h[1]-f[1]*h[0]}function c(f,h){this.face=f,this.vert=h,this.nextf=null,this.prevf=null,this.nextv=null,this.prevv=null}function d(f){this.forFace=f,this.head=null}d.prototype.add=function(f){this.head===null?this.head=f:this.forFace?(this.head.prevv=f,f.nextv=this.head,this.head=f):(this.head.prevf=f,f.nextf=this.head,this.head=f)},d.prototype.isEmpty=function(){return this.head===null},d.prototype.fill=function(f){if(!this.forFace){var h=this.head;do f.push(h.face),h.face.marked=!0,h=h.nextf;while(h!==null)}},d.prototype.removeAll=function(){if(this.forFace){var f=this.head;do f.prevf===null?f.nextf===null?f.vert.conflicts.head=null:(f.nextf.prevf=null,f.vert.conflicts.head=f.nextf):(f.nextf!=null&&(f.nextf.prevf=f.prevf),f.prevf.nextf=f.nextf),f=f.nextv,f!=null&&(f.prevv=null);while(f!=null)}else{var f=this.head;do f.prevv==null?f.nextv==null?f.face.conflicts.head=null:(f.nextv.prevv=null,f.face.conflicts.head=f.nextv):(f.nextv!=null&&(f.nextv.prevv=f.prevv),f.prevv.nextv=f.nextv),f=f.nextf,f!=null&&(f.prevf=null);while(f!=null)}},d.prototype.getVertices=function(){for(var f=[],h=this.head;h!==null;)f.push(h.vert),h=h.nextv;return f};function x(f,h,l,g,m,I){this.x=f,this.y=h,this.weight=r,this.index=0,this.conflicts=new d(!1),this.neighbours=null,this.nonClippedPolygon=null,this.polygon=null,this.originalObject=null,this.isDummy=!1,m!==void 0&&(this.originalObject=m),I!=null&&(this.isDummy=I),g!=null&&(this.weight=g),l!=null?this.z=l:this.z=this.projectZ(this.x,this.y,this.weight)}x.prototype.projectZ=function(f,h,l){return f*f+h*h-l},x.prototype.setWeight=function(f){this.weight=f,this.z=this.projectZ(this.x,this.y,this.weight)},x.prototype.subtract=function(f){return new x(f.x-this.x,f.y-this.y,f.z-this.z)},x.prototype.crossproduct=function(f){return new x(this.y*f.z-this.z*f.y,this.z*f.x-this.x*f.z,this.x*f.y-this.y*f.x)},x.prototype.equals=function(f){return this.x===f.x&&this.y===f.y&&this.z===f.z};function w(f){var h=f.verts[0],l=f.verts[1],g=f.verts[2];this.a=h.y*(l.z-g.z)+l.y*(g.z-h.z)+g.y*(h.z-l.z),this.b=h.z*(l.x-g.x)+l.z*(g.x-h.x)+g.z*(h.x-l.x),this.c=h.x*(l.y-g.y)+l.x*(g.y-h.y)+g.x*(h.y-l.y),this.d=-1*(h.x*(l.y*g.z-g.y*l.z)+l.x*(g.y*h.z-h.y*g.z)+g.x*(h.y*l.z-l.y*h.z))}w.prototype.getNormZPlane=function(){return[-1*(this.a/this.c),-1*(this.b/this.c),-1*(this.d/this.c)]},w.prototype.getDualPointMappedToPlane=function(){var f=this.getNormZPlane(),h=new P(f[0]/2,f[1]/2);return h};function P(f,h){this.x=f,this.y=h}function A(f,h,l){this.x=f,this.y=h,this.z=l}A.prototype.negate=function(){this.x*=-1,this.y*=-1,this.z*=-1},A.prototype.normalize=function(){var f=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);f>0&&(this.x/=f,this.y/=f,this.z/=f)};function C(f,h,l){this.next=null,this.prev=null,this.twin=null,this.orig=f,this.dest=h,this.iFace=l}C.prototype.isHorizon=function(){return this.twin!==null&&!this.iFace.marked&&this.twin.iFace.marked},C.prototype.findHorizon=function(f){if(this.isHorizon()){if(f.length>0&&this===f[0])return;f.push(this),this.next.findHorizon(f)}else this.twin!==null&&this.twin.next.findHorizon(f)},C.prototype.isEqual=function(f,h){return this.orig.equals(f)&&this.dest.equals(h)||this.orig.equals(h)&&this.dest.equals(f)};function k(f){this.message=f,this.stack=new Error().stack}k.prototype.name="d3WeightedVoronoiError",k.prototype=new Error;function F(f,h,l,g){this.conflicts=new d(!0),this.verts=[f,h,l],this.marked=!1;var m=f.subtract(h).crossproduct(h.subtract(l));this.normal=new A(-m.x,-m.y,-m.z),this.normal.normalize(),this.createEdges(),this.dualPoint=null,g!=null&&this.orient(g)}F.prototype.getDualPoint=function(){if(this.dualPoint==null){var f=new w(this);this.dualPoint=f.getDualPointMappedToPlane()}return this.dualPoint},F.prototype.isVisibleFromBelow=function(){return this.normal.z<-14259414393190911e-25},F.prototype.createEdges=function(){this.edges=[],this.edges[0]=new C(this.verts[0],this.verts[1],this),this.edges[1]=new C(this.verts[1],this.verts[2],this),this.edges[2]=new C(this.verts[2],this.verts[0],this),this.edges[0].next=this.edges[1],this.edges[0].prev=this.edges[2],this.edges[1].next=this.edges[2],this.edges[1].prev=this.edges[0],this.edges[2].next=this.edges[0],this.edges[2].prev=this.edges[1]},F.prototype.orient=function(f){if(!(o(this.normal,f)<o(this.normal,this.verts[0]))){var h=this.verts[1];this.verts[1]=this.verts[2],this.verts[2]=h,this.normal.negate(),this.createEdges()}},F.prototype.getEdge=function(f,h){for(var l=0;l<3;l++)if(this.edges[l].isEqual(f,h))return this.edges[l];return null},F.prototype.link=function(f,h,l){if(f instanceof F){var g=f.getEdge(h,l);if(g===null)throw new k("when linking, twin is null");var m=this.getEdge(h,l);if(m===null)throw new k("when linking, twin is null");g.twin=m,m.twin=g}else{var g=f,m=this.getEdge(g.orig,g.dest);g.twin=m,m.twin=g}},F.prototype.conflict=function(f){return o(this.normal,f)>o(this.normal,this.verts[0])+r},F.prototype.getHorizon=function(){for(var f=0;f<3;f++)if(this.edges[f].twin!==null&&this.edges[f].twin.isHorizon())return this.edges[f];return null},F.prototype.removeConflict=function(){this.conflicts.removeAll()};function M(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0}M.prototype.init=function(f,h){this.points=[];for(var l=0;l<h.length;l++)this.points[l]=new x(h[l].x,h[l].y,h[l].z,null,h[l],!1);this.points=this.points.concat(f)},M.prototype.permutate=function(){for(var f=this.points.length,h=f-1;h>0;h--){var l=Math.floor(Math.random()*h),g=this.points[l];g.index=h;var m=this.points[h];m.index=l,this.points.splice(l,1,m),this.points.splice(h,1,g)}},M.prototype.prep=function(){if(this.points.length<=3)throw new k("Less than 4 points");for(var f=0;f<this.points.length;f++)this.points[f].index=f;var h,l,g,m,I,b,z,v;h=this.points[0],l=this.points[1],g=m=null;for(var f=2;f<this.points.length;f++)if(!(s(h,this.points[f])&&s(l,this.points[f]))){g=this.points[f],g.index=2,this.points[2].index=f,this.points.splice(f,1,this.points[2]),this.points.splice(2,1,g);break}if(g===null)throw new k("Not enough non-planar Points (v2 is null)");v=new F(h,l,g);for(var f=3;f<this.points.length;f++)if(!i(o(v.normal,v.verts[0])-o(v.normal,this.points[f]))){m=this.points[f],m.index=3,this.points[3].index=f,this.points.splice(f,1,this.points[3]),this.points.splice(3,1,m);break}if(m===null)throw new k("Not enough non-planar Points (v3 is null)");v.orient(m),I=new F(h,g,m,l),b=new F(h,l,m,g),z=new F(l,g,m,h),this.addFacet(v),this.addFacet(I),this.addFacet(b),this.addFacet(z),v.link(I,h,g),v.link(b,h,l),v.link(z,l,g),I.link(b,h,m),I.link(z,g,m),b.link(z,m,l),this.current=4;for(var T,f=this.current;f<this.points.length;f++)T=this.points[f],v.conflict(T)&&this.addConflict(v,T),I.conflict(T)&&this.addConflict(I,T),b.conflict(T)&&this.addConflict(b,T),z.conflict(T)&&this.addConflict(z,T)},M.prototype.addConflicts=function(f,h,l){var g=f.conflicts.getVertices(),m=h.conflicts.getVertices(),I=[],b,z,v,T;for(v=T=0;v<g.length||T<m.length;)v<g.length&&T<m.length?(b=g[v],z=m[T],b.index===z.index?(I.push(b),v++,T++):b.index>z.index?(I.push(b),v++):(I.push(z),T++)):v<g.length?I.push(g[v++]):I.push(m[T++]);for(var v=I.length-1;v>=0;v--)b=I[v],l.conflict(b)&&this.addConflict(l,b)},M.prototype.addConflict=function(f,h){var l=new c(f,h);f.conflicts.add(l),h.conflicts.add(l)},M.prototype.removeConflict=function(f){f.removeConflict();var h=f.index;if(f.index=-1,h===this.facets.length-1){this.facets.splice(this.facets.length-1,1);return}if(!(h>=this.facets.length||h<0)){var l=this.facets.splice(this.facets.length-1,1);l[0].index=h,this.facets.splice(h,1,l[0])}},M.prototype.addFacet=function(f){f.index=this.facets.length,this.facets.push(f)},M.prototype.compute=function(){for(this.prep();this.current<this.points.length;){var f=this.points[this.current];if(f.conflicts.isEmpty()){this.current++;continue}this.created=[],this.horizon=[],this.visible=[],f.conflicts.fill(this.visible);for(var h,l=0;l<this.visible.length;l++)if(h=this.visible[l].getHorizon(),h!==null){h.findHorizon(this.horizon);break}for(var g=null,m=null,I=0;I<this.horizon.length;I++){var b=this.horizon[I],z=new F(f,b.orig,b.dest,b.twin.next.dest);z.conflicts=new d(!0),this.addFacet(z),this.created.push(z),this.addConflicts(b.iFace,b.twin.iFace,z),z.link(b),g!==null&&z.link(g,f,b.orig),g=z,m===null&&(m=z)}if(m!==null&&g!==null&&g.link(m,f,this.horizon[0].orig),this.created.length!=0){for(var v=0;v<this.visible.length;v++)this.removeConflict(this.visible[v]);this.current++,this.created=[]}}return this.facets},M.prototype.clear=function(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0};function N(f,h){for(var l,g=_(h),m=-1,I=f.length-_(f),b,z,v=f[I-1],T,q,S,U;++m<I;){for(l=h.slice(),h.length=0,T=f[m],q=l[(z=l.length-g)-1],b=-1;++b<z;)S=l[b],R(S,v,T)?(R(q,v,T)||(U=O(q,S,v,T),isFinite(U[0])&&h.push(U)),h.push(S)):R(q,v,T)&&(U=O(q,S,v,T),isFinite(U[0])&&h.push(U)),q=S;g&&h.push(h[0]),v=T}return h}function R(f,h,l){return(l[0]-h[0])*(f[1]-h[1])<(l[1]-h[1])*(f[0]-h[0])}function O(f,h,l,g){var m=f[0],I=l[0],b=h[0]-m,z=g[0]-I,v=f[1],T=l[1],q=h[1]-v,S=g[1]-T,U=(z*(v-T)-S*(m-I))/(S*b-z*q);return[m+U*b,v+U*q]}function _(f){var h=f[0],l=f[f.length-1];return!(h[0]-l[0]||h[1]-l[1])}function V(f){var h=[],l=f,g=f.dest,m=g.originalObject,I=[];do{l=l.twin.prev;var b=l.orig.originalObject;b.isDummy||I.push(b);var z=l.iFace;z.isVisibleFromBelow()&&h.push(z)}while(l!==f);return m.neighbours=I,h}function Z(f,h,l){var g=new M;g.clear(),g.init(h,f);for(var m=g.compute(f),I=[],b=[],z=m.length,v=0;v<z;v++){var T=m[v];if(T.isVisibleFromBelow())for(var q=0;q<3;q++){var S=T.edges[q],U=S.dest,tt=U.originalObject;if(!b[U.index]){if(b[U.index]=!0,tt.isDummy)continue;for(var et=V(S),j=[],it=null,at=null,Q=1,st=1,rt=0;rt<et.length;rt++){var Nt=et[rt].getDualPoint(),wt=Nt.x,yt=Nt.y;it!==null&&(Q=it-wt,st=at-yt,Q<0&&(Q=-Q),st<0&&(st=-st)),(Q>r||st>r)&&(j.push([wt,yt]),it=wt,at=yt)}if(tt.nonClippedPolygon=j.reverse(),!tt.isDummy&&n.polygonLength(tt.nonClippedPolygon)>0){var dt=N(l,tt.nonClippedPolygon);tt.polygon=dt,dt.site=tt,dt.length>0&&I.push(dt)}}}}return I}function D(){var f=function(v){return v.x},h=function(v){return v.y},l=function(v){return v.weight},g=[[0,0],[0,1],[1,1],[1,0]],m=[[0,0],[1,1]],I=[1,1];function b(v){var T;return T=v.map(function(q){return new x(f(q),h(q),null,l(q),q,!1)}),Z(T,z(),g)}b.x=function(v){return arguments.length?(f=v,b):f},b.y=function(v){return arguments.length?(h=v,b):h},b.weight=function(v){return arguments.length?(l=v,b):l},b.clip=function(v){var T,q,S;return arguments.length?(q=e.extent(v.map(function(U){return U[0]})),S=e.extent(v.map(function(U){return U[1]})),T=a(v),T===void 0?g=n.polygonHull(v):T===1?g=v.reverse():g=v,m=[[q[0],S[0]],[q[1],S[1]]],I=[q[1]-q[0],S[1]-S[0]],b):g},b.extent=function(v){return arguments.length?(g=[v[0],[v[0][0],v[1][1]],v[1],[v[1][0],v[0][1]]],m=v,I=[v[1][0]-v[0][0],v[1][1]-v[0][1]],b):m},b.size=function(v){return arguments.length?(g=[[0,0],[0,v[1]],[v[0],v[1]],[v[0],0]],m=[[0,0],v],I=v,b):I};function z(){var v,T,q,S,U,tt,et,j,it,at,Q=[],st=[];v=m[0][0],T=m[1][0],q=m[0][1],S=m[1][1],U=T-v,tt=S-q,et=v-U,j=T+U,it=q-tt,at=S+tt,Q[0]=[et,it],Q[1]=[et,at],Q[2]=[j,at],Q[3]=[j,it];for(var rt=0;rt<4;rt++)st.push(new x(Q[rt][0],Q[rt][1],null,r,new x(Q[rt][0],Q[rt][1],null,r,null,!0),!0));return st}return b}t.weightedVoronoi=D,t.d3WeightedVoronoiError=k,Object.defineProperty(t,"__esModule",{value:!0})})});var mo=ft((pe,go)=>{"use strict";(function(t,e){typeof pe=="object"&&typeof go<"u"?e(pe,(Er(),Ot(zr)),(Sr(),Ot(Dr)),(Hr(),Ot(Vr)),po()):typeof define=="function"&&define.amd?define(["exports","d3-polygon","d3-timer","d3-dispatch","d3-weighted-voronoi"],e):e(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(pe,function(t,e,n,r,i){"use strict";function o(){this.growthChangesLength=s,this.totalAvailableArea=NaN,this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights)}var s=10;function a(A,C){return A>=C?1:-1}function u(A){for(var C=3,k=1,F=1,M=C,N=[],R=0;R<A;R++)N.push(M),M-=k,M<F&&(M=F);return N}function p(A){for(var C=0,k=0;k<A.length;k++)C+=A[k];return C}o.prototype.reset=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangesLength=s,this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights),this.totalAvailableArea=NaN,this},o.prototype.clear=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this},o.prototype.length=function(A){return arguments.length?(parseInt(A)>0?(this.growthChangesLength=Math.floor(parseInt(A)),this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights)):console.warn("FlickeringMitigation.length() accepts only positive integers; unable to handle "+A),this):this.growthChangesLength},o.prototype.totalArea=function(A){return arguments.length?(parseFloat(A)>0?this.totalAvailableArea=parseFloat(A):console.warn("FlickeringMitigation.totalArea() accepts only positive numbers; unable to handle "+A),this):this.totalAvailableArea},o.prototype.add=function(A){var C,k;return C=this.lastAreaError,this.lastAreaError=A,isNaN(C)||(k=this.lastGrowth,this.lastGrowth=a(this.lastAreaError,C)),isNaN(k)||this.growthChanges.unshift(this.lastGrowth!=k),this.growthChanges.length>this.growthChangesLength&&this.growthChanges.pop(),this},o.prototype.ratio=function(){var A=0,C;if(this.growthChanges.length<this.growthChangesLength||this.lastAreaError>this.totalAvailableArea/10)return 0;for(var k=0;k<this.growthChangesLength;k++)this.growthChanges[k]&&(A+=this.growthChangeWeights[k]);return C=A/this.growthChangeWeightsSum,C};function c(){var A,C,k,F,M,N,R,O;function _(Z,D,f,h){var l=!1,g,m;for(A!==h.clip()&&(A=h.clip(),C=h.extent(),l=!0),l&&V(),g=k+R*h.prng()(),m=M+O*h.prng()();!e.polygonContains(A,[g,m]);)g=k+R*h.prng()(),m=M+O*h.prng()();return[g,m]}function V(){k=C[0][0],F=C[1][0],M=C[0][1],N=C[1][1],R=F-k,O=N-M}return _}function d(){var A=0,C,k,F,M,N,R;function O(D,f,h,l){var g=!1;return C!==l.clip()&&(C=l.clip(),g|=!0),k!==h&&(k=h,g|=!0),g&&_(),[M[0]+Math.cos(A+f*R)*N+(l.prng()()-.5)*.001,M[1]+Math.sin(A+f*R)*N+(l.prng()()-.5)*.001]}O.startAngle=function(D){return arguments.length?(A=D,O):A};function _(){M=e.polygonCentroid(C),N=V(M,C)/2,F=k.length,R=2*Math.PI/F}function V(D,f){for(var h=1/0,l=0,g=f[f.length-1],m=f[l],I;l<f.length;)I=Z(D,g,m),I<h&&(h=I),l++,g=m,m=f[l];return h}function Z(D,f,h){var l=D[0],g=D[1],m=f[0],I=f[1],b=h[0],z=h[1],v=l-m,T=g-I,q=b-m,S=z-I,U=v*q+T*S,tt=q*q+S*S,et=-1;tt!=0&&(et=U/tt);var j,it;et<0?(j=m,it=I):et>1?(j=b,it=z):(j=m+et*q,it=I+et*S);var at=l-j,Q=g-it;return Math.sqrt(at*at+Q*Q)}return O}function x(){var A,C,k,F,M;function N(O,_,V,Z){var D=!1;return A!==Z.clip()&&(A=Z.clip(),D|=!0),C!==V&&(C=V,D|=!0),D&&R(),M}function R(){k=C.length,F=e.polygonArea(A),M=F/k/2}return N}function w(A){this.message=A,this.stack=new Error().stack}w.prototype.name="d3VoronoiMapError",w.prototype=new Error;function P(A){var C=.01,k=50,F=.01,M=Math.random,N=c(),R=x(),O=c(),_=1e-10,V=function(E){return E.weight},Z=C,D=k,f=F,h=M,l=N,g=R,m=i.weightedVoronoi(),I=new o,b=!0,z,v,T,q,S,U,tt,et,j,it=n.timer(yt),at=r.dispatch("tick","end");let Q=1,st=1e3;var rt;function Nt(E){return Math.pow(E,2)}function wt(E,$){return Nt($.x-E.x)+Nt($.y-E.y)}j={tick:dt,restart:function(){return it.restart(yt),j},stop:function(){return it.stop(),j},weight:function(E){return arguments.length?(V=E,b=!0,j):V},convergenceRatio:function(E){return arguments.length?(Z=E,b=!0,j):Z},maxIterationCount:function(E){return arguments.length?(D=E,j):D},minWeightRatio:function(E){return arguments.length?(f=E,b=!0,j):f},clip:function(E){return arguments.length?(m.clip(E),b=!0,j):m.clip()},extent:function(E){return arguments.length?(m.extent(E),b=!0,j):m.extent()},size:function(E){return arguments.length?(m.size(E),b=!0,j):m.size()},prng:function(E){return arguments.length?(h=E,b=!0,j):h},initialPosition:function(E){return arguments.length?(l=E,b=!0,j):l},initialWeight:function(E){return arguments.length?(g=E,b=!0,j):g},state:function(){return b&&Mn(),{ended:et,iterationCount:q,convergenceRatio:U/v,polygons:S}},on:function(E,$){return arguments.length===1?at.on(E):(at.on(E,$),j)}};function yt(){dt(),at.call("tick",j),et&&(it.stop(),at.call("end",j))}function dt(){et||(b&&Mn(),S=Io(S,I.ratio()),q++,U=No(S),I.add(U),tt=U<T,et=tt||q>=D)}function Mn(){To(),z=A.length,v=Math.abs(e.polygonArea(m.clip())),T=Z*v,I.clear().totalArea(v),q=0,tt=!1,S=Mo(A,j),et=!1,b=!1}function Mo(E,$){var X=E.reduce(function(G,Y){return Math.max(G,V(Y))},-1/0),W=X*f,L,H;return L=E.map(function(G,Y,K){return{index:Y,weight:Math.max(V(G),W),initialPosition:l(G,Y,K,$),initialWeight:g(G,Y,K,$),originalData:G}}),H=Fo(L,$),rt(H),m(H)}function Fo(E,$){var X=E.reduce(function(L,H){return L+=H.weight},0),W;return E.map(function(L,H,G){return W=L.initialPosition,e.polygonContains(m.clip(),W)||(W=N(L,H,G,$)),{index:L.index,targetedArea:v*L.weight/X,data:L,x:W[0],y:W[1],weight:L.initialWeight}})}function Io(E,$){var X;if(zo(E,$),X=E.map(function(W){return W.site.originalObject}),E=m(X),E.length<z)throw new w("at least 1 site has no area, which is not supposed to arise");if(Eo(E,$),X=E.map(function(W){return W.site.originalObject}),E=m(X),E.length<z)throw new w("at least 1 site has no area, which is not supposed to arise");return E}function zo(E,$){var X=[],W=.5,L,H,G,Y,K,nt,ot;L=W*$,H=1-L;for(var ge=0;ge<z;ge++)G=E[ge],Y=G.site.originalObject,K=e.polygonCentroid(G),nt=K[0]-Y.x,ot=K[1]-Y.y,nt*=H,ot*=H,Y.x+=nt,Y.y+=ot,X.push(Y);rt(X)}function Eo(E,$){var X=[],W=.1,L,H,G,Y,K,nt;L=W*$;for(var ot=0;ot<z;ot++)H=E[ot],G=H.site.originalObject,Y=e.polygonArea(H),K=G.targetedArea/Y,K=Math.max(K,1-W+L),K=Math.min(K,1+W-L),nt=G.weight*K,nt=Math.max(nt,_),G.weight=nt,X.push(G);rt(X)}function Fn(E){var $=0,X,W,L,H,G,Y,K;do{if($>st)throw new w("handleOverweighted0 is looping too much");X=!1;for(var nt=0;nt<z;nt++){W=E[nt];for(var ot=nt+1;ot<z;ot++)if(L=E[ot],W.weight>L.weight?(H=W,G=L):(H=L,G=W),Y=wt(W,L),Y<H.weight-G.weight){K=Y+G.weight/2,K=Math.max(K,_),H.weight=K,X=!0,$++;break}if(X)break}}while(X)}function ko(E){var $=0,X,W,L,H,G,Y,K;do{if($>st)throw new w("handleOverweighted1 is looping too much");X=!1;for(var nt=0;nt<z;nt++){W=E[nt];for(var ot=nt+1;ot<z;ot++)if(L=E[ot],W.weight>L.weight?(H=W,G=L):(H=L,G=W),Y=wt(W,L),Y<H.weight-G.weight){K=H.weight-G.weight-Y,G.weight+=K+_,X=!0,$++;break}if(X)break}}while(X)}function No(E){for(var $=0,X,W,L,H=0;H<z;H++)X=E[H],W=X.site.originalObject,L=e.polygonArea(X),$+=Math.abs(W.targetedArea-L);return $}function To(){switch(Q){case 0:rt=Fn;break;case 1:rt=ko;break;default:console.error("unknown 'handleOverweighted' variant; using variant #1"),rt=Fn}}return j}t.voronoiMapSimulation=P,t.voronoiMapInitialPositionRandom=c,t.voronoiMapInitialPositionPie=d,t.d3VoronoiMapError=w,Object.defineProperty(t,"__esModule",{value:!0})})});var vo=ft((de,xo)=>{"use strict";(function(t,e){typeof de=="object"&&typeof xo<"u"?e(de,mo()):typeof define=="function"&&define.amd?define(["exports","d3-voronoi-map"],e):e(t.d3=t.d3||{},t.d3)})(de,function(t,e){"use strict";function n(){var r=.01,i=50,o=.01,s=Math.random,a=[[0,0],[0,1],[1,1],[1,0]],u=[[0,0],[1,1]],p=[1,1],c=r,d=i,x=o,w=s,P=[{weight:1},{weight:1}],A=e.voronoiMapSimulation(P).stop();function C(F){k(a,F)}C.convergenceRatio=function(F){return arguments.length?(c=F,C):c},C.maxIterationCount=function(F){return arguments.length?(d=F,C):d},C.minWeightRatio=function(F){return arguments.length?(x=F,C):x},C.clip=function(F){return arguments.length?(A.clip(F),a=A.clip(),u=A.extent(),p=A.size(),C):a},C.extent=function(F){return arguments.length?(A.extent(F),a=A.clip(),u=A.extent(),p=A.size(),C):u},C.size=function(F){return arguments.length?(A.size(F),a=A.clip(),u=A.extent(),p=A.size(),C):p},C.prng=function(F){return arguments.length?(w=F,C):w};function k(F,M){var N;if(M.polygon=F,M.height!=0){N=e.voronoiMapSimulation(M.children).clip(F).weight(function(O){return O.value}).convergenceRatio(c).maxIterationCount(d).minWeightRatio(x).prng(w).stop();for(var R=N.state();!R.ended;)N.tick(),R=N.state();R.polygons.forEach(function(O){k(O,O.site.originalObject.data.originalData)})}}return C}t.voronoiTreemap=n,Object.defineProperty(t,"__esModule",{value:!0})})});var Ao=In(pr());Oo();var Co=In(vo());var ea=["*"],Cn=Math.PI/180,na="circle",wo=300,yo=300,bo="asc",ra="desc",ia="white",oa="0px 0px 8px #000000",aa=.1,fa=3,sa=!1,ua=.01,la=.01,ha=50,ca=t=>{switch(t){case"triangle":return 3;case"diamond":return 4;case"square":return 4;case"pentagon":return 5;case"hexagon":return 6;case"heptagon":return 7;case"octagon":return 8;default:return 100}},pa=t=>{switch(t){case"triangle":return 30*Cn;case"square":return 45*Cn;case"pentagon":return 54*Cn;default:return 0}},cl=(()=>{class t{constructor(){this.elementRef=En(Nn),this.sumFunc=J(Pn),this.sort=J(bo),this.labelFunc=J(Hn),this.labelMinRatio=J(aa),this.labelFill=J(ia),this.labelShadow=J(oa),this.labelFontSizeFunc=J(Yn),this.tooltipFunc=J(Gn),this.tapFunc=J(Un),this.fillFunc=J($n),this.fillOpacityFunc=J(Zn),this.strokeFunc=J(Xn),this.strokeWidthFunc=J(Bn),this.padding=J(fa),this.width=J(wo),this.height=J(yo),this.shape=J(na),this.convergenceRatio=J(ua),this.minWeightRatio=J(la),this.maxIterationCount=J(ha),this.data=J.required(),this.flat=J(sa)}render(){let n=Sn(this.elementRef.nativeElement);n.select("svg").remove();let r=this.data();if(!r||!r.children||r.children.length<1)return;let i=this.padding(),o=i*2,s=Wn(this.elementRef,this.width(),this.height(),wo,yo),a=s[0]-o,u=s[1]-o,p=a/2,c=u/2,d=this.sort(),x=d===bo?jn:d===ra?Vn:me,w=l=>{let g=Ln(l).sum(this.sumFunc());return x!==me&&(g=g.sort((m,I)=>x(m,I))),g},P=w(r);if(this.flat()){let l={name:"root",children:[]};for(let g of P.leaves())l.children?.push(g.data);P=w(l)}let A=ca(this.shape()),C=2*Math.PI/A,k=pa(this.shape()),F=Dn(A).map(l=>{let g=k+l*C;return[p+p*Math.cos(g),c+c*Math.sin(g)]});Co.voronoiTreemap().prng((0,Ao.alea)(12345)).convergenceRatio(this.convergenceRatio()).maxIterationCount(this.maxIterationCount()).minWeightRatio(this.minWeightRatio()).clip(F)(P);let N=P.descendants().sort((l,g)=>g.depth-l.depth).map((l,g)=>Object.assign({},l,{id:g})),R=N.filter(l=>!l.children),O=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;for(let l of R)if(l.value){let g=l.value;g<O&&(O=g),g>_&&(_=g)}let V=n.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",a+o).attr("height",u+o).attr("viewBox",`0 0 ${a+o} ${u+o}`);V.append("g").attr("transform",`translate(${i},${i})`).selectAll("path").data(N).enter().append("path").attr("d",l=>"M"+l.polygon.join("L")+"Z").attr("fill",l=>l.children?"transparent":this.fillFunc()(l,O,_)).attr("fill-opacity",l=>l.children?0:this.fillOpacityFunc()(l,P.height)).attr("stroke",l=>this.strokeFunc()(l)).attr("stroke-width",l=>this.strokeWidthFunc()(l)).attr("pointer-events",l=>l.children?"none":"all").on("click",(l,g)=>this.tapFunc()(g)).append("title").text(l=>l.children?"":this.tooltipFunc()(l));let D=O+this.labelMinRatio()*(_-O),f=l=>l.value&&l.value>D?1:0;V.append("g").attr("transform",`translate(${i},${i})`).style("user-select","none").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(R).enter().append("text").attr("transform",l=>"translate("+[l.polygon.site.x,l.polygon.site.y]+")").style("fill",this.labelFill()).style("text-shadow",this.labelShadow()).style("fill-opacity",f).style("font-size",l=>this.labelFontSizeFunc()(l)).selectAll("tspan").data(l=>this.labelFunc()(l).split(/\s+/g)).join("tspan").attr("x",0).attr("y",(l,g,m)=>`${g-m.length/2+.8}em`).text(l=>l)}ngOnChanges(n){this.render()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=On({type:t,selectors:[["mb-voronoi"]],hostBindings:function(r,i){r&1&&Rn("resize",function(){return i.render()},!1,Tn)},inputs:{sumFunc:[1,"sumFunc"],sort:[1,"sort"],labelFunc:[1,"labelFunc"],labelMinRatio:[1,"labelMinRatio"],labelFill:[1,"labelFill"],labelShadow:[1,"labelShadow"],labelFontSizeFunc:[1,"labelFontSizeFunc"],tooltipFunc:[1,"tooltipFunc"],tapFunc:[1,"tapFunc"],fillFunc:[1,"fillFunc"],fillOpacityFunc:[1,"fillOpacityFunc"],strokeFunc:[1,"strokeFunc"],strokeWidthFunc:[1,"strokeWidthFunc"],padding:[1,"padding"],width:[1,"width"],height:[1,"height"],shape:[1,"shape"],convergenceRatio:[1,"convergenceRatio"],minWeightRatio:[1,"minWeightRatio"],maxIterationCount:[1,"maxIterationCount"],data:[1,"data"],flat:[1,"flat"]},features:[kn],ngContentSelectors:ea,decls:1,vars:0,template:function(r,i){r&1&&(qn(),_n(0))},encapsulation:2,changeDetection:0})}}return t})();export{cl as a};
