import{F as T,G as u,Qa as O,c as p,h as f,i as g,k as L}from"./chunk-GDNQNY7K.js";import{o as m}from"./chunk-FM2UNIMX.js";import{Cb as w,Cc as $,Dc as R,Fa as y,Fb as h,Fc as _,Nb as M,Ob as b,Ua as C,Wb as B,Xb as A,ba as n,gb as o,la as x,qb as v,wb as S,xb as D,zc as c}from"./chunk-OH5MFEO2.js";import"./chunk-VOSPIT4N.js";O();var Q=["chart"],H=(()=>{let i=class i{constructor(){this.document=n(x),this.platformId=n(y),this.elementRef=R.required("chart"),this.data=$.required(),this.margin={top:20,bottom:20,left:20,right:20},v({write:()=>{this.createChart(),this.updateChart()}}),c(()=>{this.data(),this.updateChart()})}createChart(){if(!m(this.platformId)||!this.document||this.document===null)return;let a=this.elementRef().nativeElement,e=a.offsetWidth,t=a.offsetHeight;this.width=e-this.margin.left-this.margin.right,this.height=t-this.margin.top-this.margin.bottom;let r=L(a);r.select("svg").remove();let l=r.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",e).attr("height",t).attr("viewBox",`0 0 ${e} ${t}`);this.chart=l.append("g").attr("class","bars").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`);let I=this.data().map(d=>d[0]),q=[0,p(this.data(),d=>d[1])];this.xScale=T().padding(.1).domain(I).rangeRound([0,this.width]),this.yScale=u().domain(q).range([this.height,0]),this.colors=u().domain([0,this.data().length]).range(["green","blue"]),this.xAxis=l.append("g").attr("class","axis axis-x").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.height})`).call(f(this.xScale)),this.yAxis=l.append("g").attr("class","axis axis-y").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).call(g(this.yScale))}updateChart(){if(!m(this.platformId)||!this.document||this.document===null||!this.chart)return;let a=this.data();this.xScale.domain(a.map(t=>t[0])),this.yScale.domain([0,p(a,t=>t[1])]),this.colors.domain([0,a.length]),this.xAxis.transition().call(f(this.xScale)),this.yAxis.transition().call(g(this.yScale));let e=this.chart.selectAll(".bar").data(a);e.exit().remove(),this.chart.selectAll(".bar").transition().attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(t[1])).attr("width",t=>this.xScale.bandwidth()).attr("height",t=>this.height-this.yScale(t[1])).style("fill",(t,r)=>this.colors(r)),e.enter().append("rect").attr("class","bar").attr("x",t=>this.xScale(t[0])).attr("y",t=>this.yScale(0)).attr("width",this.xScale.bandwidth()).attr("height",0).style("fill",(t,r)=>this.colors(r)).transition().delay((t,r)=>r*10).attr("y",t=>this.yScale(t[1])).attr("height",t=>this.height-this.yScale(t[1]))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=o({type:i,selectors:[["app-d3-sample-barchart"]],viewQuery:function(e,t){e&1&&B(t.elementRef,Q,5),e&2&&A()},hostBindings:function(e,t){e&1&&M("resize",function(){return t.createChart()},C)},inputs:{data:[1,"data"]},decls:2,vars:0,consts:[["chart",""],[1,"d3-chart"]],template:function(e,t){e&1&&h(0,"div",1,0)},styles:[".d3-chart[_ngcontent-%COMP%]{width:95%;height:300px;margin:16px}"],changeDetection:0});let s=i;return s})();function j(s,i){if(s&1&&h(0,"app-d3-sample-barchart",0),s&2){let F=b();w("data",F.chartData)}}var X=(()=>{let i=class i{constructor(){this.cdr=n(_),c(()=>{this.generateData()})}generateData(){this.chartData=[];for(let a=0;a<8+Math.floor(Math.random()*50);++a)this.chartData.push([`${a}`,Math.floor(Math.random()*100)]);this.cdr.markForCheck(),setTimeout(()=>{this.generateData()},3e3)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=o({type:i,selectors:[["app-d3-sample-1"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,t){e&1&&S(0,j,1,1,"app-d3-sample-barchart",0),e&2&&D(t.chartData?0:-1)},dependencies:[H],encapsulation:2,changeDetection:0});let s=i;return s})();export{X as Sample1Component};
