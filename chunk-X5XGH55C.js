import{a as R}from"./chunk-S53QGRZ7.js";import{a as w}from"./chunk-M2DMPW5Q.js";import{a as st}from"./chunk-IEKDCRBV.js";import{Ca as et,Da as nt,G as tt,Qa as ft,Y as it,f as Y,g as J,h as Q,i as S,k as Z}from"./chunk-GDNQNY7K.js";import{o as K}from"./chunk-FM2UNIMX.js";import{Aa as F,Cc as f,Fa as $,Nb as G,Pb as b,Qb as q,Ua as P,ba as D,gb as X,la as W,qb as j,zc as A}from"./chunk-OH5MFEO2.js";import{a as I}from"./chunk-VOSPIT4N.js";ft();var mt=["*"],ht={fillColor:void 0,strokeColor:"steelblue",strokeWidth:1,interpolation:"natural"},dt="natural",ut=new Date(-864e13),pt=new Date(864e13),ot=300,rt=100,at=60,O=30,v=50,y=18,vt=(()=>{let M=class M{constructor(){this.elementRef=D(F),this.document=D(W),this.platformId=D($),this.currentConfiguration=[],this.currentData=[],this.currentDataEmpty=!0,this.width=f(ot),this.height=f(rt),this.configuration=f.required(),this.timeAxis=f([]),this.valueAxis=f([]),this.min=f(),this.max=f(),this.from=f(),this.till=f(),this.data=f.required(),A(()=>{this.forcedValueMin=this.min()}),A(()=>{this.forcedValueMax=this.max()}),A(()=>{this.forcedTimeMin=this.from()}),A(()=>{this.forcedTimeMax=this.till()}),A(()=>{let i=this.data(),e=pt,a=ut,o=1/0,t=-1/0,d=!0;for(let c of i){let m=c.length;if(m<1)continue;d=!1,e>c[0].time&&(e=c[0].time),a<c[m-1].time&&(a=c[m-1].time);let E=R(c);for(let k of c){let u=E(k);isNaN(u)||(o>u&&(o=u),t<u&&(t=u))}}this.currentDataEmpty=d,this.dataTimeMin=e,this.dataTimeMax=a,this.dataValueMin=o,this.dataValueMax=t,this.currentData=i,this.render()}),A(()=>{let i=this.configuration();if(i&&i!=null&&i.length>0){let e=i.length,a=this.currentConfiguration.length;if(a>0){let o=Math.min(e,a);for(let t=0;t<o;++t)this.currentConfiguration[t]=I(I({},this.currentConfiguration[t]),i[t]);if(e>o)for(let t=o;t<e;++t)this.currentConfiguration[t]=I({},i[t])}else this.currentConfiguration=[...i]}this.render()}),j(()=>{this.render()})}render(){if(!K(this.platformId)||!this.document||this.document===null)return;let i=this.currentData;if(this.currentDataEmpty||!i||i===null||i.length<1)return;let e=Z(this.elementRef.nativeElement);if(!e||e===null)return;e.select("svg").remove();let a=this.currentConfiguration,o=this.timeAxis().includes("top"),t=this.timeAxis().includes("bottom"),d=this.valueAxis().includes("left"),c=this.valueAxis().includes("right"),m=this.valueAxis().includes("grid"),E=d||m?v:o||t?v/3:0,k=c?v:o||t?v/3:0,u=o?y:d||c||m?y/3:0,B=t?y:d||c||m?y/3:0,H=st(this.elementRef,this.width(),this.height(),ot,rt),g=H[0],x=H[1],T=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",g).attr("height",x).attr("viewBox",`0 0 ${g} ${x}`),L=this.forcedTimeMin===void 0?this.dataTimeMin:this.forcedTimeMin,V=this.forcedTimeMax===void 0?this.dataTimeMax:this.forcedTimeMax,C=it().range([E,g-k]).domain([L,V]);if(o){C.nice();let n=r=>r.attr("font-family","sans-serif").attr("font-size",10).attr("fill","none").attr("transform",`translate(0,${u})`).call(Y(C).ticks(g/at).tickSizeOuter(0));T.append("g").call(n)}if(t){C.nice();let n=r=>r.attr("font-family","sans-serif").attr("font-size",10).attr("fill","none").attr("transform",`translate(0,${x-B})`).call(Q(C).ticks(g/at).tickSizeOuter(0));T.append("g").call(n)}let z=this.forcedValueMin===void 0?this.dataValueMin:this.forcedValueMin,ct=this.forcedValueMax===void 0?this.dataValueMax:this.forcedValueMax,h=tt().domain([z,ct]).range([x-B,u]);if(d&&!m){h.nice();let n=r=>r.attr("transform",`translate(${E},0)`).call(S(h).ticks(x/O).tickSizeOuter(0));T.append("g").call(n)}if(c){h.nice();let n=r=>r.attr("transform",`translate(${g-k},0)`).call(J(h).ticks(x/O).tickSizeOuter(0));T.append("g").call(n)}if(m){h.nice();let n=r=>r.attr("transform",`translate(${E},0)`).call(S(h).ticks(x/O).tickSizeOuter(0)).call(p=>{d||p.select(".domain").remove()}).call(p=>p.selectAll(t?".tick:not(:first-of-type) line":".tick line").clone().attr("x2",g-E-k).attr("stroke","currentColor").attr("stroke-width",.3));T.append("g").call(n)}let lt=a.length;for(let n=0;n<i.length;++n){let r=i[n],p=R(r),l=n<lt?a[n]:ht,U=l.interpolation?l.interpolation:dt;if(l.fillColor&&l.fillColor!=="none"){let N=nt().curve(w(U)).defined(s=>!isNaN(p(s))&&s.time>=L&&s.time<=V).x(s=>C(s.time)).y0(()=>h(z)).y1(s=>h(p(s)));T.append("path").datum(r).attr("fill",l.fillColor).attr("d",N)}if(l.strokeColor&&l.strokeWidth&&l.strokeWidth>0&&l.strokeColor!=="none"){let N=et().curve(w(U)).defined(s=>!isNaN(p(s))&&s.time>=L&&s.time<=V).x(s=>C(s.time)).y(s=>h(p(s)));T.append("path").datum(r).attr("stroke-width",l.strokeWidth).attr("stroke",l.strokeColor).attr("stroke-linejoin","round").attr("stroke-linecap","round").style("fill","none").attr("d",N)}}}};M.\u0275fac=function(e){return new(e||M)},M.\u0275cmp=X({type:M,selectors:[["mb-multiline"]],hostBindings:function(e,a){e&1&&G("resize",function(){return a.render()},P)},inputs:{width:[1,"width"],height:[1,"height"],configuration:[1,"configuration"],timeAxis:[1,"timeAxis"],valueAxis:[1,"valueAxis"],min:[1,"min"],max:[1,"max"],from:[1,"from"],till:[1,"till"],data:[1,"data"]},ngContentSelectors:mt,decls:1,vars:0,template:function(e,a){e&1&&(b(),q(0))},encapsulation:2,changeDetection:0});let _=M;return _})();export{vt as a};
