import{c as Un,g as Xn}from"./chunk-CGVYBZUD.js";import{$ as $n,C as Bn,a as Wn,d as me,e as Pn,f as jn,g as Hn,ha as Zn,j as Vn,l as Gn}from"./chunk-JEPWSQCW.js";import{a as Ln}from"./chunk-IEKDCRBV.js";import{Qa as To,e as Dn,k as Sn,x as _n}from"./chunk-GDNQNY7K.js";import{Aa as kn,Cc as J,Nb as On,Pb as Rn,Qb as qn,Ua as Nn,ba as zn,gb as Tn,xa as En}from"./chunk-OH5MFEO2.js";import{d as y,e as ft,f as Tt,g as In,h as Ot}from"./chunk-VOSPIT4N.js";var Jn=ft((Yn,xe)=>{"use strict";(function(t,e,r){function n(a){var u=this,p=s();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=p(" "),u.s1=p(" "),u.s2=p(" "),u.s0-=p(a),u.s0<0&&(u.s0+=1),u.s1-=p(a),u.s1<0&&(u.s1+=1),u.s2-=p(a),u.s2<0&&(u.s2+=1),p=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function o(a,u){var p=new n(a),h=u&&u.state,d=p.next;return d.int32=function(){return p.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,p),d.state=function(){return i(p,{})}),d}function s(){var a=4022871197,u=function(p){p=String(p);for(var h=0;h<p.length;h++){a+=p.charCodeAt(h);var d=.02519603282416938*a;a=d>>>0,d-=a,d*=a,a=d>>>0,d-=a,a+=d*4294967296}return(a>>>0)*23283064365386963e-26};return u}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(Yn,typeof xe=="object"&&xe,typeof define=="function"&&define)});var Qn=ft((Kn,ve)=>{"use strict";(function(t,e,r){function n(s){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var h=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^h^h>>>8},s===(s|0)?a.x=s:u+=s;for(var p=0;p<u.length+64;p++)a.x^=u.charCodeAt(p)|0,a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a}function o(s,a){var u=new n(s),p=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,p&&(typeof p=="object"&&i(p,u),h.state=function(){return i(u,{})}),h}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(Kn,typeof ve=="object"&&ve,typeof define=="function"&&define)});var er=ft((tr,we)=>{"use strict";(function(t,e,r){function n(s){var a=this,u="";a.next=function(){var h=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(h^h<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,s===(s|0)?a.x=s:u+=s;for(var p=0;p<u.length+64;p++)a.x^=u.charCodeAt(p)|0,p==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a.v=s.v,a.d=s.d,a}function o(s,a){var u=new n(s),p=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,p&&(typeof p=="object"&&i(p,u),h.state=function(){return i(u,{})}),h}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(tr,typeof we=="object"&&we,typeof define=="function"&&define)});var rr=ft((nr,ye)=>{"use strict";(function(t,e,r){function n(s){var a=this;a.next=function(){var p=a.x,h=a.i,d,x,w;return d=p[h],d^=d>>>7,x=d^d<<24,d=p[h+1&7],x^=d^d>>>10,d=p[h+3&7],x^=d^d>>>3,d=p[h+4&7],x^=d^d<<7,d=p[h+7&7],d=d^d<<13,x^=d^d<<9,p[h]=x,a.i=h+1&7,x};function u(p,h){var d,x,w=[];if(h===(h|0))x=w[0]=h;else for(h=""+h,d=0;d<h.length;++d)w[d&7]=w[d&7]<<15^h.charCodeAt(d)+w[d+1&7]<<13;for(;w.length<8;)w.push(0);for(d=0;d<8&&w[d]===0;++d);for(d==8?x=w[7]=-1:x=w[d],p.x=w,p.i=0,d=256;d>0;--d)p.next()}u(a,s)}function i(s,a){return a.x=s.x.slice(),a.i=s.i,a}function o(s,a){s==null&&(s=+new Date);var u=new n(s),p=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,p&&(p.x&&i(p,u),h.state=function(){return i(u,{})}),h}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(nr,typeof ye=="object"&&ye,typeof define=="function"&&define)});var or=ft((ir,be)=>{"use strict";(function(t,e,r){function n(s){var a=this;a.next=function(){var p=a.w,h=a.X,d=a.i,x,w;return a.w=p=p+1640531527|0,w=h[d+34&127],x=h[d=d+1&127],w^=w<<13,x^=x<<17,w^=w>>>15,x^=x>>>12,w=h[d]=w^x,a.i=d,w+(p^p>>>16)|0};function u(p,h){var d,x,w,G,A,M=[],k=128;for(h===(h|0)?(x=h,h=null):(h=h+"\0",x=0,k=Math.max(k,h.length)),w=0,G=-32;G<k;++G)h&&(x^=h.charCodeAt((G+32)%h.length)),G===0&&(A=x),x^=x<<10,x^=x>>>15,x^=x<<4,x^=x>>>13,G>=0&&(A=A+1640531527|0,d=M[G&127]^=x+A,w=d==0?w+1:0);for(w>=128&&(M[(h&&h.length||0)&127]=-1),w=127,G=4*128;G>0;--G)x=M[w+34&127],d=M[w=w+1&127],x^=x<<13,d^=d<<17,x^=x>>>15,d^=d>>>12,M[w]=x^d;p.w=A,p.X=M,p.i=w}u(a,s)}function i(s,a){return a.i=s.i,a.w=s.w,a.X=s.X.slice(),a}function o(s,a){s==null&&(s=+new Date);var u=new n(s),p=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,p&&(p.X&&i(p,u),h.state=function(){return i(u,{})}),h}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(ir,typeof be=="object"&&be,typeof define=="function"&&define)});var fr=ft((ar,Ae)=>{"use strict";(function(t,e,r){function n(s){var a=this,u="";a.next=function(){var h=a.b,d=a.c,x=a.d,w=a.a;return h=h<<25^h>>>7^d,d=d-x|0,x=x<<24^x>>>8^w,w=w-h|0,a.b=h=h<<20^h>>>12^d,a.c=d=d-x|0,a.d=x<<16^d>>>16^w,a.a=w-h|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,s===Math.floor(s)?(a.a=s/4294967296|0,a.b=s|0):u+=s;for(var p=0;p<u.length+20;p++)a.b^=u.charCodeAt(p)|0,a.next()}function i(s,a){return a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a}function o(s,a){var u=new n(s),p=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,x=(u.next()>>>0)/4294967296,w=(d+x)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,p&&(typeof p=="object"&&i(p,u),h.state=function(){return i(u,{})}),h}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(ar,typeof Ae=="object"&&Ae,typeof define=="function"&&define)});var sr=ft(()=>{"use strict"});var lr=ft((ur,Zt)=>{"use strict";(function(t,e,r){var n=256,i=6,o=52,s="random",a=r.pow(n,i),u=r.pow(2,o),p=u*2,h=n-1,d;function x(C,N,O){var R=[];N=N==!0?{entropy:!0}:N||{};var D=M(A(N.entropy?[C,I(e)]:C??k(),3),R),P=new w(R),$=function(){for(var L=P.g(i),f=a,l=0;L<u;)L=(L+l)*n,f*=n,l=P.g(1);for(;L>=p;)L/=2,f/=2,l>>>=1;return(L+l)/f};return $.int32=function(){return P.g(4)|0},$.quick=function(){return P.g(4)/4294967296},$.double=$,M(I(P.S),e),(N.pass||O||function(L,f,l,g){return g&&(g.S&&G(g,P),L.state=function(){return G(P,{})}),l?(r[s]=L,f):L})($,D,"global"in N?N.global:this==r,N.state)}function w(C){var N,O=C.length,R=this,D=0,P=R.i=R.j=0,$=R.S=[];for(O||(C=[O++]);D<n;)$[D]=D++;for(D=0;D<n;D++)$[D]=$[P=h&P+C[D%O]+(N=$[D])],$[P]=N;(R.g=function(L){for(var f,l=0,g=R.i,c=R.j,m=R.S;L--;)f=m[g=h&g+1],l=l*n+m[h&(m[g]=m[c=h&c+f])+(m[c]=f)];return R.i=g,R.j=c,l})(n)}function G(C,N){return N.i=C.i,N.j=C.j,N.S=C.S.slice(),N}function A(C,N){var O=[],R=typeof C,D;if(N&&R=="object")for(D in C)try{O.push(A(C[D],N-1))}catch{}return O.length?O:R=="string"?C:C+"\0"}function M(C,N){for(var O=C+"",R,D=0;D<O.length;)N[h&D]=h&(R^=N[h&D]*19)+O.charCodeAt(D++);return I(N)}function k(){try{var C;return d&&(C=d.randomBytes)?C=C(n):(C=new Uint8Array(n),(t.crypto||t.msCrypto).getRandomValues(C)),I(C)}catch{var N=t.navigator,O=N&&N.plugins;return[+new Date,t,O,t.screen,I(e)]}}function I(C){return String.fromCharCode.apply(0,C)}if(M(r.random(),e),typeof Zt=="object"&&Zt.exports){Zt.exports=x;try{d=sr()}catch{}}else typeof define=="function"&&define.amd?define(function(){return x}):r["seed"+s]=x})(typeof self<"u"?self:ur,[],Math)});var cr=ft((ga,hr)=>{"use strict";var Oo=Jn(),Ro=Qn(),qo=er(),Do=rr(),So=or(),_o=fr(),gt=lr();gt.alea=Oo;gt.xor128=Ro;gt.xorwow=qo;gt.xorshift7=Do;gt.xor4096=So;gt.tychei=_o;hr.exports=gt});function pr(t){for(var e=-1,r=t.length,n,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2}var dr=y(()=>{"use strict"});function gr(t){for(var e=-1,r=t.length,n=0,i=0,o,s=t[r-1],a,u=0;++e<r;)o=s,s=t[e],u+=a=o[0]*s[1]-s[0]*o[1],n+=(o[0]+s[0])*a,i+=(o[1]+s[1])*a;return u*=3,[n/u,i/u]}var mr=y(()=>{"use strict"});function xr(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}var vr=y(()=>{"use strict"});function Lo(t,e){return t[0]-e[0]||t[1]-e[1]}function wr(t){let e=t.length,r=[0,1],n=2,i;for(i=2;i<e;++i){for(;n>1&&xr(t[r[n-2]],t[r[n-1]],t[i])<=0;)--n;r[n++]=i}return r.slice(0,n)}function yr(t){if((r=t.length)<3)return null;var e,r,n=new Array(r),i=new Array(r);for(e=0;e<r;++e)n[e]=[+t[e][0],+t[e][1],e];for(n.sort(Lo),e=0;e<r;++e)i[e]=[n[e][0],-n[e][1]];var o=wr(n),s=wr(i),a=s[0]===o[0],u=s[s.length-1]===o[o.length-1],p=[];for(e=o.length-1;e>=0;--e)p.push(t[n[o[e]][2]]);for(e=+a;e<s.length-u;++e)p.push(t[n[s[e]][2]]);return p}var br=y(()=>{"use strict";vr()});function Ar(t,e){for(var r=t.length,n=t[r-1],i=e[0],o=e[1],s=n[0],a=n[1],u,p,h=!1,d=0;d<r;++d)n=t[d],u=n[0],p=n[1],p>o!=a>o&&i<(s-u)*(o-p)/(a-p)+u&&(h=!h),s=u,a=p;return h}var Mr=y(()=>{"use strict"});function Cr(t){for(var e=-1,r=t.length,n=t[r-1],i,o,s=n[0],a=n[1],u=0;++e<r;)i=s,o=a,n=t[e],s=n[0],a=n[1],i-=s,o-=a,u+=Math.hypot(i,o);return u}var Fr=y(()=>{"use strict"});var Ir={};Tt(Ir,{polygonArea:()=>pr,polygonCentroid:()=>gr,polygonContains:()=>Ar,polygonHull:()=>yr,polygonLength:()=>Cr});var zr=y(()=>{"use strict";dr();mr();br();Mr();Fr()});function At(){return mt||(Nr(Wo),mt=St.now()+Kt)}function Wo(){mt=0}function xt(){this._call=this._time=this._next=null}function Ce(t,e,r){var n=new xt;return n.restart(t,e,r),n}function Fe(){At(),++bt;for(var t=Yt,e;t;)(e=mt-t._time)>=0&&t._call.call(null,e),t=t._next;--bt}function Er(){mt=(Jt=St.now())+Kt,bt=qt=0;try{Fe()}finally{bt=0,jo(),mt=0}}function Po(){var t=St.now(),e=t-Jt;e>kr&&(Kt-=e,Jt=t)}function jo(){for(var t,e=Yt,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Yt=r);Dt=t,Me(n)}function Me(t){if(!bt){qt&&(qt=clearTimeout(qt));var e=t-mt;e>24?(t<1/0&&(qt=setTimeout(Er,t-St.now()-Kt)),Rt&&(Rt=clearInterval(Rt))):(Rt||(Jt=St.now(),Rt=setInterval(Po,kr)),bt=1,Nr(Er))}}var bt,qt,Rt,kr,Yt,Dt,Jt,mt,Kt,St,Nr,Qt=y(()=>{"use strict";bt=0,qt=0,Rt=0,kr=1e3,Jt=0,mt=0,Kt=0,St=typeof performance=="object"&&performance.now?performance:Date,Nr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};xt.prototype=Ce.prototype={constructor:xt,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?At():+r)+(e==null?0:+e),!this._next&&Dt!==this&&(Dt?Dt._next=this:Yt=this,Dt=this),this._call=t,this._time=r,Me()},stop:function(){this._call&&(this._call=null,this._time=1/0,Me())}}});function Tr(t,e,r){var n=new xt;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var Or=y(()=>{"use strict";Qt()});function Rr(t,e,r){var n=new xt,i=e;return e==null?(n.restart(t,e,r),n):(n._restart=n.restart,n.restart=function(o,s,a){s=+s,a=a==null?At():+a,n._restart(function u(p){p+=i,n._restart(u,i+=s,a),o(p)},s,a)},n.restart(t,e,r),n)}var qr=y(()=>{"use strict";Qt()});var Dr={};Tt(Dr,{interval:()=>Rr,now:()=>At,timeout:()=>Tr,timer:()=>Ce,timerFlush:()=>Fe});var Sr=y(()=>{"use strict";Qt();Or();qr()});function Lr(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new te(r)}function te(t){this._=t}function Vo(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}function Go(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function _r(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=Ho,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var Ho,Wr,Pr=y(()=>{"use strict";Ho={value:()=>{}};te.prototype=Lr.prototype={constructor:te,on:function(t,e){var r=this._,n=Vo(t+"",r),i,o=-1,s=n.length;if(arguments.length<2){for(;++o<s;)if((i=(t=n[o]).type)&&(i=Go(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=n[o]).type)r[i]=_r(r[i],t.name,e);else if(e==null)for(i in r)r[i]=_r(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new te(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],n=0,i=o.length;n<i;++n)o[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};Wr=Lr});var jr={};Tt(jr,{dispatch:()=>Wr});var Hr=y(()=>{"use strict";Pr()});function B(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ut=y(()=>{"use strict"});function _t(t){let e=t,r=t;t.length===1&&(e=(s,a)=>t(s)-a,r=Uo(t));function n(s,a,u,p){for(u==null&&(u=0),p==null&&(p=s.length);u<p;){let h=u+p>>>1;r(s[h],a)<0?u=h+1:p=h}return u}function i(s,a,u,p){for(u==null&&(u=0),p==null&&(p=s.length);u<p;){let h=u+p>>>1;r(s[h],a)>0?p=h:u=h+1}return u}function o(s,a,u,p){u==null&&(u=0),p==null&&(p=s.length);let h=n(s,a,u,p-1);return h>u&&e(s[h-1],a)>-e(s[h],a)?h-1:h}return{left:n,center:o,right:i}}function Uo(t){return(e,r)=>B(t(e),r)}var Ie=y(()=>{"use strict";ut()});function ee(t){return t===null?NaN:+t}function*Vr(t,e){if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of t)(n=e(n,++r,t))!=null&&(n=+n)>=n&&(yield n)}}var ze=y(()=>{"use strict"});var Gr,Ee,Ur,Xr,ne,ke=y(()=>{"use strict";ut();Ie();ze();Gr=_t(B),Ee=Gr.right,Ur=Gr.left,Xr=_t(ee).center,ne=Ee});function lt(t,e){let r=0;if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&++r;else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(i=+i)>=i&&++r}return r}var Lt=y(()=>{"use strict"});function Xo(t){return t.length|0}function Bo(t){return!(t>0)}function $o(t){return typeof t!="object"||"length"in t?t:Array.from(t)}function Zo(t){return e=>t(...e)}function Ne(...t){let e=typeof t[t.length-1]=="function"&&Zo(t.pop());t=t.map($o);let r=t.map(Xo),n=t.length-1,i=new Array(n+1).fill(0),o=[];if(n<0||r.some(Bo))return o;for(;;){o.push(i.map((a,u)=>t[u][a]));let s=n;for(;++i[s]===r[s];){if(s===0)return e?o.map(e):o;i[s--]=0}}}var Br=y(()=>{"use strict"});function Te(t,e){var r=0,n=0;return Float64Array.from(t,e===void 0?i=>r+=+i||0:i=>r+=+e(i,n++,t)||0)}var $r=y(()=>{"use strict"});function Zr(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}var Yr=y(()=>{"use strict"});function Wt(t,e){let r=0,n,i=0,o=0;if(e===void 0)for(let s of t)s!=null&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i));else{let s=-1;for(let a of t)(a=e(a,++s,t))!=null&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}var Oe=y(()=>{"use strict"});function Pt(t,e){let r=Wt(t,e);return r&&Math.sqrt(r)}var Re=y(()=>{"use strict";Oe()});function Mt(t,e){let r,n;if(e===void 0)for(let i of t)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(r===void 0?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}var qe=y(()=>{"use strict"});function Jr(t,e){let r=new Ct;if(e===void 0)for(let n of t)(n=+n)&&r.add(n);else{let n=-1;for(let i of t)(i=+e(i,++n,t))&&r.add(i)}return+r}function Kr(t,e){let r=new Ct,n=-1;return Float64Array.from(t,e===void 0?i=>r.add(+i||0):i=>r.add(+e(i,++n,t)||0))}var Ct,Qr=y(()=>{"use strict";Ct=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let r=this._partials,n=0;for(let i=0;i<this._n&&i<32;i++){let o=r[i],s=e+o,a=Math.abs(e)<Math.abs(o)?e-(s-o):o-(s-e);a&&(r[n++]=a),e=s}return r[n]=e,this._n=n+1,this}valueOf(){let e=this._partials,r=this._n,n,i,o,s=0;if(r>0){for(s=e[--r];r>0&&(n=s,i=e[--r],s=n+i,o=i-(s-n),!o););r>0&&(o<0&&e[r-1]<0||o>0&&e[r-1]>0)&&(i=o*2,n=s+i,i==n-s&&(s=n))}return s}}});function De({_intern:t,_key:e},r){let n=e(r);return t.has(n)?t.get(n):r}function ti({_intern:t,_key:e},r){let n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function ei({_intern:t,_key:e},r){let n=e(r);return t.has(n)&&(r=t.get(r),t.delete(n)),r}function ni(t){return t!==null&&typeof t=="object"?t.valueOf():t}var Ft,re,Se=y(()=>{"use strict";Ft=class extends Map{constructor(e,r=ni){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(let[n,i]of e)this.set(n,i)}get(e){return super.get(De(this,e))}has(e){return super.has(De(this,e))}set(e,r){return super.set(ti(this,e),r)}delete(e){return super.delete(ei(this,e))}},re=class extends Set{constructor(e,r=ni){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(let n of e)this.add(n)}has(e){return super.has(De(this,e))}add(e){return super.add(ti(this,e))}delete(e){return super.delete(ei(this,e))}}});function ht(t){return t}var _e=y(()=>{"use strict"});function jt(t,...e){return It(t,ht,ht,e)}function ri(t,...e){return It(t,Array.from,ht,e)}function ie(t,e,...r){return It(t,ht,e,r)}function ii(t,e,...r){return It(t,Array.from,e,r)}function oi(t,...e){return It(t,ht,fi,e)}function ai(t,...e){return It(t,Array.from,fi,e)}function fi(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function It(t,e,r,n){return function i(o,s){if(s>=n.length)return r(o);let a=new Ft,u=n[s++],p=-1;for(let h of o){let d=u(h,++p,o),x=a.get(d);x?x.push(h):a.set(d,[h])}for(let[h,d]of a)a.set(h,i(d,s));return e(a)}(t,0)}var Le=y(()=>{"use strict";Se();_e()});function oe(t,e){return Array.from(e,r=>t[r])}var We=y(()=>{"use strict"});function zt(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[r=B]=e;if(r.length===1||e.length>1){let n=Uint32Array.from(t,(i,o)=>o);return e.length>1?(e=e.map(i=>t.map(i)),n.sort((i,o)=>{for(let s of e){let a=B(s[i],s[o]);if(a)return a}})):(r=t.map(r),n.sort((i,o)=>B(r[i],r[o]))),oe(t,n)}return t.sort(r)}var Pe=y(()=>{"use strict";ut();We()});function je(t,e,r){return(e.length===1?zt(ie(t,e,r),([n,i],[o,s])=>B(i,s)||B(n,o)):zt(jt(t,r),([n,i],[o,s])=>e(i,s)||B(n,o))).map(([n])=>n)}var si=y(()=>{"use strict";ut();Le();Pe()});var ui,li,gf,hi=y(()=>{"use strict";ui=Array.prototype,li=ui.slice,gf=ui.map});function Ht(t){return function(){return t}}var ci=y(()=>{"use strict"});function ae(t,e,r){var n,i=-1,o,s,a;if(e=+e,t=+t,r=+r,t===e&&r>0)return[t];if((n=e<t)&&(o=t,t=e,e=o),(a=vt(t,e,r))===0||!isFinite(a))return[];if(a>0){let u=Math.round(t/a),p=Math.round(e/a);for(u*a<t&&++u,p*a>e&&--p,s=new Array(o=p-u+1);++i<o;)s[i]=(u+i)*a}else{a=-a;let u=Math.round(t*a),p=Math.round(e*a);for(u/a<t&&++u,p/a>e&&--p,s=new Array(o=p-u+1);++i<o;)s[i]=(u+i)/a}return n&&s.reverse(),s}function vt(t,e,r){var n=(e-t)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,i);return i>=0?(o>=He?10:o>=Ve?5:o>=Ge?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=He?10:o>=Ve?5:o>=Ge?2:1)}function pi(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=He?i*=10:o>=Ve?i*=5:o>=Ge&&(i*=2),e<t?-i:i}var He,Ve,Ge,fe=y(()=>{"use strict";He=Math.sqrt(50),Ve=Math.sqrt(10),Ge=Math.sqrt(2)});function Vt(t,e,r){let n;for(;;){let i=vt(t,e,r);if(i===n||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),n=i}}var Ue=y(()=>{"use strict";fe()});function se(t){return Math.ceil(Math.log(lt(t))/Math.LN2)+1}var Xe=y(()=>{"use strict";Lt()});function Be(){var t=ht,e=Mt,r=se;function n(i){Array.isArray(i)||(i=Array.from(i));var o,s=i.length,a,u=new Array(s);for(o=0;o<s;++o)u[o]=t(i[o],o,i);var p=e(u),h=p[0],d=p[1],x=r(u,h,d);if(!Array.isArray(x)){let M=d,k=+x;if(e===Mt&&([h,d]=Vt(h,d,k)),x=ae(h,d,k),x[x.length-1]>=d)if(M>=d&&e===Mt){let I=vt(h,d,k);isFinite(I)&&(I>0?d=(Math.floor(d/I)+1)*I:I<0&&(d=(Math.ceil(d*-I)+1)/-I))}else x.pop()}for(var w=x.length;x[0]<=h;)x.shift(),--w;for(;x[w-1]>d;)x.pop(),--w;var G=new Array(w+1),A;for(o=0;o<=w;++o)A=G[o]=[],A.x0=o>0?x[o-1]:h,A.x1=o<w?x[o]:d;for(o=0;o<s;++o)a=u[o],h<=a&&a<=d&&G[ne(x,a,0,w)].push(i[o]);return G}return n.value=function(i){return arguments.length?(t=typeof i=="function"?i:Ht(i),n):t},n.domain=function(i){return arguments.length?(e=typeof i=="function"?i:Ht([i[0],i[1]]),n):e},n.thresholds=function(i){return arguments.length?(r=typeof i=="function"?i:Array.isArray(i)?Ht(li.call(i)):Ht(i),n):r},n}var di=y(()=>{"use strict";hi();ke();ci();qe();_e();Ue();fe();Xe()});function Et(t,e){let r;if(e===void 0)for(let n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}var $e=y(()=>{"use strict"});function ct(t,e){let r;if(e===void 0)for(let n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}var ue=y(()=>{"use strict"});function kt(t,e,r=0,n=t.length-1,i=B){for(;n>r;){if(n-r>600){let u=n-r+1,p=e-r+1,h=Math.log(u),d=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*d*(u-d)/u)*(p-u/2<0?-1:1),w=Math.max(r,Math.floor(e-p*d/u+x)),G=Math.min(n,Math.floor(e+(u-p)*d/u+x));kt(t,e,w,G,i)}let o=t[e],s=r,a=n;for(Gt(t,r,e),i(t[n],o)>0&&Gt(t,r,n);s<a;){for(Gt(t,s,a),++s,--a;i(t[s],o)<0;)++s;for(;i(t[a],o)>0;)--a}i(t[r],o)===0?Gt(t,r,a):(++a,Gt(t,a,n)),a<=e&&(r=a+1),e<=a&&(n=a-1)}return t}function Gt(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}var Ze=y(()=>{"use strict";ut()});function pt(t,e,r){if(t=Float64Array.from(Vr(t,r)),!!(n=t.length)){if((e=+e)<=0||n<2)return ct(t);if(e>=1)return Et(t);var n,i=(n-1)*e,o=Math.floor(i),s=Et(kt(t,o).subarray(0,o+1)),a=ct(t.subarray(o+1));return s+(a-s)*(i-o)}}function gi(t,e,r=ee){if(n=t.length){if((e=+e)<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,o=Math.floor(i),s=+r(t[o],o,t),a=+r(t[o+1],o+1,t);return s+(a-s)*(i-o)}}var le=y(()=>{"use strict";$e();ue();Ze();ze()});function mi(t,e,r){return Math.ceil((r-e)/(2*(pt(t,.75)-pt(t,.25))*Math.pow(lt(t),-1/3)))}var xi=y(()=>{"use strict";Lt();le()});function vi(t,e,r){return Math.ceil((r-e)/(3.5*Pt(t)*Math.pow(lt(t),-1/3)))}var wi=y(()=>{"use strict";Lt();Re()});function Ut(t,e){let r,n=-1,i=-1;if(e===void 0)for(let o of t)++i,o!=null&&(r<o||r===void 0&&o>=o)&&(r=o,n=i);else for(let o of t)(o=e(o,++i,t))!=null&&(r<o||r===void 0&&o>=o)&&(r=o,n=i);return n}var Ye=y(()=>{"use strict"});function Je(t,e){let r=0,n=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++r,n+=i);else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(o=+o)>=o&&(++r,n+=o)}if(r)return n/r}var yi=y(()=>{"use strict"});function bi(t,e){return pt(t,.5,e)}var Ai=y(()=>{"use strict";le()});function*Yo(t){for(let e of t)yield*e}function Ke(t){return Array.from(Yo(t))}var Mi=y(()=>{"use strict"});function Xt(t,e){let r,n=-1,i=-1;if(e===void 0)for(let o of t)++i,o!=null&&(r>o||r===void 0&&o>=o)&&(r=o,n=i);else for(let o of t)(o=e(o,++i,t))!=null&&(r>o||r===void 0&&o>=o)&&(r=o,n=i);return n}var Qe=y(()=>{"use strict"});function tn(t,e=Jo){let r=[],n,i=!1;for(let o of t)i&&r.push(e(n,o)),n=o,i=!0;return r}function Jo(t,e){return[t,e]}var Ci=y(()=>{"use strict"});function Fi(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,o=new Array(i);++n<i;)o[n]=t+n*r;return o}var Ii=y(()=>{"use strict"});function en(t,e=B){let r,n=!1;if(e.length===1){let i;for(let o of t){let s=e(o);(n?B(s,i)<0:B(s,s)===0)&&(r=o,i=s,n=!0)}}else for(let i of t)(n?e(i,r)<0:e(i,i)===0)&&(r=i,n=!0);return r}var zi=y(()=>{"use strict";ut()});function Bt(t,e=B){if(e.length===1)return Xt(t,e);let r,n=-1,i=-1;for(let o of t)++i,(n<0?e(o,o)===0:e(o,r)<0)&&(r=o,n=i);return n}var nn=y(()=>{"use strict";ut();Qe()});function rn(t,e=B){let r,n=!1;if(e.length===1){let i;for(let o of t){let s=e(o);(n?B(s,i)>0:B(s,s)===0)&&(r=o,i=s,n=!0)}}else for(let i of t)(n?e(i,r)>0:e(i,i)===0)&&(r=i,n=!0);return r}var Ei=y(()=>{"use strict";ut()});function on(t,e=B){if(e.length===1)return Ut(t,e);let r,n=-1,i=-1;for(let o of t)++i,(n<0?e(o,o)===0:e(o,r)>0)&&(r=o,n=i);return n}var ki=y(()=>{"use strict";ut();Ye()});function an(t,e){let r=Bt(t,e);return r<0?void 0:r}var Ni=y(()=>{"use strict";nn()});function fn(t){return function(r,n=0,i=r.length){let o=i-(n=+n);for(;o;){let s=t()*o--|0,a=r[o+n];r[o+n]=r[s+n],r[s+n]=a}return r}}var Ti,Oi=y(()=>{"use strict";Ti=fn(Math.random)});function sn(t,e){let r=0;if(e===void 0)for(let n of t)(n=+n)&&(r+=n);else{let n=-1;for(let i of t)(i=+e(i,++n,t))&&(r+=i)}return r}var Ri=y(()=>{"use strict"});function he(t){if(!(o=t.length))return[];for(var e=-1,r=ct(t,Ko),n=new Array(r);++e<r;)for(var i=-1,o,s=n[e]=new Array(o);++i<o;)s[i]=t[i][e];return n}function Ko(t){return t.length}var un=y(()=>{"use strict";ue()});function qi(){return he(arguments)}var Di=y(()=>{"use strict";un()});function ln(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let r=-1;for(let n of t)if(!e(n,++r,t))return!1;return!0}var Si=y(()=>{"use strict"});function hn(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let r=-1;for(let n of t)if(e(n,++r,t))return!0;return!1}var _i=y(()=>{"use strict"});function cn(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let r=[],n=-1;for(let i of t)e(i,++n,t)&&r.push(i);return r}var Li=y(()=>{"use strict"});function pn(t,e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof e!="function")throw new TypeError("mapper is not a function");return Array.from(t,(r,n)=>e(r,n,t))}var Wi=y(()=>{"use strict"});function dn(t,e,r){if(typeof e!="function")throw new TypeError("reducer is not a function");let n=t[Symbol.iterator](),i,o,s=-1;if(arguments.length<3){if({done:i,value:r}=n.next(),i)return;++s}for(;{done:i,value:o}=n.next(),!i;)r=e(r,o,++s,t);return r}var Pi=y(()=>{"use strict"});function gn(t){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(t).reverse()}var ji=y(()=>{"use strict"});function mn(t,...e){t=new Set(t);for(let r of e)for(let n of r)t.delete(n);return t}var Hi=y(()=>{"use strict"});function xn(t,e){let r=e[Symbol.iterator](),n=new Set;for(let i of t){if(n.has(i))return!1;let o,s;for(;({value:o,done:s}=r.next())&&!s;){if(Object.is(i,o))return!1;n.add(o)}}return!0}var Vi=y(()=>{"use strict"});function vn(t){return t instanceof Set?t:new Set(t)}var Gi=y(()=>{"use strict"});function wn(t,...e){t=new Set(t),e=e.map(vn);t:for(let r of t)for(let n of e)if(!n.has(r)){t.delete(r);continue t}return t}var Ui=y(()=>{"use strict";Gi()});function $t(t,e){let r=t[Symbol.iterator](),n=new Set;for(let i of e){if(n.has(i))continue;let o,s;for(;{value:o,done:s}=r.next();){if(s)return!1;if(n.add(o),Object.is(i,o))break}}return!0}var yn=y(()=>{"use strict"});function bn(t,e){return $t(e,t)}var Xi=y(()=>{"use strict";yn()});function An(...t){let e=new Set;for(let r of t)for(let n of r)e.add(n);return e}var Bi=y(()=>{"use strict"});var $i={};Tt($i,{Adder:()=>Ct,InternMap:()=>Ft,InternSet:()=>re,ascending:()=>B,bin:()=>Be,bisect:()=>ne,bisectCenter:()=>Xr,bisectLeft:()=>Ur,bisectRight:()=>Ee,bisector:()=>_t,count:()=>lt,cross:()=>Ne,cumsum:()=>Te,descending:()=>Zr,deviation:()=>Pt,difference:()=>mn,disjoint:()=>xn,every:()=>ln,extent:()=>Mt,fcumsum:()=>Kr,filter:()=>cn,fsum:()=>Jr,greatest:()=>rn,greatestIndex:()=>on,group:()=>jt,groupSort:()=>je,groups:()=>ri,histogram:()=>Be,index:()=>oi,indexes:()=>ai,intersection:()=>wn,least:()=>en,leastIndex:()=>Bt,map:()=>pn,max:()=>Et,maxIndex:()=>Ut,mean:()=>Je,median:()=>bi,merge:()=>Ke,min:()=>ct,minIndex:()=>Xt,nice:()=>Vt,pairs:()=>tn,permute:()=>oe,quantile:()=>pt,quantileSorted:()=>gi,quickselect:()=>kt,range:()=>Fi,reduce:()=>dn,reverse:()=>gn,rollup:()=>ie,rollups:()=>ii,scan:()=>an,shuffle:()=>Ti,shuffler:()=>fn,some:()=>hn,sort:()=>zt,subset:()=>bn,sum:()=>sn,superset:()=>$t,thresholdFreedmanDiaconis:()=>mi,thresholdScott:()=>vi,thresholdSturges:()=>se,tickIncrement:()=>vt,tickStep:()=>pi,ticks:()=>ae,transpose:()=>he,union:()=>An,variance:()=>Wt,zip:()=>qi});var Zi=y(()=>{"use strict";ke();ut();Ie();Lt();Br();$r();Yr();Re();qe();Qr();Le();si();di();xi();wi();Xe();$e();Ye();yi();Ai();Mi();ue();Qe();Ue();Ci();We();le();Ze();Ii();zi();nn();Ei();ki();Ni();Oi();Ri();fe();un();Oe();Di();Si();_i();Li();Wi();Pi();ji();Pe();Hi();Vi();Ui();Xi();yn();Bi();Se()});function Yi(t){for(var e=-1,r=t.length,n,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2}var Ji=y(()=>{"use strict"});function Ki(t){for(var e=-1,r=t.length,n=0,i=0,o,s=t[r-1],a,u=0;++e<r;)o=s,s=t[e],u+=a=o[0]*s[1]-s[0]*o[1],n+=(o[0]+s[0])*a,i+=(o[1]+s[1])*a;return u*=3,[n/u,i/u]}var Qi=y(()=>{"use strict"});function to(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}var eo=y(()=>{"use strict"});function Qo(t,e){return t[0]-e[0]||t[1]-e[1]}function no(t){let e=t.length,r=[0,1],n=2,i;for(i=2;i<e;++i){for(;n>1&&to(t[r[n-2]],t[r[n-1]],t[i])<=0;)--n;r[n++]=i}return r.slice(0,n)}function ro(t){if((r=t.length)<3)return null;var e,r,n=new Array(r),i=new Array(r);for(e=0;e<r;++e)n[e]=[+t[e][0],+t[e][1],e];for(n.sort(Qo),e=0;e<r;++e)i[e]=[n[e][0],-n[e][1]];var o=no(n),s=no(i),a=s[0]===o[0],u=s[s.length-1]===o[o.length-1],p=[];for(e=o.length-1;e>=0;--e)p.push(t[n[o[e]][2]]);for(e=+a;e<s.length-u;++e)p.push(t[n[s[e]][2]]);return p}var io=y(()=>{"use strict";eo()});function oo(t,e){for(var r=t.length,n=t[r-1],i=e[0],o=e[1],s=n[0],a=n[1],u,p,h=!1,d=0;d<r;++d)n=t[d],u=n[0],p=n[1],p>o!=a>o&&i<(s-u)*(o-p)/(a-p)+u&&(h=!h),s=u,a=p;return h}var ao=y(()=>{"use strict"});function fo(t){for(var e=-1,r=t.length,n=t[r-1],i,o,s=n[0],a=n[1],u=0;++e<r;)i=s,o=a,n=t[e],s=n[0],a=n[1],i-=s,o-=a,u+=Math.hypot(i,o);return u}var so=y(()=>{"use strict"});var uo={};Tt(uo,{polygonArea:()=>Yi,polygonCentroid:()=>Ki,polygonContains:()=>oo,polygonHull:()=>ro,polygonLength:()=>fo});var lo=y(()=>{"use strict";Ji();Qi();io();ao();so()});var co=ft((ce,ho)=>{"use strict";(function(t,e){typeof ce=="object"&&typeof ho<"u"?e(ce,(Zi(),Ot($i)),(lo(),Ot(uo))):typeof define=="function"&&define.amd?define(["exports","d3-array","d3-polygon"],e):e(t.d3=t.d3||{},t.d3,t.d3)})(ce,function(t,e,r){"use strict";var n=1e-10;function i(f){return f<=n&&f>=-n}function o(f,l){return f.x*l.x+f.y*l.y+f.z*l.z}function s(f,l){return i(f.x*l.y-f.y*l.x)&&i(f.y*l.z-f.z*l.y)&&i(f.z*l.x-f.x*l.z)}function a(f){var l,g,c,m,F,b,z,v;if(c=f[f.length-2],m=f[f.length-1],F=f[0],b=u(c,m),z=u(m,F),g=p(b,z),l=Math.sign(g),c=m,m=F,F=f[1],b=z,z=u(m,F),g=p(b,z),Math.sign(g)===l){for(v=2;v<f.length-1;v++)if(c=m,m=F,F=f[v],b=z,z=u(m,F),g=p(b,z),Math.sign(g)!==l)return;return l}}function u(f,l){return[l[0]-f[0],l[1]-f[1]]}function p(f,l){return f[0]*l[1]-f[1]*l[0]}function h(f,l){this.face=f,this.vert=l,this.nextf=null,this.prevf=null,this.nextv=null,this.prevv=null}function d(f){this.forFace=f,this.head=null}d.prototype.add=function(f){this.head===null?this.head=f:this.forFace?(this.head.prevv=f,f.nextv=this.head,this.head=f):(this.head.prevf=f,f.nextf=this.head,this.head=f)},d.prototype.isEmpty=function(){return this.head===null},d.prototype.fill=function(f){if(!this.forFace){var l=this.head;do f.push(l.face),l.face.marked=!0,l=l.nextf;while(l!==null)}},d.prototype.removeAll=function(){if(this.forFace){var f=this.head;do f.prevf===null?f.nextf===null?f.vert.conflicts.head=null:(f.nextf.prevf=null,f.vert.conflicts.head=f.nextf):(f.nextf!=null&&(f.nextf.prevf=f.prevf),f.prevf.nextf=f.nextf),f=f.nextv,f!=null&&(f.prevv=null);while(f!=null)}else{var f=this.head;do f.prevv==null?f.nextv==null?f.face.conflicts.head=null:(f.nextv.prevv=null,f.face.conflicts.head=f.nextv):(f.nextv!=null&&(f.nextv.prevv=f.prevv),f.prevv.nextv=f.nextv),f=f.nextf,f!=null&&(f.prevf=null);while(f!=null)}},d.prototype.getVertices=function(){for(var f=[],l=this.head;l!==null;)f.push(l.vert),l=l.nextv;return f};function x(f,l,g,c,m,F){this.x=f,this.y=l,this.weight=n,this.index=0,this.conflicts=new d(!1),this.neighbours=null,this.nonClippedPolygon=null,this.polygon=null,this.originalObject=null,this.isDummy=!1,m!==void 0&&(this.originalObject=m),F!=null&&(this.isDummy=F),c!=null&&(this.weight=c),g!=null?this.z=g:this.z=this.projectZ(this.x,this.y,this.weight)}x.prototype.projectZ=function(f,l,g){return f*f+l*l-g},x.prototype.setWeight=function(f){this.weight=f,this.z=this.projectZ(this.x,this.y,this.weight)},x.prototype.subtract=function(f){return new x(f.x-this.x,f.y-this.y,f.z-this.z)},x.prototype.crossproduct=function(f){return new x(this.y*f.z-this.z*f.y,this.z*f.x-this.x*f.z,this.x*f.y-this.y*f.x)},x.prototype.equals=function(f){return this.x===f.x&&this.y===f.y&&this.z===f.z};function w(f){var l=f.verts[0],g=f.verts[1],c=f.verts[2];this.a=l.y*(g.z-c.z)+g.y*(c.z-l.z)+c.y*(l.z-g.z),this.b=l.z*(g.x-c.x)+g.z*(c.x-l.x)+c.z*(l.x-g.x),this.c=l.x*(g.y-c.y)+g.x*(c.y-l.y)+c.x*(l.y-g.y),this.d=-1*(l.x*(g.y*c.z-c.y*g.z)+g.x*(c.y*l.z-l.y*c.z)+c.x*(l.y*g.z-g.y*l.z))}w.prototype.getNormZPlane=function(){return[-1*(this.a/this.c),-1*(this.b/this.c),-1*(this.d/this.c)]},w.prototype.getDualPointMappedToPlane=function(){var f=this.getNormZPlane(),l=new G(f[0]/2,f[1]/2);return l};function G(f,l){this.x=f,this.y=l}function A(f,l,g){this.x=f,this.y=l,this.z=g}A.prototype.negate=function(){this.x*=-1,this.y*=-1,this.z*=-1},A.prototype.normalize=function(){var f=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);f>0&&(this.x/=f,this.y/=f,this.z/=f)};function M(f,l,g){this.next=null,this.prev=null,this.twin=null,this.orig=f,this.dest=l,this.iFace=g}M.prototype.isHorizon=function(){return this.twin!==null&&!this.iFace.marked&&this.twin.iFace.marked},M.prototype.findHorizon=function(f){if(this.isHorizon()){if(f.length>0&&this===f[0])return;f.push(this),this.next.findHorizon(f)}else this.twin!==null&&this.twin.next.findHorizon(f)},M.prototype.isEqual=function(f,l){return this.orig.equals(f)&&this.dest.equals(l)||this.orig.equals(l)&&this.dest.equals(f)};function k(f){this.message=f,this.stack=new Error().stack}k.prototype.name="d3WeightedVoronoiError",k.prototype=new Error;function I(f,l,g,c){this.conflicts=new d(!0),this.verts=[f,l,g],this.marked=!1;var m=f.subtract(l).crossproduct(l.subtract(g));this.normal=new A(-m.x,-m.y,-m.z),this.normal.normalize(),this.createEdges(),this.dualPoint=null,c!=null&&this.orient(c)}I.prototype.getDualPoint=function(){if(this.dualPoint==null){var f=new w(this);this.dualPoint=f.getDualPointMappedToPlane()}return this.dualPoint},I.prototype.isVisibleFromBelow=function(){return this.normal.z<-14259414393190911e-25},I.prototype.createEdges=function(){this.edges=[],this.edges[0]=new M(this.verts[0],this.verts[1],this),this.edges[1]=new M(this.verts[1],this.verts[2],this),this.edges[2]=new M(this.verts[2],this.verts[0],this),this.edges[0].next=this.edges[1],this.edges[0].prev=this.edges[2],this.edges[1].next=this.edges[2],this.edges[1].prev=this.edges[0],this.edges[2].next=this.edges[0],this.edges[2].prev=this.edges[1]},I.prototype.orient=function(f){if(!(o(this.normal,f)<o(this.normal,this.verts[0]))){var l=this.verts[1];this.verts[1]=this.verts[2],this.verts[2]=l,this.normal.negate(),this.createEdges()}},I.prototype.getEdge=function(f,l){for(var g=0;g<3;g++)if(this.edges[g].isEqual(f,l))return this.edges[g];return null},I.prototype.link=function(f,l,g){if(f instanceof I){var c=f.getEdge(l,g);if(c===null)throw new k("when linking, twin is null");var m=this.getEdge(l,g);if(m===null)throw new k("when linking, twin is null");c.twin=m,m.twin=c}else{var c=f,m=this.getEdge(c.orig,c.dest);c.twin=m,m.twin=c}},I.prototype.conflict=function(f){return o(this.normal,f)>o(this.normal,this.verts[0])+n},I.prototype.getHorizon=function(){for(var f=0;f<3;f++)if(this.edges[f].twin!==null&&this.edges[f].twin.isHorizon())return this.edges[f];return null},I.prototype.removeConflict=function(){this.conflicts.removeAll()};function C(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0}C.prototype.init=function(f,l){this.points=[];for(var g=0;g<l.length;g++)this.points[g]=new x(l[g].x,l[g].y,l[g].z,null,l[g],!1);this.points=this.points.concat(f)},C.prototype.permutate=function(){for(var f=this.points.length,l=f-1;l>0;l--){var g=Math.floor(Math.random()*l),c=this.points[g];c.index=l;var m=this.points[l];m.index=g,this.points.splice(g,1,m),this.points.splice(l,1,c)}},C.prototype.prep=function(){if(this.points.length<=3)throw new k("Less than 4 points");for(var f=0;f<this.points.length;f++)this.points[f].index=f;var l,g,c,m,F,b,z,v;l=this.points[0],g=this.points[1],c=m=null;for(var f=2;f<this.points.length;f++)if(!(s(l,this.points[f])&&s(g,this.points[f]))){c=this.points[f],c.index=2,this.points[2].index=f,this.points.splice(f,1,this.points[2]),this.points.splice(2,1,c);break}if(c===null)throw new k("Not enough non-planar Points (v2 is null)");v=new I(l,g,c);for(var f=3;f<this.points.length;f++)if(!i(o(v.normal,v.verts[0])-o(v.normal,this.points[f]))){m=this.points[f],m.index=3,this.points[3].index=f,this.points.splice(f,1,this.points[3]),this.points.splice(3,1,m);break}if(m===null)throw new k("Not enough non-planar Points (v3 is null)");v.orient(m),F=new I(l,c,m,g),b=new I(l,g,m,c),z=new I(g,c,m,l),this.addFacet(v),this.addFacet(F),this.addFacet(b),this.addFacet(z),v.link(F,l,c),v.link(b,l,g),v.link(z,g,c),F.link(b,l,m),F.link(z,c,m),b.link(z,m,g),this.current=4;for(var T,f=this.current;f<this.points.length;f++)T=this.points[f],v.conflict(T)&&this.addConflict(v,T),F.conflict(T)&&this.addConflict(F,T),b.conflict(T)&&this.addConflict(b,T),z.conflict(T)&&this.addConflict(z,T)},C.prototype.addConflicts=function(f,l,g){var c=f.conflicts.getVertices(),m=l.conflicts.getVertices(),F=[],b,z,v,T;for(v=T=0;v<c.length||T<m.length;)v<c.length&&T<m.length?(b=c[v],z=m[T],b.index===z.index?(F.push(b),v++,T++):b.index>z.index?(F.push(b),v++):(F.push(z),T++)):v<c.length?F.push(c[v++]):F.push(m[T++]);for(var v=F.length-1;v>=0;v--)b=F[v],g.conflict(b)&&this.addConflict(g,b)},C.prototype.addConflict=function(f,l){var g=new h(f,l);f.conflicts.add(g),l.conflicts.add(g)},C.prototype.removeConflict=function(f){f.removeConflict();var l=f.index;if(f.index=-1,l===this.facets.length-1){this.facets.splice(this.facets.length-1,1);return}if(!(l>=this.facets.length||l<0)){var g=this.facets.splice(this.facets.length-1,1);g[0].index=l,this.facets.splice(l,1,g[0])}},C.prototype.addFacet=function(f){f.index=this.facets.length,this.facets.push(f)},C.prototype.compute=function(){for(this.prep();this.current<this.points.length;){var f=this.points[this.current];if(f.conflicts.isEmpty()){this.current++;continue}this.created=[],this.horizon=[],this.visible=[],f.conflicts.fill(this.visible);for(var l,g=0;g<this.visible.length;g++)if(l=this.visible[g].getHorizon(),l!==null){l.findHorizon(this.horizon);break}for(var c=null,m=null,F=0;F<this.horizon.length;F++){var b=this.horizon[F],z=new I(f,b.orig,b.dest,b.twin.next.dest);z.conflicts=new d(!0),this.addFacet(z),this.created.push(z),this.addConflicts(b.iFace,b.twin.iFace,z),z.link(b),c!==null&&z.link(c,f,b.orig),c=z,m===null&&(m=z)}if(m!==null&&c!==null&&c.link(m,f,this.horizon[0].orig),this.created.length!=0){for(var v=0;v<this.visible.length;v++)this.removeConflict(this.visible[v]);this.current++,this.created=[]}}return this.facets},C.prototype.clear=function(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0};function N(f,l){for(var g,c=D(l),m=-1,F=f.length-D(f),b,z,v=f[F-1],T,q,S,U;++m<F;){for(g=l.slice(),l.length=0,T=f[m],q=g[(z=g.length-c)-1],b=-1;++b<z;)S=g[b],O(S,v,T)?(O(q,v,T)||(U=R(q,S,v,T),isFinite(U[0])&&l.push(U)),l.push(S)):O(q,v,T)&&(U=R(q,S,v,T),isFinite(U[0])&&l.push(U)),q=S;c&&l.push(l[0]),v=T}return l}function O(f,l,g){return(g[0]-l[0])*(f[1]-l[1])<(g[1]-l[1])*(f[0]-l[0])}function R(f,l,g,c){var m=f[0],F=g[0],b=l[0]-m,z=c[0]-F,v=f[1],T=g[1],q=l[1]-v,S=c[1]-T,U=(z*(v-T)-S*(m-F))/(S*b-z*q);return[m+U*b,v+U*q]}function D(f){var l=f[0],g=f[f.length-1];return!(l[0]-g[0]||l[1]-g[1])}function P(f){var l=[],g=f,c=f.dest,m=c.originalObject,F=[];do{g=g.twin.prev;var b=g.orig.originalObject;b.isDummy||F.push(b);var z=g.iFace;z.isVisibleFromBelow()&&l.push(z)}while(g!==f);return m.neighbours=F,l}function $(f,l,g){var c=new C;c.clear(),c.init(l,f);for(var m=c.compute(f),F=[],b=[],z=m.length,v=0;v<z;v++){var T=m[v];if(T.isVisibleFromBelow())for(var q=0;q<3;q++){var S=T.edges[q],U=S.dest,tt=U.originalObject;if(!b[U.index]){if(b[U.index]=!0,tt.isDummy)continue;for(var et=P(S),j=[],it=null,at=null,Q=1,st=1,rt=0;rt<et.length;rt++){var Nt=et[rt].getDualPoint(),wt=Nt.x,yt=Nt.y;it!==null&&(Q=it-wt,st=at-yt,Q<0&&(Q=-Q),st<0&&(st=-st)),(Q>n||st>n)&&(j.push([wt,yt]),it=wt,at=yt)}if(tt.nonClippedPolygon=j.reverse(),!tt.isDummy&&r.polygonLength(tt.nonClippedPolygon)>0){var dt=N(g,tt.nonClippedPolygon);tt.polygon=dt,dt.site=tt,dt.length>0&&F.push(dt)}}}}return F}function L(){var f=function(v){return v.x},l=function(v){return v.y},g=function(v){return v.weight},c=[[0,0],[0,1],[1,1],[1,0]],m=[[0,0],[1,1]],F=[1,1];function b(v){var T;return T=v.map(function(q){return new x(f(q),l(q),null,g(q),q,!1)}),$(T,z(),c)}b.x=function(v){return arguments.length?(f=v,b):f},b.y=function(v){return arguments.length?(l=v,b):l},b.weight=function(v){return arguments.length?(g=v,b):g},b.clip=function(v){var T,q,S;return arguments.length?(q=e.extent(v.map(function(U){return U[0]})),S=e.extent(v.map(function(U){return U[1]})),T=a(v),T===void 0?c=r.polygonHull(v):T===1?c=v.reverse():c=v,m=[[q[0],S[0]],[q[1],S[1]]],F=[q[1]-q[0],S[1]-S[0]],b):c},b.extent=function(v){return arguments.length?(c=[v[0],[v[0][0],v[1][1]],v[1],[v[1][0],v[0][1]]],m=v,F=[v[1][0]-v[0][0],v[1][1]-v[0][1]],b):m},b.size=function(v){return arguments.length?(c=[[0,0],[0,v[1]],[v[0],v[1]],[v[0],0]],m=[[0,0],v],F=v,b):F};function z(){var v,T,q,S,U,tt,et,j,it,at,Q=[],st=[];v=m[0][0],T=m[1][0],q=m[0][1],S=m[1][1],U=T-v,tt=S-q,et=v-U,j=T+U,it=q-tt,at=S+tt,Q[0]=[et,it],Q[1]=[et,at],Q[2]=[j,at],Q[3]=[j,it];for(var rt=0;rt<4;rt++)st.push(new x(Q[rt][0],Q[rt][1],null,n,new x(Q[rt][0],Q[rt][1],null,n,null,!0),!0));return st}return b}t.weightedVoronoi=L,t.d3WeightedVoronoiError=k,Object.defineProperty(t,"__esModule",{value:!0})})});var go=ft((pe,po)=>{"use strict";(function(t,e){typeof pe=="object"&&typeof po<"u"?e(pe,(zr(),Ot(Ir)),(Sr(),Ot(Dr)),(Hr(),Ot(jr)),co()):typeof define=="function"&&define.amd?define(["exports","d3-polygon","d3-timer","d3-dispatch","d3-weighted-voronoi"],e):e(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(pe,function(t,e,r,n,i){"use strict";function o(){this.growthChangesLength=s,this.totalAvailableArea=NaN,this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights)}var s=10;function a(A,M){return A>=M?1:-1}function u(A){for(var M=3,k=1,I=1,C=M,N=[],O=0;O<A;O++)N.push(C),C-=k,C<I&&(C=I);return N}function p(A){for(var M=0,k=0;k<A.length;k++)M+=A[k];return M}o.prototype.reset=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangesLength=s,this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights),this.totalAvailableArea=NaN,this},o.prototype.clear=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this},o.prototype.length=function(A){return arguments.length?(parseInt(A)>0?(this.growthChangesLength=Math.floor(parseInt(A)),this.growthChangeWeights=u(this.growthChangesLength),this.growthChangeWeightsSum=p(this.growthChangeWeights)):console.warn("FlickeringMitigation.length() accepts only positive integers; unable to handle "+A),this):this.growthChangesLength},o.prototype.totalArea=function(A){return arguments.length?(parseFloat(A)>0?this.totalAvailableArea=parseFloat(A):console.warn("FlickeringMitigation.totalArea() accepts only positive numbers; unable to handle "+A),this):this.totalAvailableArea},o.prototype.add=function(A){var M,k;return M=this.lastAreaError,this.lastAreaError=A,isNaN(M)||(k=this.lastGrowth,this.lastGrowth=a(this.lastAreaError,M)),isNaN(k)||this.growthChanges.unshift(this.lastGrowth!=k),this.growthChanges.length>this.growthChangesLength&&this.growthChanges.pop(),this},o.prototype.ratio=function(){var A=0,M;if(this.growthChanges.length<this.growthChangesLength||this.lastAreaError>this.totalAvailableArea/10)return 0;for(var k=0;k<this.growthChangesLength;k++)this.growthChanges[k]&&(A+=this.growthChangeWeights[k]);return M=A/this.growthChangeWeightsSum,M};function h(){var A,M,k,I,C,N,O,R;function D($,L,f,l){var g=!1,c,m;for(A!==l.clip()&&(A=l.clip(),M=l.extent(),g=!0),g&&P(),c=k+O*l.prng()(),m=C+R*l.prng()();!e.polygonContains(A,[c,m]);)c=k+O*l.prng()(),m=C+R*l.prng()();return[c,m]}function P(){k=M[0][0],I=M[1][0],C=M[0][1],N=M[1][1],O=I-k,R=N-C}return D}function d(){var A=0,M,k,I,C,N,O;function R(L,f,l,g){var c=!1;return M!==g.clip()&&(M=g.clip(),c|=!0),k!==l&&(k=l,c|=!0),c&&D(),[C[0]+Math.cos(A+f*O)*N+(g.prng()()-.5)*.001,C[1]+Math.sin(A+f*O)*N+(g.prng()()-.5)*.001]}R.startAngle=function(L){return arguments.length?(A=L,R):A};function D(){C=e.polygonCentroid(M),N=P(C,M)/2,I=k.length,O=2*Math.PI/I}function P(L,f){for(var l=1/0,g=0,c=f[f.length-1],m=f[g],F;g<f.length;)F=$(L,c,m),F<l&&(l=F),g++,c=m,m=f[g];return l}function $(L,f,l){var g=L[0],c=L[1],m=f[0],F=f[1],b=l[0],z=l[1],v=g-m,T=c-F,q=b-m,S=z-F,U=v*q+T*S,tt=q*q+S*S,et=-1;tt!=0&&(et=U/tt);var j,it;et<0?(j=m,it=F):et>1?(j=b,it=z):(j=m+et*q,it=F+et*S);var at=g-j,Q=c-it;return Math.sqrt(at*at+Q*Q)}return R}function x(){var A,M,k,I,C;function N(R,D,P,$){var L=!1;return A!==$.clip()&&(A=$.clip(),L|=!0),M!==P&&(M=P,L|=!0),L&&O(),C}function O(){k=M.length,I=e.polygonArea(A),C=I/k/2}return N}function w(A){this.message=A,this.stack=new Error().stack}w.prototype.name="d3VoronoiMapError",w.prototype=new Error;function G(A){var M=.01,k=50,I=.01,C=Math.random,N=h(),O=x(),R=h(),D=1e-10,P=function(E){return E.weight},$=M,L=k,f=I,l=C,g=N,c=O,m=i.weightedVoronoi(),F=new o,b=!0,z,v,T,q,S,U,tt,et,j,it=r.timer(yt),at=n.dispatch("tick","end");let Q=1,st=1e3;var rt;function Nt(E){return Math.pow(E,2)}function wt(E,Z){return Nt(Z.x-E.x)+Nt(Z.y-E.y)}j={tick:dt,restart:function(){return it.restart(yt),j},stop:function(){return it.stop(),j},weight:function(E){return arguments.length?(P=E,b=!0,j):P},convergenceRatio:function(E){return arguments.length?($=E,b=!0,j):$},maxIterationCount:function(E){return arguments.length?(L=E,j):L},minWeightRatio:function(E){return arguments.length?(f=E,b=!0,j):f},clip:function(E){return arguments.length?(m.clip(E),b=!0,j):m.clip()},extent:function(E){return arguments.length?(m.extent(E),b=!0,j):m.extent()},size:function(E){return arguments.length?(m.size(E),b=!0,j):m.size()},prng:function(E){return arguments.length?(l=E,b=!0,j):l},initialPosition:function(E){return arguments.length?(g=E,b=!0,j):g},initialWeight:function(E){return arguments.length?(c=E,b=!0,j):c},state:function(){return b&&Cn(),{ended:et,iterationCount:q,convergenceRatio:U/v,polygons:S}},on:function(E,Z){return arguments.length===1?at.on(E):(at.on(E,Z),j)}};function yt(){dt(),at.call("tick",j),et&&(it.stop(),at.call("end",j))}function dt(){et||(b&&Cn(),S=Fo(S,F.ratio()),q++,U=ko(S),F.add(U),tt=U<T,et=tt||q>=L)}function Cn(){No(),z=A.length,v=Math.abs(e.polygonArea(m.clip())),T=$*v,F.clear().totalArea(v),q=0,tt=!1,S=Mo(A,j),et=!1,b=!1}function Mo(E,Z){var X=E.reduce(function(V,Y){return Math.max(V,P(Y))},-1/0),W=X*f,_,H;return _=E.map(function(V,Y,K){return{index:Y,weight:Math.max(P(V),W),initialPosition:g(V,Y,K,Z),initialWeight:c(V,Y,K,Z),originalData:V}}),H=Co(_,Z),rt(H),m(H)}function Co(E,Z){var X=E.reduce(function(_,H){return _+=H.weight},0),W;return E.map(function(_,H,V){return W=_.initialPosition,e.polygonContains(m.clip(),W)||(W=N(_,H,V,Z)),{index:_.index,targetedArea:v*_.weight/X,data:_,x:W[0],y:W[1],weight:_.initialWeight}})}function Fo(E,Z){var X;if(Io(E,Z),X=E.map(function(W){return W.site.originalObject}),E=m(X),E.length<z)throw new w("at least 1 site has no area, which is not supposed to arise");if(zo(E,Z),X=E.map(function(W){return W.site.originalObject}),E=m(X),E.length<z)throw new w("at least 1 site has no area, which is not supposed to arise");return E}function Io(E,Z){var X=[],W=.5,_,H,V,Y,K,nt,ot;_=W*Z,H=1-_;for(var ge=0;ge<z;ge++)V=E[ge],Y=V.site.originalObject,K=e.polygonCentroid(V),nt=K[0]-Y.x,ot=K[1]-Y.y,nt*=H,ot*=H,Y.x+=nt,Y.y+=ot,X.push(Y);rt(X)}function zo(E,Z){var X=[],W=.1,_,H,V,Y,K,nt;_=W*Z;for(var ot=0;ot<z;ot++)H=E[ot],V=H.site.originalObject,Y=e.polygonArea(H),K=V.targetedArea/Y,K=Math.max(K,1-W+_),K=Math.min(K,1+W-_),nt=V.weight*K,nt=Math.max(nt,D),V.weight=nt,X.push(V);rt(X)}function Fn(E){var Z=0,X,W,_,H,V,Y,K;do{if(Z>st)throw new w("handleOverweighted0 is looping too much");X=!1;for(var nt=0;nt<z;nt++){W=E[nt];for(var ot=nt+1;ot<z;ot++)if(_=E[ot],W.weight>_.weight?(H=W,V=_):(H=_,V=W),Y=wt(W,_),Y<H.weight-V.weight){K=Y+V.weight/2,K=Math.max(K,D),H.weight=K,X=!0,Z++;break}if(X)break}}while(X)}function Eo(E){var Z=0,X,W,_,H,V,Y,K;do{if(Z>st)throw new w("handleOverweighted1 is looping too much");X=!1;for(var nt=0;nt<z;nt++){W=E[nt];for(var ot=nt+1;ot<z;ot++)if(_=E[ot],W.weight>_.weight?(H=W,V=_):(H=_,V=W),Y=wt(W,_),Y<H.weight-V.weight){K=H.weight-V.weight-Y,V.weight+=K+D,X=!0,Z++;break}if(X)break}}while(X)}function ko(E){for(var Z=0,X,W,_,H=0;H<z;H++)X=E[H],W=X.site.originalObject,_=e.polygonArea(X),Z+=Math.abs(W.targetedArea-_);return Z}function No(){switch(Q){case 0:rt=Fn;break;case 1:rt=Eo;break;default:console.error("unknown 'handleOverweighted' variant; using variant #1"),rt=Fn}}return j}t.voronoiMapSimulation=G,t.voronoiMapInitialPositionRandom=h,t.voronoiMapInitialPositionPie=d,t.d3VoronoiMapError=w,Object.defineProperty(t,"__esModule",{value:!0})})});var xo=ft((de,mo)=>{"use strict";(function(t,e){typeof de=="object"&&typeof mo<"u"?e(de,go()):typeof define=="function"&&define.amd?define(["exports","d3-voronoi-map"],e):e(t.d3=t.d3||{},t.d3)})(de,function(t,e){"use strict";function r(){var n=.01,i=50,o=.01,s=Math.random,a=[[0,0],[0,1],[1,1],[1,0]],u=[[0,0],[1,1]],p=[1,1],h=n,d=i,x=o,w=s,G=[{weight:1},{weight:1}],A=e.voronoiMapSimulation(G).stop();function M(I){k(a,I)}M.convergenceRatio=function(I){return arguments.length?(h=I,M):h},M.maxIterationCount=function(I){return arguments.length?(d=I,M):d},M.minWeightRatio=function(I){return arguments.length?(x=I,M):x},M.clip=function(I){return arguments.length?(A.clip(I),a=A.clip(),u=A.extent(),p=A.size(),M):a},M.extent=function(I){return arguments.length?(A.extent(I),a=A.clip(),u=A.extent(),p=A.size(),M):u},M.size=function(I){return arguments.length?(A.size(I),a=A.clip(),u=A.extent(),p=A.size(),M):p},M.prng=function(I){return arguments.length?(w=I,M):w};function k(I,C){var N;if(C.polygon=I,C.height!=0){N=e.voronoiMapSimulation(C.children).clip(I).weight(function(R){return R.value}).convergenceRatio(h).maxIterationCount(d).minWeightRatio(x).prng(w).stop();for(var O=N.state();!O.ended;)N.tick(),O=N.state();O.polygons.forEach(function(R){k(R,R.site.originalObject.data.originalData)})}}return M}t.voronoiTreemap=r,Object.defineProperty(t,"__esModule",{value:!0})})});var bo=In(cr());To();var Ao=In(xo());var ta=["*"],Mn=Math.PI/180,ea="circle",vo=300,wo=300,yo="asc",na="desc",ra="white",ia="0px 0px 8px #000000",oa=.1,aa=3,fa=!1,sa=.01,ua=.01,la=50,ha=t=>{switch(t){case"triangle":return 3;case"diamond":return 4;case"square":return 4;case"pentagon":return 5;case"hexagon":return 6;case"heptagon":return 7;case"octagon":return 8;default:return 100}},ca=t=>{switch(t){case"triangle":return 30*Mn;case"square":return 45*Mn;case"pentagon":return 54*Mn;default:return 0}},ll=(()=>{let e=class e{constructor(){this.elementRef=zn(kn),this.sumFunc=J(Wn),this.sort=J(yo),this.labelFunc=J(Hn),this.labelMinRatio=J(oa),this.labelFill=J(ra),this.labelShadow=J(ia),this.labelFontSizeFunc=J(Zn),this.tooltipFunc=J(Vn),this.tapFunc=J(Gn),this.fillFunc=J(Bn),this.fillOpacityFunc=J($n),this.strokeFunc=J(Un),this.strokeWidthFunc=J(Xn),this.padding=J(aa),this.width=J(vo),this.height=J(wo),this.shape=J(ea),this.convergenceRatio=J(sa),this.minWeightRatio=J(ua),this.maxIterationCount=J(la),this.data=J.required(),this.flat=J(fa)}render(){let n=Sn(this.elementRef.nativeElement);n.select("svg").remove();let i=this.data();if(!i||!i.children||i.children.length<1)return;let o=this.padding(),s=o*2,a=Ln(this.elementRef,this.width(),this.height(),vo,wo),u=a[0]-s,p=a[1]-s,h=u/2,d=p/2,x=this.sort(),w=x===yo?Pn:x===na?jn:me,G=c=>{let m=_n(c).sum(this.sumFunc());return w!==me&&(m=m.sort((F,b)=>w(F,b))),m},A=G(i);if(this.flat()){let c={name:"root",children:[]};for(let m of A.leaves())c.children?.push(m.data);A=G(c)}let M=ha(this.shape()),k=2*Math.PI/M,I=ca(this.shape()),C=Dn(M).map(c=>{let m=I+c*k;return[h+h*Math.cos(m),d+d*Math.sin(m)]});Ao.voronoiTreemap().prng((0,bo.alea)(12345)).convergenceRatio(this.convergenceRatio()).maxIterationCount(this.maxIterationCount()).minWeightRatio(this.minWeightRatio()).clip(C)(A);let O=A.descendants().sort((c,m)=>m.depth-c.depth).map((c,m)=>Object.assign({},c,{id:m})),R=O.filter(c=>!c.children),D=Number.MAX_SAFE_INTEGER,P=Number.MIN_SAFE_INTEGER;for(let c of R)if(c.value){let m=c.value;m<D&&(D=m),m>P&&(P=m)}let $=n.append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("width",u+s).attr("height",p+s).attr("viewBox",`0 0 ${u+s} ${p+s}`);$.append("g").attr("transform",`translate(${o},${o})`).selectAll("path").data(O).enter().append("path").attr("d",c=>"M"+c.polygon.join("L")+"Z").attr("fill",c=>c.children?"transparent":this.fillFunc()(c,D,P)).attr("fill-opacity",c=>c.children?0:this.fillOpacityFunc()(c,A.height)).attr("stroke",c=>this.strokeFunc()(c)).attr("stroke-width",c=>this.strokeWidthFunc()(c)).attr("pointer-events",c=>c.children?"none":"all").on("click",(c,m)=>this.tapFunc()(m)).append("title").text(c=>c.children?"":this.tooltipFunc()(c));let f=D+this.labelMinRatio()*(P-D),l=c=>c.value&&c.value>f?1:0;$.append("g").attr("transform",`translate(${o},${o})`).style("user-select","none").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(R).enter().append("text").attr("transform",c=>"translate("+[c.polygon.site.x,c.polygon.site.y]+")").style("fill",this.labelFill()).style("text-shadow",this.labelShadow()).style("fill-opacity",l).style("font-size",c=>this.labelFontSizeFunc()(c)).selectAll("tspan").data(c=>this.labelFunc()(c).split(/\s+/g)).join("tspan").attr("x",0).attr("y",(c,m,F)=>`${m-F.length/2+.8}em`).text(c=>c)}ngOnChanges(n){this.render()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Tn({type:e,selectors:[["mb-voronoi"]],hostBindings:function(i,o){i&1&&On("resize",function(){return o.render()},Nn)},inputs:{sumFunc:[1,"sumFunc"],sort:[1,"sort"],labelFunc:[1,"labelFunc"],labelMinRatio:[1,"labelMinRatio"],labelFill:[1,"labelFill"],labelShadow:[1,"labelShadow"],labelFontSizeFunc:[1,"labelFontSizeFunc"],tooltipFunc:[1,"tooltipFunc"],tapFunc:[1,"tapFunc"],fillFunc:[1,"fillFunc"],fillOpacityFunc:[1,"fillOpacityFunc"],strokeFunc:[1,"strokeFunc"],strokeWidthFunc:[1,"strokeWidthFunc"],padding:[1,"padding"],width:[1,"width"],height:[1,"height"],shape:[1,"shape"],convergenceRatio:[1,"convergenceRatio"],minWeightRatio:[1,"minWeightRatio"],maxIterationCount:[1,"maxIterationCount"],data:[1,"data"],flat:[1,"flat"]},features:[En],ngContentSelectors:ta,decls:1,vars:0,template:function(i,o){i&1&&(Rn(),qn(0))},encapsulation:2,changeDetection:0});let t=e;return t})();export{ll as a};
